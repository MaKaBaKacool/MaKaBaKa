import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as r,c as o,a as e,b as s,d,e as a}from"./app-58e4a7d6.js";const c={},l=a(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>快排CMS 默认开启日志记录，由于日志名为时间作为文件名，造成管理员的Cookie泄露</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>快排 CMS &lt;= 1.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2>`,5),p={href:"https://gitee.com/qingzhanwang/kpcms",target:"_blank",rel:"noopener noreferrer"},h=a(`<h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>文件 <strong>thinkphp/library/think/log/driver/Socket.php</strong></p><p>这里默认开启日志写入</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>runtime/log/202104/06.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170921409.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>其中可以看到泄露了管理员的Cookie信息和其他敏感信息</p><p>并且文件命名为 <strong>年+月/日期.log</strong></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170921851.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里关注后台的日志文件中的 admin.php页面的cookie就可以获得管理员权限</p>`,9);function g(_,m){const n=t("ExternalLinkIcon");return r(),o("div",null,[l,e("p",null,[e("a",p,[s("https://gitee.com/qingzhanwang/kpcms"),d(n)])]),h])}const b=i(c,[["render",g],["__file","快排CMS Socket.php 日志信息泄露漏洞.html.vue"]]);export{b as default};
