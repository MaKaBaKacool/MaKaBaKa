import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as s,c as i,a as e,b as n,d as o,e as d}from"./app-58e4a7d6.js";const c={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),p=e("p",null,"DNS协议支持使用axfr类型的记录进行区域传送，用来解决主从同步的问题。如果管理员在配置DNS服务器的时候没有限制允许获取记录的来源，将会导致DNS域传送漏洞。",-1),h=e("p",null,"axfr：DNS Zone Transfer Protocol (AXFR)，dns的全量更新协议，dns主从架构更新，从向主获取zone的全量数据，由主返回axfr消息，全量刷新该zone的slave信息。",-1),u=e("p",null,"参考链接：",-1),_={href:"https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/",target:"_blank",rel:"noopener noreferrer"},f={href:"https://nmap.org/nsedoc/scripts/dns-zone-transfer.html",target:"_blank",rel:"noopener noreferrer"},g=e("h2",{id:"环境搭建",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#环境搭建","aria-hidden":"true"},"#"),n(" 环境搭建")],-1),m={href:"https://wiki.debian.org/Bind9",target:"_blank",rel:"noopener noreferrer"},b=d(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境运行后，将会监听TCP和UDP的53端口，DNS协议同时支持从这两个端口进行数据传输。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>在Linux下，我们可以使用dig命令来发送dns请求。比如，我们可以用<code>dig @your-ip www.vulhub.org</code>获取域名<code>www.vulhub.org</code>在目标dns服务器上的A记录：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202221723645.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>发送axfr类型的dns请求：<code>dig @your-ip -t axfr vulhub.org</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202221723790.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可见，获取到了<code>vulhub.org</code>的所有子域名记录，这里存在DNS域传送漏洞。</p><p>也可以用nmap script来扫描该漏洞：<code>nmap --script dns-zone-transfer.nse --script-args &quot;dns-zone-transfer.domain=vulhub.org&quot; -Pn -p 53 your-ip</code></p>`,9);function x(v,w){const r=t("ExternalLinkIcon");return s(),i("div",null,[l,p,h,u,e("ul",null,[e("li",null,[e("a",_,[n("https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/"),o(r)])]),e("li",null,[e("a",f,[n("https://nmap.org/nsedoc/scripts/dns-zone-transfer.html"),o(r)])])]),g,e("p",null,[n("Vulhub使用"),e("a",m,[n("Bind9"),o(r)]),n("来搭建dns服务器，但不代表只有Bind9支持AXFR记录。运行DNS服务器：")]),b])}const z=a(c,[["render",x],["__file","DNS域传送漏洞.html.vue"]]);export{z as default};
