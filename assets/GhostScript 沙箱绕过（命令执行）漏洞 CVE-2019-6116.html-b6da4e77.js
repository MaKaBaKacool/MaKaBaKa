import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as n,c as i,a as e,b as t,d as s,e as c}from"./app-58e4a7d6.js";const l={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),h=e("p",null,"2019年1月23日晚，Artifex官方在ghostscriptf的master分支上提交合并了多达6处的修复。旨在修复 CVE-2019-6116 漏洞，该漏洞由 Google 安全研究员 Tavis 于2018年12月3日提交。该漏洞可以直接绕过 ghostscript 的安全沙箱，导致攻击者可以执行任意命令/读取任意文件。",-1),p=e("p",null,"GhostScript 被许多图片处理库所使用，如 ImageMagick、Python PIL 等，默认情况下这些库会根据图片的内容将其分发给不同的处理方法，其中就包括 GhostScript。",-1),_=e("p",null,"参考链接：",-1),u={href:"https://bugs.chromium.org/p/project-zero/issues/detail?id=1729&desc=2",target:"_blank",rel:"noopener noreferrer"},m={href:"https://www.anquanke.com/post/id/170255",target:"_blank",rel:"noopener noreferrer"},g=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动漏洞环境（其中包括最新版 GhostScript 9.26、ImageMagick 7.0.8-27）：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080</code>将可以看到一个上传组件。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,5),b={href:"https://github.com/vulhub/vulhub/blob/master/ghostscript/CVE-2019-6116/poc.png",target:"_blank",rel:"noopener noreferrer"},f=e("code",null,"id > /tmp/success",-1),k=e("figure",null,[e("img",{src:"https://cb86160.webp.li/makabaka-r1-photo/202202231947802.png",alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),x=e("p",null,[t("进入容器，可以看到/tmp/success已被创建，"),e("code",null,"id"),t("命令执行结果也被成功写入文件。")],-1),v=e("figure",null,[e("img",{src:"https://cb86160.webp.li/makabaka-r1-photo/202202231947768.png",alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1);function V(w,E){const o=r("ExternalLinkIcon");return n(),i("div",null,[d,h,p,_,e("ul",null,[e("li",null,[e("a",u,[t("https://bugs.chromium.org/p/project-zero/issues/detail?id=1729&desc=2"),s(o)])]),e("li",null,[e("a",m,[t("https://www.anquanke.com/post/id/170255"),s(o)])])]),g,e("p",null,[t("作者给出了"),e("a",b,[t("POC"),s(o)]),t("，上传这个文件，即可执行"),f,t("：")]),k,x,v])}const S=a(l,[["render",V],["__file","GhostScript 沙箱绕过（命令执行）漏洞 CVE-2019-6116.html.vue"]]);export{S as default};
