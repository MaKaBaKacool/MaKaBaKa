import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{o as d,c as r,e}from"./app-58e4a7d6.js";const o={},a=e('<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>CVE-2022-21882是对CVE-2021-1732漏洞的绕过，属于win32k驱动程序中的一个类型混淆漏洞。</p><p>攻击者可以在user_mode调用相关的GUI API进行内核调用，如xxxMenuWindowProc、xxxSBWndProc、xxxSwitchWndProc、xxxTooltipWndProc等，这些内核函数会触发回调xxxClientAllocWindowClassExtraBytes。攻击者可以通过hook KernelCallbackTable 中 xxxClientAllocWindowClassExtraBytes 拦截该回调，并使用 NtUserConsoleControl 方法设置 tagWNDK 对象的 ConsoleWindow 标志，从而修改窗口类型。</p><p>最终回调后，系统不检查窗口类型是否发生变化，由于类型混淆而引用了错误的数据。flag修改前后的区别在于，在设置flag之前，系统认为tagWNDK.pExtraBytes保存了一个user_mode指针；flag设置后，系统认为tagWNDK.pExtraBytes是内核桌面堆的偏移量，攻击者可以控制这个偏移量，从而导致越界R&amp;W。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><table><thead><tr><th><strong>Product</strong></th><th><strong>CPU Architecture</strong></th><th><strong>Version</strong></th></tr></thead><tbody><tr><td>Windows 10</td><td>x86/x64/ARM64</td><td>1809</td></tr><tr><td>Windows 10</td><td>x86/x64/ARM64</td><td>1909</td></tr><tr><td>Windows 10</td><td>x86/x64/ARM64</td><td>20H2</td></tr><tr><td>Windows 10</td><td>x86/x64/ARM64</td><td>21H1</td></tr><tr><td>Windows 10</td><td>x86/x64/ARM64</td><td>21H2</td></tr><tr><td>Windows 11</td><td>x64/ARM64</td><td></td></tr><tr><td>Windows Server 2019</td><td></td><td></td></tr><tr><td>Windows Server 2022</td><td></td><td></td></tr><tr><td>Windows Server</td><td></td><td>20H2</td></tr></tbody></table><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>下载POC文件, 在Windows中运行</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202205241403925.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',9),n=[a];function i(s,x){return d(),r("div",null,n)}const h=t(o,[["render",i],["__file","Windows Win32k 内核提权漏洞 CVE-2022-21882.html.vue"]]);export{h as default};
