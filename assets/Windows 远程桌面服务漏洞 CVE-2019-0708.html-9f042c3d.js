import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o,c as t,a as e,b as a,d as r,e as l}from"./app-58e4a7d6.js";const d={},p=l(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>2019年5月14日，微软发布了针对远程桌面服务的关键远程执行代码漏洞CVE-2019-0708的补丁，该漏洞影响某些旧版本的Windows。攻击者一旦成功触发该漏洞，便可以在目标系统上执行任意代码，该漏洞的触发无需任何用户交互操作。这就意味着，存在漏洞的计算机只要联网，无需任何操作，就可能遭遇黑客远程攻击，运行恶意代码。其方式与2017年WannaCry恶意软件的传播方式类似。成功利用此漏洞的攻击者可以在目标系统完成安装应用程序，查看、更改或删除数据，创建完全访问权限的新账户等操作。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><p>该漏洞影响旧版本的Windows系统，包括：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Windows 7
Windows Server 2008 R2
Windows Server 2008
Windows 2003
Windows XP
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Windows 8和Windows 10及之后版本不受此漏洞影响。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>测试环境：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328160605922.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>将下载的exp分别放入或替换：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/share/metasploit-framework/lib/msf/core/exploit/rdp.rb

/usr/share//metasploit-framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb

/usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>升级msf：</p><ul><li><p>使用命令msfupdate，按提示，apt update</p></li><li><p>apt install Metasploit-framework，最后reload_all</p></li></ul><p>启动Metasploit，用search搜索0708，使用use exploit/windows/rdp/cve_2019_0708_bluekeep_rce启用0708RDP模块攻击：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328160727201.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>用show options进行参数设置</p><p>这里只需要设置两项，set rhosts 目标ip(我这里是192.168.106.149)，以及set target 3</p><p>set target ID数字(可选为0-4)设置受害机机器架构，wmware=3，Virtualbox=2</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328160741117.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>成功利用。</p><p>到目前公开的利用代码可用于攻击 Windows 7 SP1 x64 与 Windows 2008 R2 x64的EXP不太稳定，针对 Windows 7 SP1 x64攻击有蓝屏现象。</p><p>复现过程中出现的一些问题解决方法：</p><p>如提示Exploit failed: NameError undefined local variable or method \`rdp_connect&#39; for，则需要替换下载的exp（4个rb文件）；</p><p>如提示ForceExploit错误，需要将ForceExploit设置为true；</p><p>Windows2008 R2 x64 需要修改[HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\TerminalServer\\WinStations\\rdpwd\\fDisableCam]值为0。</p><h2 id="漏洞修复" tabindex="-1"><a class="header-anchor" href="#漏洞修复" aria-hidden="true">#</a> 漏洞修复</h2><p>安装微软的安全更新来给系统打上安全补丁：</p>`,27),c={href:"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708",target:"_blank",rel:"noopener noreferrer"},u=e("p",null,"同时针对已不受微软更新支持的系统Windows Server 2003和Windows XP提供的安全更新，下载地址:",-1),m={href:"https://support.microsoft.com/zh-cn/help/4500705/customer-guidance-for-cve-2019-0708",target:"_blank",rel:"noopener noreferrer"},h=e("p",null,[e("strong",null,"缓解措施（在无法及时安装微软安全更新的情况下作为临时性解决方案）")],-1),_=e("p",null,"1.若用户不需要用到远程桌面服务，建议禁用该服务。",-1),f=e("p",null,"2.开启网络级别身份验证（NLA），此方案适用于Windows 7, Windows Server 2008, Windows Server 2008 R2。",-1),v=e("p",null,"以上措施只能暂时性针对该漏洞对系统进行部分缓解，强烈建议在条件允许的情况下及时安装微软安全更新。",-1);function b(g,x){const i=s("ExternalLinkIcon");return o(),t("div",null,[p,e("ul",null,[e("li",null,[e("a",c,[a("https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708"),r(i)])])]),u,e("ul",null,[e("li",null,[e("a",m,[a("https://support.microsoft.com/zh-cn/help/4500705/customer-guidance-for-cve-2019-0708"),r(i)])])]),h,_,f,v])}const k=n(d,[["render",b],["__file","Windows 远程桌面服务漏洞 CVE-2019-0708.html.vue"]]);export{k as default};
