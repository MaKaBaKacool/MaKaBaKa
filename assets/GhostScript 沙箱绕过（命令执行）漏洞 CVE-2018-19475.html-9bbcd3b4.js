import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o as c,c as r,a as e,b as t,d as o,e as n}from"./app-58e4a7d6.js";const p={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),l=e("p",null,"2018年底来自Semmle Security Research Team的Man Yue Mo发表了CVE-2018-16509漏洞的变体CVE-2018-19475，可以通过一个恶意图片绕过GhostScript的沙盒，进而在9.26以前版本的gs中执行任意命令。",-1),h=e("p",null,"参考链接：",-1),_={href:"https://blog.semmle.com/ghostscript-CVE-2018-19475/",target:"_blank",rel:"noopener noreferrer"},g={href:"https://bugs.ghostscript.com/show_bug.cgi?id=700153",target:"_blank",rel:"noopener noreferrer"},u=n(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动漏洞环境（其中包括 GhostScript 9.25、ImageMagick 7.0.8-20）：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080</code>将可以看到一个上传组件。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>将POC作为图片上传，执行命令<code>id &gt; /tmp/success &amp;&amp; cat /tmp/success</code>：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202231938971.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Burpsuite抓包查看执行命令：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202231941627.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进入容器，可以看到/tmp/success已被创建，<code>id</code>命令执行结果也被成功写入文件。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202231942655.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>真实环境下通常无法直接回显漏洞执行结果，你需要使用带外攻击的方式来检测漏洞。</p>`,12);function m(b,f){const a=s("ExternalLinkIcon");return c(),r("div",null,[d,l,h,e("ul",null,[e("li",null,[e("a",_,[t("https://blog.semmle.com/ghostscript-CVE-2018-19475/"),o(a)])]),e("li",null,[e("a",g,[t("https://bugs.ghostscript.com/show_bug.cgi?id=700153"),o(a)])])]),u])}const V=i(p,[["render",m],["__file","GhostScript 沙箱绕过（命令执行）漏洞 CVE-2018-19475.html.vue"]]);export{V as default};
