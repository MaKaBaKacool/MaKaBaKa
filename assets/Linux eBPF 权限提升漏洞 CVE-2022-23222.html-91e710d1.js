import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as d,c as l,a as e,b as n,d as t,e as i}from"./app-58e4a7d6.js";const o={},c=i(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Linux Kernel 是美国 Linux 基金会发布的开源操作系统 Linux 所使用的内核。Linux 内核是一种开源的类Unix 操作系统宏内核。整个 Linux 操作系统家族基于该内核部署在传统计算机平台（如个人计算机和服务器）。该漏洞是由于 Linux 内核的 BPF 验证器存在一个空指针漏洞，没有对 *_OR_NULL 指针类型进行限制，允许这些类型进行指针运算。攻击者可利用该漏洞在获得低权限的情况下，构造恶意数据执行空指针引用攻击，最终获取服务器 root 权限</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Linux 5.8 - 5.16（在5.10.92 / 5.15.15 / 5.16.1中修复）
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,5),u={href:"https://github.com/tr3ee/CVE-2022-23222",target:"_blank",rel:"noopener noreferrer"},v=i(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ make
cc -I include -static -w -o exploit exploit.c
$ ./exploit 
[*] phase(1/8) &#39;create bpf map(s)&#39; running
[+] phase(1/8) &#39;create bpf map(s)&#39; done
[*] phase(2/8) &#39;do some leak&#39; running
[+] phase(2/8) &#39;do some leak&#39; done
[*] phase(3/8) &#39;prepare arbitrary rw&#39; running
[+] phase(3/8) &#39;prepare arbitrary rw&#39; done
[*] phase(4/8) &#39;spawn processes&#39; running
[+] phase(4/8) &#39;spawn processes&#39; done
[*] phase(5/8) &#39;find cred (slow)&#39; running
[+] phase(5/8) &#39;find cred (slow)&#39; done
[*] phase(6/8) &#39;overwrite cred&#39; running
[+] phase(6/8) &#39;overwrite cred&#39; done
[*] phase(7/8) &#39;spawn root shell&#39; running
[+] Enjoy root!
# id
uid=0(root) gid=0(root) groups=65534(nobody)
# exit
[+] phase(7/8) &#39;spawn root shell&#39; done
[*] phase(8/8) &#39;clean up the mess&#39; running
[+] phase(8/8) &#39;clean up the mess&#39; done
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function p(h,m){const s=r("ExternalLinkIcon");return d(),l("div",null,[c,e("p",null,[n("Exp："),e("a",u,[n("https://github.com/tr3ee/CVE-2022-23222"),t(s)])]),v])}const _=a(o,[["render",p],["__file","Linux eBPF 权限提升漏洞 CVE-2022-23222.html.vue"]]);export{_ as default};
