import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as i,e as t}from"./app-58e4a7d6.js";const n={},l=t(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Jellyfin RemoteImageController.cs 文件中存在SSRF漏洞，通过构造特殊的请求，探测内网信息</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Jellyfin &lt; 10.7.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Jellyfin&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>在官方的更新文件中，查找到修改的文件</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202205241459343.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>官方删除了某个方法</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>function getDisplayUrl(url, apiClient) {
        return apiClient.getUrl(&#39;Images/Remote&#39;, { imageUrl: url });
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下载漏洞版本源码，查找该接口对应的文件</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Jellyfin.Api/Controllers/RemoteImageController.cs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202205241459044.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>其中接收的参数为 imageUrl ，后续的代码片段存在SSRF漏洞</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202205241459542.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>构造请求POC</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/Images/Remote?imageUrl=http://www.baidu.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202205241459712.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,19),r=[l];function d(s,c){return a(),i("div",null,r)}const p=e(n,[["render",d],["__file","Jellyfin RemoteImageController.cs SSRF漏洞 CVE-2021-29490.html.vue"]]);export{p as default};
