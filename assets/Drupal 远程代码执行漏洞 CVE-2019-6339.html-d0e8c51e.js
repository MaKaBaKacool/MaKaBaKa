import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as s,c,a as e,b as a,d as o,e as n}from"./app-58e4a7d6.js";const l={},p=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),d=e("p",null,"影响软件：Drupal",-1),h=e("p",null,"方式：phar反序列化RCE",-1),u={href:"https://paper.seebug.org/897/",target:"_blank",rel:"noopener noreferrer"},_=n(`<p>效果：任意命令执行</p><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动drupal 8.5.0的环境：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问 <code>http://your-ip:8080/</code> 将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202222111090.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,7),f={href:"https://github.com/Vulnmachines/drupal-cve-2019-6339/blob/main/",target:"_blank",rel:"noopener noreferrer"},g=e("code",null,"phpinfo()",-1),m=n('<figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202222116084.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Drupal 的图片默认存储位置为 <code>/sites/default/files/pictures/&lt;YYYY-MM&gt;/</code>，默认存储名称为其原来的名称，所以之后在利用漏洞时，可以知道上传后的图片的具体位置。</p><p>访问 <code>http://127.0.0.1:8080/admin/config/media/file-system</code>，在 <code>Temporary directory</code> 处输入之前上传的图片路径，示例为 <code>phar://./sites/default/files/pictures/2022-02/CVE-2019-6339-exploit.png</code>，保存后将触发该漏洞。如下图所示，触发成功。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202222115460.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',4);function b(k,x){const t=i("ExternalLinkIcon");return s(),c("div",null,[p,d,h,e("p",null,[a("参考链接："),e("a",u,[a("Drupal 1-click to RCE 分析"),o(t)])]),_,e("p",null,[a("如下图所示，先使用管理员用户上传头像，头像图片为构造好的 PoC，参考"),e("a",f,[a("Vulnmachines"),o(t)]),a("的PoC，命令为"),g,a("。")]),m])}const y=r(l,[["render",b],["__file","Drupal 远程代码执行漏洞 CVE-2019-6339.html.vue"]]);export{y as default};
