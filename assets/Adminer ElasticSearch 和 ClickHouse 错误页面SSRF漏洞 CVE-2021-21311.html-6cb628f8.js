import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as n,o,c,a as e,b as a,d as r,e as s}from"./app-58e4a7d6.js";const l={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),h=e("p",null,"Adminer是一个PHP编写的开源数据库管理工具，支持MySQL、MariaDB、PostgreSQL、SQLite、MS SQL、Oracle、Elasticsearch、MongoDB等数据库。",-1),p=e("p",null,"在其4.0.0到4.7.9版本之间，连接 ElasticSearch 和 ClickHouse 数据库时存在一处服务端请求伪造漏洞（SSRF）。",-1),m=e("p",null,"参考连接：",-1),_={href:"https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6",target:"_blank",rel:"noopener noreferrer"},u={href:"https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21311.yaml",target:"_blank",rel:"noopener noreferrer"},b=s(`<h2 id="漏洞环境" tabindex="-1"><a class="header-anchor" href="#漏洞环境" aria-hidden="true">#</a> 漏洞环境</h2><p>Vulhub 执行如下命令启动一个安装了Adminer 4.7.8的PHP服务：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>服务启动后，在<code>http://your-ip:8080</code>即可查看到Adminer的登录页面。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230711102536330.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>在Adminer登录页面，选择ElasticSearch作为系统目标，并在server字段填写<code>example.com</code>，点击登录即可看到<code>example.com</code>返回的400错误页面展示在页面中：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230711102716994.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,8);function f(S,x){const t=n("ExternalLinkIcon");return o(),c("div",null,[d,h,p,m,e("ul",null,[e("li",null,[e("a",_,[a("https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6"),r(t)])]),e("li",null,[e("a",u,[a("https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf"),r(t)])]),e("li",null,[e("a",g,[a("https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21311.yaml"),r(t)])])]),b])}const E=i(l,[["render",f],["__file","Adminer ElasticSearch 和 ClickHouse 错误页面SSRF漏洞 CVE-2021-21311.html.vue"]]);export{E as default};
