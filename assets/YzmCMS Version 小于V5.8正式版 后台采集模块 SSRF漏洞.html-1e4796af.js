import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as s,c,a as e,b as a,d as i,e as n}from"./app-58e4a7d6.js";const l={},p=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),a(" 漏洞描述")],-1),d={href:"https://www.yzmcms.com/",target:"_blank",rel:"noopener noreferrer"},h=e("strong",null,"轻量级开源内容管理系统",-1),g=e("strong",null,"YZMPHP",-1),_=e("p",null,"源码存在协议识别的缺陷，导致存在SSRF漏洞",-1),m=e("p",null,"参考阅读：",-1),u={href:"https://github.com/yzmcms/yzmcms/issues/53",target:"_blank",rel:"noopener noreferrer"},f=n(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>YzmCMS version &lt;  V5.8正式版
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2>`,3),b={href:"https://github.com/yzmcms/yzmcms",target:"_blank",rel:"noopener noreferrer"},x=n('<p>按照文档安装即可</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906852.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>登录后台 --&gt; 模块管理 --&gt; 采集管理</p><p>添加采集规则</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906839.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在你的服务器上编辑HTML代码</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906899.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>根目录可能不同，payload需要更改</li></ul><p>点击采集读取根目录下的 Flag</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906740.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>出现漏洞的代码位置 <code>yzmcms/yzmphp/core/class/cache_factory.class.php</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906476.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里调用 <em><strong>url_check</strong></em> 函数</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202170906456.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可以看到这里只检测了前4位是否为 http，使用 httpxxx 即可绕过</p>',16);function k(z,y){const t=r("ExternalLinkIcon");return s(),c("div",null,[p,e("p",null,[e("a",d,[a("YzmCMS内容管理系统"),i(t)]),a("是一款"),h,a("，它采用自主研发的框架"),g,a("开发。程序基于PHP+Mysql架构，并采用MVC框架式开发的一款高效开源的内容管理系统，可运行在Linux、Windows、MacOSX、Solaris等各种平台上。")]),_,m,e("ul",null,[e("li",null,[e("a",u,[a("There are SSRF vulnerabilities in background collection management"),i(t)])])]),f,e("p",null,[e("a",b,[a("https://github.com/yzmcms/yzmcms"),i(t)])]),x])}const w=o(l,[["render",k],["__file","YzmCMS Version 小于V5.8正式版 后台采集模块 SSRF漏洞.html.vue"]]);export{w as default};
